<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>GraphBuilder 2.0 (alpha): com.intel.pig.udf.eval.CreatePropGraphElements Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GraphBuilder 2.0 (alpha)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li class="current"><a href="annotated.html"><span>Javadoc</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecom.html">com</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel.html">intel</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1pig.html">pig</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1pig_1_1udf.html">udf</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1pig_1_1udf_1_1eval.html">eval</a></li><li class="navelem"><a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html">CreatePropGraphElements</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">com.intel.pig.udf.eval.CreatePropGraphElements Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html" title="CreatePropGraphElements ... converts tuples of scalar data into bag of property graph elements...">CreatePropGraphElements</a> ... converts tuples of scalar data into bag of property graph elements..  
 <a href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for com.intel.pig.udf.eval.CreatePropGraphElements:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.png" usemap="#com.intel.pig.udf.eval.CreatePropGraphElements_map" alt=""/>
  <map id="com.intel.pig.udf.eval.CreatePropGraphElements_map" name="com.intel.pig.udf.eval.CreatePropGraphElements_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae0569dfa9380e4e3396894020579a242"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#ae0569dfa9380e4e3396894020579a242">CreatePropGraphElements</a> (String tokenizationRule)</td></tr>
<tr class="separator:ae0569dfa9380e4e3396894020579a242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74f67bf257906acb703a8e2e2f7612d8"><td class="memItemLeft" align="right" valign="top">DataBag&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#a74f67bf257906acb703a8e2e2f7612d8">exec</a> (Tuple input)  throws IOException </td></tr>
<tr class="separator:a74f67bf257906acb703a8e2e2f7612d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d41af36fdb41de8ef52694e1d99210a"><td class="memItemLeft" align="right" valign="top">Schema&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#a1d41af36fdb41de8ef52694e1d99210a">outputSchema</a> (Schema input)</td></tr>
<tr class="separator:a1d41af36fdb41de8ef52694e1d99210a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html" title="CreatePropGraphElements ... converts tuples of scalar data into bag of property graph elements...">CreatePropGraphElements</a> ... converts tuples of scalar data into bag of property graph elements.. </p>
<p><b>Example of use in pig sript:</b></p>
<pre>
<div class="fragment"><div class="line">* REGISTER target/graphbuilder-2.0alpha-with-deps.jar;</div>
<div class="line">* x = LOAD <span class="stringliteral">&#39;examples/data/employees.csv&#39;</span> USING PigStorage(<span class="charliteral">&#39;,&#39;</span>) AS (<span class="keywordtype">id</span>: <span class="keywordtype">int</span>, name: chararray, age: <span class="keywordtype">int</span>, dept: chararray, managerId: <span class="keywordtype">int</span>, tenure: chararray);</div>
<div class="line">* DEFINE <a class="code" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#ae0569dfa9380e4e3396894020579a242">CreatePropGraphElements</a> com.intel.pig.udf.eval.<a class="code" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#ae0569dfa9380e4e3396894020579a242">CreatePropGraphElements</a>(&#39;-v &quot;name=age,managerId&quot; -e &quot;name,dept,worksAt,tenure&quot;&#39;);</div>
<div class="line">* pge = FOREACH x GENERATE flatten(<a class="code" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html#ae0569dfa9380e4e3396894020579a242">CreatePropGraphElements</a>(*));</div>
<div class="line">*     </div>
</div><!-- fragment --> 
  </pre><p>The argument to the UDF constructor is a command string interpreted in the following manner: The rules for specifying a graph are, at present, as follows: </p>
<p>EDGES: The first three attributes in the edge string are source vertex field name, destination vertex field name and the string label. Optional property values are listed by the field names by which they are taken.</p>
<p><code> src_fname,dest_fname&gt;,label,edge_property_fname1,...edge_property_fnamen </code> </p>
<p>VERTICES: The first attribute in the string is an optional vertex label, the next is the required ertex ID field name. Subsequent attributes denote vertex properties and are separated from the first by an equals sign:</p>
<p><code> vertex_id_fieldname=vertex_prop1_fieldname,... vertex_propn_fieldname</code> </p>
<p>or in the case there are no properties associated with the vertex id: <code> vertex_id_fieldname </code> </p>
<ul>
<li></li>
</ul>
<p>EXAMPLE: </p>
<p><code>-v "name=age" -e "name,dept,worksAt,seniority"</code> </p>
<p>This generates a vertex for each employee annotated by their age, a vertex for each department with at least one employee, and an edge labeled "worksAt" between each employee and their department, annotated by their seniority in that department. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae0569dfa9380e4e3396894020579a242"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">com.intel.pig.udf.eval.CreatePropGraphElements.CreatePropGraphElements </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>tokenizationRule</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>UDF Constructor : uses parse rule in command string to initialize graph construction rules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tokenizationRule</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                            {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        commandLineInterface = <span class="keyword">new</span> CommandLineInterface();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        Options options = <span class="keyword">new</span> Options();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        options.addOption(BaseCLI.Options.vertex.get());</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        options.addOption(BaseCLI.Options.edge.get());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        options.addOption(BaseCLI.Options.directedEdge.get());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        options.addOption(BaseCLI.Options.flattenList.get());</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        commandLineInterface.setOptions(options);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        CommandLine cmd = commandLineInterface.checkCli(tokenizationRule.split(<span class="stringliteral">&quot; &quot;</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        this.tokenizationRule = tokenizationRule;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        vertexLabelMap = <span class="keyword">new</span> Hashtable&lt;String, String&gt;();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        vertexPropToFieldNamesMap = <span class="keyword">new</span> Hashtable&lt;String, String[]&gt;();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        vertexIdFieldList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        edgeLabelToEdgeRules  = <span class="keyword">new</span> Hashtable&lt;String, EdgeRule&gt;();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        vertexRules =</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                nullIntoEmptyArray(cmd.getOptionValues(BaseCLI.Options.vertex.getLongOpt()));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        rawEdgeRules =</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                nullIntoEmptyArray(cmd.getOptionValues(BaseCLI.Options.edge.getLongOpt()));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        rawDirectedEdgeRules =</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                nullIntoEmptyArray(cmd.getOptionValues(BaseCLI.Options.directedEdge.getLongOpt()));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        flattenLists = cmd.hasOption(BaseCLI.Options.flattenList.getLongOpt());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// Parse the column names of vertices and properties from command line prompt</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">// &lt;vertex_col1&gt;=[&lt;vertex_prop1&gt;,...] [&lt;vertex_col2&gt;=[&lt;vertex_prop1&gt;,...]]</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        String   vertexIdFieldName  = null;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        String   vertexLabel      = null;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">for</span> (String vertexRule : vertexRules) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">// this tokenizer is based off the old HBase -&gt; graph tokenizer and uses those parsing/extraction</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">// routines as subroutines... those routines have nothing to do with hbase and simply extract field</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">// (&quot;column&quot;) names from command strings</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            vertexIdFieldName = HBaseGraphBuildingRule.getVidColNameFromVertexRule(vertexRule);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            vertexIdFieldList.add(vertexIdFieldName);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            String[] vertexPropertiesFieldNames =</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    HBaseGraphBuildingRule.getVertexPropertyColumnsFromVertexRule(vertexRule);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            vertexPropToFieldNamesMap.put(vertexIdFieldName, vertexPropertiesFieldNames);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">// Vertex labels are maintained in a separate map</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            vertexLabel = HBaseGraphBuildingRule.getRDFTagFromVertexRule(vertexRule);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">if</span> (vertexLabel != null) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                vertexLabelMap.put(vertexIdFieldName, vertexLabel);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">for</span> (String rawEdgeRule : rawEdgeRules) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            String   srcVertexFieldName     = HBaseGraphBuildingRule.getSrcColNameFromEdgeRule(rawEdgeRule);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            String   tgtVertexFieldName     = HBaseGraphBuildingRule.getDstColNameFromEdgeRule(rawEdgeRule);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            String   label                = HBaseGraphBuildingRule.getLabelFromEdgeRule(rawEdgeRule);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            List&lt;String&gt; edgePropertyFieldNames =</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    HBaseGraphBuildingRule.getEdgePropertyColumnNamesFromEdgeRule(rawEdgeRule);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            EdgeRule edgeRule = <span class="keyword">new</span> EdgeRule(srcVertexFieldName, tgtVertexFieldName, BIDIRECTIONAL);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">for</span> (String edgePropertyFieldName : edgePropertyFieldNames) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                edgeRule.addPropertyColumnName(edgePropertyFieldName);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            edgeLabelToEdgeRules.put(label, edgeRule);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">for</span> (String rawDirectedEdgeRule : rawDirectedEdgeRules) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            String   srcVertexFieldName     = HBaseGraphBuildingRule.getSrcColNameFromEdgeRule(rawDirectedEdgeRule);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            String   tgtVertexFieldName     = HBaseGraphBuildingRule.getDstColNameFromEdgeRule(rawDirectedEdgeRule);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            String   label                = HBaseGraphBuildingRule.getLabelFromEdgeRule(rawDirectedEdgeRule);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            List&lt;String&gt; edgePropertyFieldNames =</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    HBaseGraphBuildingRule.getEdgePropertyColumnNamesFromEdgeRule(rawDirectedEdgeRule);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            EdgeRule edgeRule         = <span class="keyword">new</span> EdgeRule(srcVertexFieldName, tgtVertexFieldName, DIRECTED);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">for</span> (String edgePropertyFieldName : edgePropertyFieldNames) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                edgeRule.addPropertyColumnName(edgePropertyFieldName);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            edgeLabelToEdgeRules.put(label, edgeRule);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a74f67bf257906acb703a8e2e2f7612d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataBag com.intel.pig.udf.eval.CreatePropGraphElements.exec </td>
          <td>(</td>
          <td class="paramtype">Tuple&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td> throws IOException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>exec - the workhorse for the <a class="el" href="classcom_1_1intel_1_1pig_1_1udf_1_1eval_1_1CreatePropGraphElements.html" title="CreatePropGraphElements ... converts tuples of scalar data into bag of property graph elements...">CreatePropGraphElements</a> UDF</p>
<p>Takes a tuple of scalars and outputs a bag of property graph elements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>a tuple of scalars </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bag of property graph elements </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IOException</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                                        {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        Schema inputSchema = getInputSchema();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        fieldNameToDataType = <span class="keyword">new</span> Hashtable&lt;String,Byte&gt;();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">for</span> (Schema.FieldSchema field : inputSchema.getFields()) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            fieldNameToDataType.put(field.alias, field.type);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        DataBag outputBag = mBagFactory.newDefaultBag();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">// check tuple for vertices</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">for</span> (String fieldName : vertexIdFieldList) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            String vidCell = (String) getTupleData(input, inputSchema, fieldName);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">if</span> (null != vidCell) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">for</span> (String vertexId : expandString(vidCell)) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="comment">// create vertex</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    Vertex&lt;StringType&gt; vertex = <span class="keyword">new</span> Vertex&lt;StringType&gt;(<span class="keyword">new</span> StringType(vertexId));</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    <span class="comment">// add the vertex properties</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    String[] vpFieldNames = vertexPropToFieldNamesMap.get(fieldName);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    <span class="keywordflow">if</span> (null != vpFieldNames &amp;&amp; vpFieldNames.length &gt; 0) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        <span class="keywordflow">for</span> (String vertexPropertyFieldName : vpFieldNames) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                            Object value = null;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                            value =  getTupleData(input, inputSchema, vertexPropertyFieldName);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                            <span class="keywordflow">if</span> (value != null) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                    vertex.setProperty(vertexPropertyFieldName, pigTypesToSerializedJavaTypes(value,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                            fieldNameToDataType.get(vertexPropertyFieldName)));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                } <span class="keywordflow">catch</span> (ClassCastException e) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                    warn(<span class="stringliteral">&quot;Cannot cast Pig type to Java type, skipping entry.&quot;</span>, PigWarning.UDF_WARNING_1);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                            }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    <span class="comment">// add the abel to the vertex</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    String label = vertexLabelMap.get(fieldName);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    <span class="keywordflow">if</span> (label != null) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        vertex.setLabel(<span class="keyword">new</span> StringType(label));</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    addVertexToPropElementBag(outputBag, vertex);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            }  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                warn(<span class="stringliteral">&quot;Null data, skipping tuple.&quot;</span>, PigWarning.UDF_WARNING_1);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }<span class="comment">// End of vertex block</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// check tuple for edges</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        Object propertyValue;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        String property;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        String srcVertexFieldName;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        String tgtVertexFieldName;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">for</span> (String eLabel : edgeLabelToEdgeRules.keySet()) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordtype">int</span>          countEdgeAttr  = 0;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            EdgeRule     edgeRule           = edgeLabelToEdgeRules.get(eLabel);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            List&lt;String&gt; edgeAttributeList  = edgeRule.getPropertyFieldNames();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            String[]     edgeAttributes     = edgeAttributeList.toArray(<span class="keyword">new</span> String[edgeAttributeList.size()]);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            srcVertexFieldName     = edgeRule.getSrcFieldName();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            tgtVertexFieldName     = edgeRule.getDstFieldName();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            String srcVertexCellString = (String) getTupleData(input, inputSchema, srcVertexFieldName);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            String tgtVertexCellString = (String) getTupleData(input, inputSchema, tgtVertexFieldName);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            StringType srcLabel = null;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            String srcLabelString = vertexLabelMap.get(srcVertexFieldName);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">if</span> (srcLabelString != null) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                srcLabel = <span class="keyword">new</span> StringType(srcLabelString);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            StringType tgtLabel = null;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            String tgtLabelString = vertexLabelMap.get(tgtVertexFieldName);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">if</span> (tgtLabelString != null) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                tgtLabel = <span class="keyword">new</span> StringType(tgtLabelString);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">if</span> (srcVertexCellString != null &amp;&amp; tgtVertexCellString != null &amp;&amp; eLabel != null) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">for</span> (String srcVertexName : expandString(srcVertexCellString)) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    <span class="keywordflow">for</span> (String tgtVertexName: expandString(tgtVertexCellString)) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        Edge&lt;StringType&gt; edge = <span class="keyword">new</span> Edge&lt;StringType&gt;(<span class="keyword">new</span> StringType</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                (srcVertexName),srcLabel,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                <span class="keyword">new</span> StringType(tgtVertexName),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                tgtLabel, <span class="keyword">new</span> StringType(eLabel));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        <span class="keywordflow">for</span> (countEdgeAttr = 0; countEdgeAttr &lt; edgeAttributes.length; countEdgeAttr++) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                            propertyValue =  getTupleData(input, inputSchema, edgeAttributes[countEdgeAttr]);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                            <span class="keyword">property</span> = edgeAttributes[countEdgeAttr];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                            <span class="keywordflow">if</span> (propertyValue != null) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                edge.setProperty(property, pigTypesToSerializedJavaTypes(propertyValue,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                        fieldNameToDataType.get(edgeAttributes[countEdgeAttr])));</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                            }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        addEdgeToPropElementBag(outputBag, edge);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <span class="comment">// need to make sure both ends of the edge are proper</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        <span class="comment">// vertices!</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                        Vertex&lt;StringType&gt; srcVertex = <span class="keyword">new</span> Vertex&lt;StringType&gt;(<span class="keyword">new</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                StringType(srcVertexName), srcLabel);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        Vertex&lt;StringType&gt; tgtVertex = <span class="keyword">new</span> Vertex&lt;StringType&gt;(<span class="keyword">new</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                StringType(tgtVertexName), tgtLabel);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                        addVertexToPropElementBag(outputBag, srcVertex);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        addVertexToPropElementBag(outputBag, tgtVertex);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        <span class="keywordflow">if</span> (edgeRule.isBiDirectional()) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                            Edge&lt;StringType&gt; opposingEdge = <span class="keyword">new</span> Edge&lt;StringType&gt;(<span class="keyword">new</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                    StringType(tgtVertexName), tgtLabel,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                    <span class="keyword">new</span> StringType(srcVertexName), srcLabel,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                    <span class="keyword">new</span> StringType(eLabel));</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                            <span class="comment">// now add the edge properties</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                            <span class="keywordflow">for</span> (countEdgeAttr = 0; countEdgeAttr &lt; edgeAttributes.length; countEdgeAttr++) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                propertyValue = (String) getTupleData(input, inputSchema, edgeAttributes[countEdgeAttr]);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                <span class="keyword">property</span> = edgeAttributes[countEdgeAttr];</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                <span class="keywordflow">if</span> (propertyValue != null) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                    edge.setProperty(property, pigTypesToSerializedJavaTypes(propertyValue,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                            fieldNameToDataType.get(edgeAttributes[countEdgeAttr])));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                            }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                            addEdgeToPropElementBag(outputBag, opposingEdge);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">return</span> outputBag;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d41af36fdb41de8ef52694e1d99210a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Schema com.intel.pig.udf.eval.CreatePropGraphElements.outputSchema </td>
          <td>(</td>
          <td class="paramtype">Schema&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Provide return type information back to the Pig level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Schema for a bag of property graph elements packed into unary tuples. </dd></dl>
<div class="fragment"><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                             {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            Schema pgeTuple = <span class="keyword">new</span> Schema(<span class="keyword">new</span> Schema.FieldSchema(</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="stringliteral">&quot;property graph element (unary tuple)&quot;</span>, DataType.TUPLE));</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> Schema(<span class="keyword">new</span> Schema.FieldSchema(<span class="stringliteral">&quot;property graph elements&quot;</span>,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    pgeTuple, DataType.BAG));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        } <span class="keywordflow">catch</span> (FrontendException e) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="comment">// This should not happen</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> RuntimeException(<span class="stringliteral">&quot;Bug : exception thrown while &quot;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    + <span class="stringliteral">&quot;creating output schema for CreatePropGraphElements udf&quot;</span>, e);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/java/com/intel/pig/udf/eval/<a class="el" href="CreatePropGraphElements_8java.html">CreatePropGraphElements.java</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 20 2013 18:43:59 for GraphBuilder 2.0 (alpha) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
