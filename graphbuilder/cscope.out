cscope 15 $HOME/tribeca/sprint5/source_code/graphbuilder               0000283519
	@demoapps/com/intel/hadoop/graphbuilder/sampleapplications/CreateLinkGraph.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	g§m¶—µliÿtiÚs
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
.
	g‹xtšputfÜm©s
.
	gWikiPageIÅutFÜm©
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	g‹xtg¿ph
.
	gTextG¿phOuutCÚfigu¿tiÚ
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gOuutCÚfigu¿tiÚ
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªCommªdLšeO±iÚs
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªOuutCÚfigu¿tiÚ
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
.
	gTextFeIÅutCÚfigu¿tiÚ
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	glškg¿ph
.
	gLškG¿phBudšgRuË
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gG¿phCÚ¡ruùiÚP–še
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gCommªdLšeIÁ”çû
;

32 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTim”
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gO±iÚBud”
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gO±iÚs
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

60 
public
 cÏs 
	cC»©eLškG¿ph
 {

62 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
C»©eLškG¿ph
.
şass
);

63 
´iv©e
 
boŞ—n
 
	mt™ªAsD©aSšk
 = 
çl£
;

65 
´iv©e
 
CommªdLšeIÁ”çû
 
	mcommªdLšeIÁ”çû
 = 
Ãw
 CommandLineInterface();

69 
O±iÚs
 
	mİtiÚs
 = 
Ãw
 Options();

71 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("in")

72 .
w™hDesütiÚ
("input…ath")

73 .
hasArgs
()

74 .
isRequœed
()

75 .
w™hArgName
("input…ath")

76 .
ü—‹
("i"));

78 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("out")

79 .
w™hDesütiÚ
("output…ath")

80 .
hasArgs
()

81 .
w™hArgName
("output…ath")

82 .
ü—‹
("o"));

83 
	mİtiÚs
.
addO±iÚ
("t", "t™ª", 
çl£
, "select Titan for graph storage");

84 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
T™ªCommªdLšeO±iÚs
.
APPEND
)

85 .
w™hDesütiÚ
("Append Grapho Current Graph‡t Specified Titan Table")

86 .
ü—‹
("a"));

88 
	mcommªdLšeIÁ”çû
.
£tO±iÚs
(
İtiÚs
);

96 
´iv©e
 
	$checkCli
(
SŒšg
[] 
¬gs
) {

97 
SŒšg
 
ouutP©h
 = 
nuÎ
;

99 
CommªdLše
 
cmd
 = 
commªdLšeIÁ”çû
.
	`·r£Args
(
¬gs
);

101 ià(
cmd
.
	`hasO±iÚ
("out") && cmd.hasOption("titan")) {

102 
commªdLšeIÁ”çû
.
	`showH–p
("You cannot simultaneously specify‡ file‡nd Titan forhe output.");

103 } ià(!
cmd
.
	`hasO±iÚ
("t™ª"è&& cmd.hasO±iÚ(
T™ªCommªdLšeO±iÚs
.
APPEND
)) {

104 
commªdLšeIÁ”çû
.
	`showH–p
("You cannot‡ppend‡ Titan graph if you do‚ot writeo Titan. (Addhe -t option if you meanto dohis.)");

105 } ià(
cmd
.
	`hasO±iÚ
("out")) {

106 
ouutP©h
 = 
cmd
.
	`g‘O±iÚV®ue
("out");

107 
LOG
.
	`šfo
("ouuˆ·th: " + 
ouutP©h
);

108 } ià(
cmd
.
	`hasO±iÚ
("titan")) {

109 
t™ªAsD©aSšk
 = 
Œue
;

111 
commªdLšeIÁ”çû
.
	`showH–p
("An output…ath is„equired");

113 
	}
}

118 
public
 cÏs 
	cCÚ¡ruùiÚP–še
 
ex‹nds
 
	gG¿phCÚ¡ruùiÚP–še
 {

120 @
Ov”ride


121 
public
 
boŞ—n
 
shouldCËªBiDœeùiÚ®Edges
() {

122  
	gçl£
;

125 @
Ov”ride


126 
public
 
boŞ—n
 
shouldU£HBa£
() {

127  
	gçl£
;

137 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

138 
commªdLšeIÁ”çû
.
	`checkCli
(
¬gs
);

139 
	`checkCli
(
¬gs
);

141 
Tim”
 
tim”
 = 
Ãw
 
	`Tim”
();

143 
CÚ¡ruùiÚP–še
 
job
 = 
Ãw
 
	`C»©eLškG¿ph
().Ãw 
	`CÚ¡ruùiÚP–še
();

144 
job
 = (
CÚ¡ruùiÚP–še
è
commªdLšeIÁ”çû
.
	`g‘RuÁimeCÚfig
().
	`addCÚfig
(job);

146 
WikiPageIÅutFÜm©
 
fÜm©
 = 
Ãw
 
	`WikiPageIÅutFÜm©
();

147 
TextFeIÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
 = 
Ãw
 
	`TextFeIÅutCÚfigu¿tiÚ
(
fÜm©
);

148 
G¿phBudšgRuË
 
budšgRuË
 = 
Ãw
 
	`LškG¿phBudšgRuË
();

150 
OuutCÚfigu¿tiÚ
 
ouutCÚfigu¿tiÚ
 = 
nuÎ
;

152 ià(
t™ªAsD©aSšk
) {

153 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`T™ªOuutCÚfigu¿tiÚ
();

155 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`TextG¿phOuutCÚfigu¿tiÚ
();

158 
LOG
.
	`šfo
("========== Creating†ink graph ================");

159 
tim”
.
	`¡¬t
();

160 
job
.
	`run
(
šputCÚfigu¿tiÚ
, 
budšgRuË
, 
ouutCÚfigu¿tiÚ
, 
commªdLšeIÁ”çû
.
	`g‘Cmd
());

161 
LOG
.
	`šfo
("========== Done creating†ink graph ================");

162 
LOG
.
	`šfo
("Tim–­£d : " + 
tim”
.
	`cu¼’t_time
() + " seconds");

163 
	}
}

	@demoapps/com/intel/hadoop/graphbuilder/sampleapplications/CreateWordCountGraph.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	g§m¶—µliÿtiÚs
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
.
	gTextFeIÅutCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
.
	g‹xtšputfÜm©s
.
	gWikiPageIÅutFÜm©
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gOuutCÚfigu¿tiÚ
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	g‹xtg¿ph
.
	gTextG¿phOuutCÚfigu¿tiÚ
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªCommªdLšeO±iÚs
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªOuutCÚfigu¿tiÚ
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gwÜdcouÁg¿ph
.
	gWÜdCouÁG¿phBudšgRuË
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gG¿phCÚ¡ruùiÚP–še
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gCommªdLšeIÁ”çû
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTim”
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gO±iÚBud”
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gO±iÚs
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gTextIÅutFÜm©
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

61 
public
 cÏs 
	cC»©eWÜdCouÁG¿ph
 {

63 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
C»©eWÜdCouÁG¿ph
.
şass
);

64 
´iv©e
 
boŞ—n
 
	mt™ªAsD©aSšk
 = 
çl£
;

69 
public
 cÏs 
	cCÚ¡ruùiÚP–še
 
ex‹nds
 
	mG¿phCÚ¡ruùiÚP–še
 {

70 @
Ov”ride


71 
public
 
boŞ—n
 
shouldCËªBiDœeùiÚ®Edges
() {

72  
	mŒue
;

75 @
Ov”ride


76 
public
 
boŞ—n
 
shouldU£HBa£
() {

77  
	mçl£
;

81 
´iv©e
 
CommªdLšeIÁ”çû
 
	gcommªdLšeIÁ”çû
 = 
Ãw
 CommandLineInterface();

83 
O±iÚs
 
	gİtiÚs
 = 
Ãw
 Options();

84 
	gİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("in")

85 .
w™hDesütiÚ
("input…ath")

86 .
hasArgs
()

87 .
isRequœed
()

88 .
w™hArgName
("input…ath")

89 .
ü—‹
("i"));

90 
	gİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("out")

91 .
w™hDesütiÚ
("output…ath")

92 .
hasArgs
()

93 .
w™hArgName
("output…ath")

94 .
ü—‹
("o"));

95 
	gİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("titan")

96 .
w™hDesütiÚ
("select Titan for graph storage")

97 .
w™hArgName
("titan ")

98 .
ü—‹
("t"));

99 
	gİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
T™ªCommªdLšeO±iÚs
.
APPEND
)

100 .
w™hDesütiÚ
("Append Grapho Current Graph‡t Specified Titan Table")

101 .
ü—‹
("a"));

102 
	gİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("dictionary")

103 .
w™hDesütiÚ
("dictionary…ath")

104 .
hasArgs
()

105 .
w™hArgName
("dictionary…ath")

106 .
ü—‹
("d"));

107 
	gİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
("stopwords")

108 .
w™hDesütiÚ
("stop words…ath")

109 .
hasArgs
()

110 .
w™hArgName
("stop words…ath")

111 .
ü—‹
("s"));

112 
	gcommªdLšeIÁ”çû
.
£tO±iÚs
(
İtiÚs
);

120 
´iv©e
 
	$checkCli
(
SŒšg
[] 
¬gs
) {

121 
SŒšg
 
ouutP©h
 = 
nuÎ
;

123 
CommªdLše
 
cmd
 = 
commªdLšeIÁ”çû
.
	`·r£Args
(
¬gs
);

125 ià(
cmd
.
	`hasO±iÚ
("out") && cmd.hasOption("titan")) {

126 
commªdLšeIÁ”çû
.
	`showH–p
("You cannot simultaneously specify‡ file‡nd Titan forhe output.");

127 } ià(!
cmd
.
	`hasO±iÚ
("t™ª"è&& cmd.hasO±iÚ(
T™ªCommªdLšeO±iÚs
.
APPEND
)) {

128 
commªdLšeIÁ”çû
.
	`showH–p
("You cannot‡ppend‡ Titan graph if you do‚ot writeo Titan. (Addhe -t option if you meanto dohis.)");

129 } ià(
cmd
.
	`hasO±iÚ
("out")) {

130 
ouutP©h
 = 
cmd
.
	`g‘O±iÚV®ue
("out");

131 
LOG
.
	`šfo
("ouuˆ·th: " + 
ouutP©h
);

132 } ià(
cmd
.
	`hasO±iÚ
("titan")) {

133 
t™ªAsD©aSšk
 = 
Œue
;

135 
commªdLšeIÁ”çû
.
	`showH–p
("An output…ath is„equired");

138 
	}
}

146 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

147 
commªdLšeIÁ”çû
.
	`checkCli
(
¬gs
);

148 
	`checkCli
(
¬gs
);

150 
Tim”
 
tim”
 = 
Ãw
 
	`Tim”
();

152 
CÚ¡ruùiÚP–še
 
job
 = 
Ãw
 
	`C»©eWÜdCouÁG¿ph
().Ãw 
	`CÚ¡ruùiÚP–še
();

153 
job
 = (
CÚ¡ruùiÚP–še
è
commªdLšeIÁ”çû
.
	`g‘RuÁimeCÚfig
().
	`addCÚfig
(job);

155 ià(
commªdLšeIÁ”çû
.
	`hasO±iÚ
("d")) {

156 
SŒšg
 
diùiÚ¬yP©h
 = 
commªdLšeIÁ”çû
.
	`g‘O±iÚV®ue
("dictionary");

157 
job
.
	`addU£rO±
("DiùiÚ¬y", 
diùiÚ¬yP©h
);

158 
LOG
.
	`šfo
("DiùiÚ¬y…©h: " + 
diùiÚ¬yP©h
);

161 ià(
commªdLšeIÁ”çû
.
	`hasO±iÚ
("s")) {

162 
SŒšg
 
¡İwÜdsP©h
 = 
commªdLšeIÁ”çû
.
	`g‘O±iÚV®ue
("stopwords");

163 
job
.
	`addU£rO±
("DiùiÚ¬y", 
¡İwÜdsP©h
);

164 
LOG
.
	`šfo
("StİwÜd ·th: " + 
¡İwÜdsP©h
);

167 
TextIÅutFÜm©
 
fÜm©
 = 
Ãw
 
	`WikiPageIÅutFÜm©
();

168 
TextFeIÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
 = 
Ãw
 
	`TextFeIÅutCÚfigu¿tiÚ
(
fÜm©
);

169 
WÜdCouÁG¿phBudšgRuË
 
g¿phBudšgRuË
 = 
Ãw
 
	`WÜdCouÁG¿phBudšgRuË
();

171 
OuutCÚfigu¿tiÚ
 
ouutCÚfigu¿tiÚ
 = 
nuÎ
;

173 ià(
t™ªAsD©aSšk
) {

174 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`T™ªOuutCÚfigu¿tiÚ
();

177 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`TextG¿phOuutCÚfigu¿tiÚ
();

180 
LOG
.
	`šfo
("============= Creating Word Count Graph ===================");

181 
tim”
.
	`¡¬t
();

182 
job
.
	`run
(
šputCÚfigu¿tiÚ
, 
g¿phBudšgRuË
, 
ouutCÚfigu¿tiÚ
, 
commªdLšeIÁ”çû
.
	`g‘Cmd
());

183 
LOG
.
	`šfo
("========== Done Creating Word Count Graph ================");

184 
LOG
.
	`šfo
("Tim–­£d : " + 
tim”
.
	`cu¼’t_time
() + " seconds");

185 
	}
}

	@demoapps/com/intel/hadoop/graphbuilder/sampleapplications/TableToGraphDB.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	g§m¶—µliÿtiÚs
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gGBHTabËCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£G¿phBudšgRuË
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªCommªdLšeO±iÚs
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªOuutCÚfigu¿tiÚ
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gHBa£IÅutCÚfigu¿tiÚ
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gG¿phCÚ¡ruùiÚP–še
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gCommªdLšeIÁ”çû
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTim”
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.*;

33 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

92 
public
 cÏs 
	cTabËToG¿phDB
 {

94 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
TabËToG¿phDB
.
şass
);

96 
´iv©e
 
CommªdLšeIÁ”çû
 
	mcommªdLšeIÁ”çû
 = 
Ãw
 CommandLineInterface();

98 
O±iÚs
 
	mİtiÚs
 = 
Ãw
 Options();

99 
	mİtiÚs
.
addO±iÚ
("h", "h–p", 
çl£
, "");

101 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
T™ªCommªdLšeO±iÚs
.
APPEND
)

102 .
w™hDesütiÚ
("Append Grapho Current Graph‡t Specified Titan Table")

103 .
ü—‹
("a"));

105 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_TABLE_OPTNAME"))

106 .
w™hDesütiÚ
("HBaseable‚ame")

107 .
hasArgs
()

108 .
isRequœed
()

109 .
w™hArgName
("HBaseable‚ame")

110 .
ü—‹
("t"));

112 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))

113 .
w™hDesütiÚ
("Specifyhe HBase columns which‡re vertexokens‡nd vertex…roperties" +

114 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_VERTICES_OPTNAME") + "\"<vertex_col>=[<vertex_prop1>,...]\"")

115 .
hasArgs
()

116 .
isRequœed
()

117 .
w™hArgName
("Vertex-Column-Name")

118 .
ü—‹
("v"));

120 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_EDGES_OPTNAME"))

121 .
w™hDesütiÚ
("Specifyhe HTable columns which‡re undirectedƒdgeokens; " +

122 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_EDGES_OPTNAME") + "\"<src_vertex_col>,<dest_vertex_col>,<label>,[edge_property_col,...]\"..." +

124 .
hasArgs
()

125 .
w™hArgName
("Edge-Column-Name")

126 .
ü—‹
("e"));

128 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("FLATTEN_LISTS_OPTNAME"))

129 .
w™hDesütiÚ
("Flaghatƒxpends†ists into multiple items. " )

130 .
ü—‹
("F"));

131 
	mİtiÚs
.
addO±iÚ
(
O±iÚBud”
.
w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))

132 .
w™hDesütiÚ
("Specifyhe columns which‡re directedƒdgeokens; " +

133 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME") + "\"<src_vertex_col>,<dest_vertex_col>,<label>,[edge_property_col,...]\"..." +

135 .
hasArgs
()

136 .
w™hArgName
("Edge-Column-Name")

137 .
ü—‹
("d"));

140 
	mcommªdLšeIÁ”çû
.
£tO±iÚs
(
İtiÚs
);

146 
public
 cÏs 
	cCÚ¡ruùiÚP–še
 
ex‹nds
 
	gG¿phCÚ¡ruùiÚP–še
 {

153 @
Ov”ride


154 
public
 
boŞ—n
 
shouldCËªBiDœeùiÚ®Edges
() {

155  
	gçl£
;

163 @
Ov”ride


164 
public
 
boŞ—n
 
shouldU£HBa£
() {

165  
	gŒue
;

176 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

178 
Tim”
 
tim”
 = 
Ãw
 
	`Tim”
();

180 
commªdLšeIÁ”çû
.
	`checkCli
(
¬gs
);

181 ià(
nuÎ
 =ğ
commªdLšeIÁ”çû
.
	`g‘Cmd
()) {

182 
commªdLšeIÁ”çû
.
	`showH–p
("Error…arsing command†ine options");

183 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

184 "E¼Ü…¬sšg commªd†šİtiÚs", 
LOG
);

187 
CommªdLše
 
cmd
 = 
commªdLšeIÁ”çû
.
	`g‘Cmd
();

189 
CÚ¡ruùiÚP–še
 
job
 = 
Ãw
 
	`TabËToG¿phDB
().Ãw 
	`CÚ¡ruùiÚP–še
();

190 
job
 = (
CÚ¡ruùiÚP–še
è
commªdLšeIÁ”çû
.
	`g‘RuÁimeCÚfig
().
	`addCÚfig
(job);

192 
SŒšg
 
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

194 
HBa£IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
 = 
Ãw
 
	`HBa£IÅutCÚfigu¿tiÚ
(
¤cTabËName
);

195 
HBa£G¿phBudšgRuË
 
budšgRuË
 = 
Ãw
 
	`HBa£G¿phBudšgRuË
(
cmd
);

196 
T™ªOuutCÚfigu¿tiÚ
 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`T™ªOuutCÚfigu¿tiÚ
();

198 
LOG
.
	`šfo
("============= Creating graph from featureable ==================");

199 
tim”
.
	`¡¬t
();

200 
job
.
	`run
(
šputCÚfigu¿tiÚ
, 
budšgRuË
, 
ouutCÚfigu¿tiÚ
, 
cmd
);

201 
LOG
.
	`šfo
("========== Done creating graph from featureable ================");

202 
LOG
.
	`šfo
("Tim–­£d : " + 
tim”
.
	`cu¼’t_time
() + " seconds");

203 
	}
}

	@demoapps/com/intel/hadoop/graphbuilder/sampleapplications/TableToRDFGraph.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	g§m¶—µliÿtiÚs
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gG¿phCÚ¡ruùiÚP–še
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gGBHTabËCÚfigu¿tiÚ
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gHBa£IÅutCÚfigu¿tiÚ
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	grdf
.
	gRDFCÚfigu¿tiÚ
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	grdfg¿ph
.
	gRDFG¿phOuutCÚfigu¿tiÚ
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£G¿phBudšgRuË
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTim”
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.*;

32 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

89 
public
 cÏs 
	cTabËToRDFG¿ph
 {

91 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
TabËToRDFG¿ph
.
şass
);

93 
´iv©e
 
O±iÚs
 
	$ü—‹O±iÚs
() {

95 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
();

96 
İtiÚs
.
	`addO±iÚ
("h", "h–p", 
çl£
, "");

97 
İtiÚs
.
	`addO±iÚ
("o", "out", 
Œue
, "output…ath");

98 
İtiÚs
.
	`addO±iÚ
("t", 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"), 
Œue
, "HBaseable‚ame");

100 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))

101 .
	`w™hDesütiÚ
("Specifyhe columns which‡re vertexokens‡nd vertex…roperties" +

102 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME") + "\"<vertex_col>=[<vertex_prop1>,...]\"")

103 .
	`hasArgs
()

104 .
	`isRequœed
()

105 .
	`w™hArgName
("Vertex-Column-Name")

106 .
	`ü—‹
("v"));

108 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))

109 .
	`w™hDesütiÚ
("Specifyhe columns which‡re undirectedƒdgeokens; " +

110 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME") + "\"<src_vertex_col>,<dest_vertex_col>,<label>,[edge_property_col,...]\"..." +

112 .
	`hasArgs
()

113 .
	`w™hArgName
("Edge-Column-Name")

114 .
	`ü—‹
("e"));

116 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("FLATTEN_LISTS_OPTNAME"))

117 .
	`w™hDesütiÚ
("Flaghatƒxpends†ists into multiple items. ")

118 .
	`ü—‹
("F"));

120 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))

121 .
	`w™hDesütiÚ
("Specifyhe columns which‡re directedƒdgeokens; " +

122 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME") + "\"<src_vertex_col>,<dest_vertex_col>,<label>,[edge_property_col,...]\"..." +

124 .
	`hasArgs
()

125 .
	`w™hArgName
("Edge-Column-Name")

126 .
	`ü—‹
("d"));

127 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
RDFCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_RDF_NAMESPACE"))

128 .
	`w™hDesütiÚ
("Specifyhe RDF‚amespace [OWL | RDFS | RDF | XMLSchema] for vertices")

129 .
	`hasArgs
()

130 .
	`w™hArgName
("RDF-Namespace")

131 .
	`ü—‹
("n"));

133  
İtiÚs
;

136 
´iv©e
 
	$ex™W™hH–p
(
O±iÚs
 
İtiÚs
, 
SŒšg
 
mes§ge
, 
StusCode
 
¡©usCode
) {

138 
LOG
.
	`çl
(
mes§ge
);

140 
H–pFÜm©‹r
 
h
 = 
Ãw
 
	`H–pFÜm©‹r
();

141 
h
.
	`´štH–p
("TabËToRDFG¿ph", 
İtiÚs
);

143 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
¡©usCode
, 
mes§ge
, 
LOG
);

144 
	}
}

153 
´iv©e
 
CommªdLše
 
	$checkCli
(
SŒšg
[] 
¬gs
) {

155 
O±iÚs
 
İtiÚs
 = 
	`ü—‹O±iÚs
();

156 
SŒšg
 
¤cTabËName
 = 
nuÎ
;

157 
SŒšg
 
outTabËName
 = 
nuÎ
;

158 
CommªdLše
 
cmd
 = 
nuÎ
;

160 
Œy
 {

161 
CommªdLšeP¬£r
 
·r£r
 = 
Ãw
 
	`PosixP¬£r
();

162 
cmd
 = 
·r£r
.
	`·r£
(
İtiÚs
, 
¬gs
);

164 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"))) {

165 
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

166 
LOG
.
	`šfo
("TabË Name: " + 
¤cTabËName
);

168 
	`ex™W™hH–p
(
İtiÚs
, "AabË‚ami »quœed.", 
StusCode
.
BAD_COMMAND_LINE
);

171 ià(
cmd
.
	`hasO±iÚ
("o")) {

172 
outTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
("o");

173 
LOG
.
	`šfo
("Ouuˆ·th: " + 
outTabËName
);

175 
	`ex™W™hH–p
(
İtiÚs
, "AÀouuˆ·th i »quœed", 
StusCode
.
BAD_COMMAND_LINE
);

178 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))) {

179 
SŒšg
 
v
 : 
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))) {

180 
LOG
.
	`šfo
("V”tiûs: " + 
v
);

183 
	`ex™W™hH–p
(
İtiÚs
, "Please‡dd column family‡nd‚ames for vertices‡nd vertex…roperties",

184 
StusCode
.
BAD_COMMAND_LINE
);

187 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))) {

188 
SŒšg
 
e
 : 
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))) {

189 
LOG
.
	`šfo
("Edges: " + 
e
);

193 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))) {

194 
SŒšg
 
e
 : 
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))) {

195 
LOG
.
	`šfo
("Edges: " + 
e
);

199 ià(!(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))) &&

200 !(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME")))) {

201 
	`ex™W™hH–p
(
İtiÚs
, "Please‡dd column family‡nd‚ames for (directed)ƒdges‡nd (directed)ƒdge…roperties",

202 
StusCode
.
BAD_COMMAND_LINE
);

205 ià(!(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_RDF_NAMESPACE")))) {

206 
	`ex™W™hH–p
(
İtiÚs
, "Please‡dd RDF‚amespace",

207 
StusCode
.
BAD_COMMAND_LINE
);

210 } 
	`ÿtch
 (
P¬£Exû±iÚ
 
e
) {

211 
	`ex™W™hH–p
(
İtiÚs
, "P¬sšgƒxû±iÚ wh’…¬sšg commªd†še.", 
StusCode
.
BAD_COMMAND_LINE
);

214 
	`as£¹
(
cmd
 !ğ
nuÎ
);

215  
cmd
;

216 
	}
}

221 
public
 cÏs 
	cCÚ¡ruùiÚP–še
 
ex‹nds
 
	gG¿phCÚ¡ruùiÚP–še
 {

226 @
Ov”ride


227 
public
 
boŞ—n
 
shouldCËªBiDœeùiÚ®Edges
() {

228  
	gçl£
;

235 @
Ov”ride


236 
public
 
boŞ—n
 
shouldU£HBa£
() {

237  
	gŒue
;

248 
public
 
	$maš
(
SŒšg
[] 
¬gs
è
throws
 
Exû±iÚ
 {

250 
Tim”
 
tim”
 = 
Ãw
 
	`Tim”
();

252 
CommªdLše
 
cmd
 = 
	`checkCli
(
¬gs
);

253 
SŒšg
 
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

255 
CÚ¡ruùiÚP–še
 
job
 = 
Ãw
 
	`TabËToRDFG¿ph
().Ãw 
	`CÚ¡ruùiÚP–še
();

256 
HBa£IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
 = 
Ãw
 
	`HBa£IÅutCÚfigu¿tiÚ
(
¤cTabËName
);

258 
HBa£G¿phBudšgRuË
 
budšgRuË
 = 
Ãw
 
	`HBa£G¿phBudšgRuË
(
cmd
);

259 
RDFG¿phOuutCÚfigu¿tiÚ
 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`RDFG¿phOuutCÚfigu¿tiÚ
();

261 
LOG
.
	`šfo
("============= Creating graph from hbase ==================");

262 
tim”
.
	`¡¬t
();

263 
job
.
	`run
Ğ
šputCÚfigu¿tiÚ
,
budšgRuË
, 
ouutCÚfigu¿tiÚ
, 
cmd
);

264 
LOG
.
	`šfo
("========== Done creating graph from hbase ================");

265 
LOG
.
	`šfo
("Tim–­£d : " + 
tim”
.
	`cu¼’t_time
() + " seconds");

266 
	}
}

	@demoapps/com/intel/hadoop/graphbuilder/sampleapplications/TableToTextGraph.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	g§m¶—µliÿtiÚs
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gGBHTabËCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	g‹xtg¿ph
.
	gTextG¿phOuutCÚfigu¿tiÚ
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gHBa£IÅutCÚfigu¿tiÚ
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£G¿phBudšgRuË
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gG¿phCÚ¡ruùiÚP–še
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTim”
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.*;

31 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

88 
public
 cÏs 
	cTabËToTextG¿ph
 {

90 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
TabËToTextG¿ph
.
şass
);

92 
´iv©e
 
O±iÚs
 
	$ü—‹O±iÚs
() {

94 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
();

95 
İtiÚs
.
	`addO±iÚ
("h", "h–p", 
çl£
, "");

96 
İtiÚs
.
	`addO±iÚ
("o", "out", 
Œue
, "output…ath");

97 
İtiÚs
.
	`addO±iÚ
("t", 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"), 
Œue
, "HBaseable‚ame");

99 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))

100 .
	`w™hDesütiÚ
("Specifyhe columns which‡re vertexokens‡nd vertex…roperties" +

101 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME") + "\"<vertex_col>=[<vertex_prop1>,...]\"")

102 .
	`hasArgs
()

103 .
	`isRequœed
()

104 .
	`w™hArgName
("Vertex-Column-Name")

105 .
	`ü—‹
("v"));

107 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))

108 .
	`w™hDesütiÚ
("Specifyhe columns which‡re undirectedƒdgeokens; " +

109 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME") + "\"<src_vertex_col>,<dest_vertex_col>,<label>,[edge_property_col,...]\"..." +

111 .
	`hasArgs
()

112 .
	`w™hArgName
("Edge-Column-Name")

113 .
	`ü—‹
("e"));

115 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("FLATTEN_LISTS_OPTNAME"))

116 .
	`w™hDesütiÚ
("Flaghatƒxpends†ists into multiple items. " )

117 .
	`ü—‹
("F"));

119 
İtiÚs
.
	`addO±iÚ
(
O±iÚBud”
.
	`w™hLÚgO±
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))

120 .
	`w™hDesütiÚ
("Specifyhe columns which‡re directedƒdgeokens; " +

121 "Exam¶e: --" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME") + "\"<src_vertex_col>,<dest_vertex_col>,<label>,[edge_property_col,...]\"..." +

123 .
	`hasArgs
()

124 .
	`w™hArgName
("Edge-Column-Name")

125 .
	`ü—‹
("d"));

126  
İtiÚs
;

129 
´iv©e
 
	$ex™W™hH–p
(
O±iÚs
 
İtiÚs
, 
SŒšg
 
mes§ge
, 
StusCode
 
¡©usCode
) {

131 
LOG
.
	`çl
(
mes§ge
);

133 
H–pFÜm©‹r
 
h
 = 
Ãw
 
	`H–pFÜm©‹r
();

134 
h
.
	`´štH–p
("TabËToTextG¿ph", 
İtiÚs
);

136 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
¡©usCode
, 
mes§ge
, 
LOG
);

137 
	}
}

146 
´iv©e
 
CommªdLše
 
	$checkCli
(
SŒšg
[] 
¬gs
) {

148 
O±iÚs
 
İtiÚs
 = 
	`ü—‹O±iÚs
();

149 
SŒšg
 
¤cTabËName
 = 
nuÎ
;

150 
SŒšg
 
outTabËName
 = 
nuÎ
;

151 
CommªdLše
 
cmd
 = 
nuÎ
;

153 
Œy
 {

154 
CommªdLšeP¬£r
 
·r£r
 = 
Ãw
 
	`PosixP¬£r
();

155 
cmd
 = 
·r£r
.
	`·r£
(
İtiÚs
, 
¬gs
);

157 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"))) {

158 
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

159 
LOG
.
	`šfo
("TabË Name: " + 
¤cTabËName
);

161 
	`ex™W™hH–p
(
İtiÚs
, "AabË‚ami »quœed.", 
StusCode
.
BAD_COMMAND_LINE
);

164 ià(
cmd
.
	`hasO±iÚ
("o")) {

165 
outTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
("o");

166 
LOG
.
	`šfo
("Ouuˆ·th: " + 
outTabËName
);

168 
	`ex™W™hH–p
(
İtiÚs
, "AÀouuˆ·th i »quœed", 
StusCode
.
BAD_COMMAND_LINE
);

171 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))) {

172 
SŒšg
 
v
 : 
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME"))) {

173 
LOG
.
	`šfo
("V”tiûs: " + 
v
);

176 
	`ex™W™hH–p
(
İtiÚs
, "Please‡dd column family‡nd‚ames for vertices‡nd vertex…roperties",

177 
StusCode
.
BAD_COMMAND_LINE
);

180 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))) {

181 
SŒšg
 
e
 : 
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))) {

182 
LOG
.
	`šfo
("Edges: " + 
e
);

186 ià(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))) {

187 
SŒšg
 
e
 : 
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME"))) {

188 
LOG
.
	`šfo
("Edges: " + 
e
);

192 ià(!(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME"))) &&

193 !(
cmd
.
	`hasO±iÚ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME")))) {

194 
	`ex™W™hH–p
(
İtiÚs
, "Please‡dd column family‡nd‚ames for (directed)ƒdges‡nd (directed)ƒdge…roperties",

195 
StusCode
.
BAD_COMMAND_LINE
);

198 } 
	`ÿtch
 (
P¬£Exû±iÚ
 
e
) {

199 
	`ex™W™hH–p
(
İtiÚs
, "P¬sšgƒxû±iÚ wh’…¬sšg commªd†še.", 
StusCode
.
BAD_COMMAND_LINE
);

202 
	`as£¹
(
cmd
 !ğ
nuÎ
);

203  
cmd
;

204 
	}
}

209 
public
 cÏs 
	cCÚ¡ruùiÚP–še
 
ex‹nds
 
	gG¿phCÚ¡ruùiÚP–še
 {

214 @
Ov”ride


215 
public
 
boŞ—n
 
shouldCËªBiDœeùiÚ®Edges
() {

216  
	gçl£
;

223 @
Ov”ride


224 
public
 
boŞ—n
 
shouldU£HBa£
() {

225  
	gŒue
;

236 
public
 
	$maš
(
SŒšg
[] 
¬gs
è
throws
 
Exû±iÚ
 {

238 
Tim”
 
tim”
 = 
Ãw
 
	`Tim”
();

240 
CommªdLše
 
cmd
 = 
	`checkCli
(
¬gs
);

241 
SŒšg
 
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

243 
CÚ¡ruùiÚP–še
 
job
 = 
Ãw
 
	`TabËToTextG¿ph
().Ãw 
	`CÚ¡ruùiÚP–še
();

244 
HBa£IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
 = 
Ãw
 
	`HBa£IÅutCÚfigu¿tiÚ
(
¤cTabËName
);

245 
HBa£G¿phBudšgRuË
 
budšgRuË
 = 
Ãw
 
	`HBa£G¿phBudšgRuË
(
cmd
);

246 
TextG¿phOuutCÚfigu¿tiÚ
 
ouutCÚfigu¿tiÚ
 = 
Ãw
 
	`TextG¿phOuutCÚfigu¿tiÚ
();

248 
LOG
.
	`šfo
("============= Creating graph from hbase ==================");

249 
tim”
.
	`¡¬t
();

250 
job
.
	`run
Ğ
šputCÚfigu¿tiÚ
,
budšgRuË
, 
ouutCÚfigu¿tiÚ
, 
cmd
);

251 
LOG
.
	`šfo
("========== Done creating graph from hbase ================");

252 
LOG
.
	`šfo
("Tim–­£d : " + 
tim”
.
	`cu¼’t_time
() + " seconds");

253 
	}
}

	@src/com/intel/hadoop/graphbuilder/graphelements/Edge.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

27 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

28 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

40 
public
 
şass
 
	gEdge
<
VidTy³
 
ex‹nds
 
	gWr™abËCom·¿bË
<
	gVidTy³
>> 
im¶em’ts
 
	gWr™abË
 {

42 
´iv©e
 
VidTy³
 
	g¤c
;

43 
´iv©e
 
VidTy³
 
	gd¡
;

44 
´iv©e
 
SŒšgTy³
 
	gÏb–
;

45 
´iv©e
 
Prİ”tyM­
 
	g´İ”t›s
;

51 
public
 
Edge
() {

52 
	gthis
.
	g´İ”t›s
 = 
Ãw
 
Prİ”tyM­
();

62 
public
 
Edge
(
VidTy³
 
¤c
, VidTy³ 
d¡
, 
SŒšgTy³
 
Ïb–
) {

63 
	gthis
.
	g¤c
 = 
¤c
;

64 
	gthis
.
	gd¡
 = 
d¡
;

65 
	gthis
.
	gÏb–
 = 
Ïb–
;

66 
	gthis
.
	g´İ”t›s
 = 
Ãw
 
Prİ”tyM­
();

75 
public
 
cÚfigu»
(
VidTy³
 
¤c
, VidTy³ 
d¡
, 
SŒšgTy³
 
Ïb–
, 
Prİ”tyM­
 
´İ”t›s
) {

76 
	gthis
.
	g¤c
 = 
¤c
;

77 
	gthis
.
	gd¡
 = 
d¡
;

78 
	gthis
.
	gÏb–
 = 
Ïb–
;

79 
	gthis
.
	g´İ”t›s
 = 
´İ”t›s
;

86 
public
 
Objeù
 
g‘Prİ”ty
(
SŒšg
 
key
) {

87  
	g´İ”t›s
.
g‘Prİ”ty
(
key
);

98 
public
 
£tPrİ”ty
(
SŒšg
 
key
, 
Wr™abË
 
v®
) {

99 
	g´İ”t›s
.
£tPrİ”ty
(
key
, 
v®
);

105 
public
 
SŒšgTy³
 
g‘EdgeLab–
() {

106  
	gÏb–
;

112 
public
 
VidTy³
 
g‘Src
() {

113  
	g¤c
;

119 
public
 
VidTy³
 
g‘D¡
() {

120  
	gd¡
;

127 
public
 
boŞ—n
 
isS–fEdge
() {

128  
	gObjeùs
.
equ®s
(
¤c
, 
d¡
);

134 
public
 
Prİ”tyM­
 
g‘Prİ”t›s
() {

135  
	g´İ”t›s
;

142 
public
 
EdgeID
 
g‘EdgeID
() {

143  
Ãw
 
EdgeID
(
this
.
¤c
,his.
d¡
,his.
Ïb–
);

150 @
Ov”ride


151 
public
 
fš®
 
SŒšg
 
toSŒšg
() {

152  
	g¤c
.
toSŒšg
(è+ "\t" + 
	gd¡
.toString() + "\t"

153 + 
	gÏb–
.
toSŒšg
(è+ "\t" + 
	g´İ”t›s
.toString();

161 @
Ov”ride


162 
public
 
»adF›lds
(
D©aIÅut
 
šput
è
throws
 
	gIOExû±iÚ
 {

163 
	g¤c
.
»adF›lds
(
šput
);

164 
	gd¡
.
»adF›lds
(
šput
);

165 
	gÏb–
.
»adF›lds
(
šput
);

166 
	g´İ”t›s
.
»adF›lds
(
šput
);

174 @
Ov”ride


175 
public
 
wr™e
(
D©aOuut
 
ouut
è
throws
 
	gIOExû±iÚ
 {

176 
	g¤c
.
wr™e
(
ouut
);

177 
	gd¡
.
wr™e
(
ouut
);

178 
	gÏb–
.
wr™e
(
ouut
);

179 
	g´İ”t›s
.
wr™e
(
ouut
);

	@src/com/intel/hadoop/graphbuilder/graphelements/EdgeID.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTrË
;

35 
public
 cÏs 
	cEdgeID
 {

37 
´iv©e
 
	mTrË
<
	mObjeù
, Objeù, Objeù> 
	mŒË
 = 
nuÎ
;

46 
public
 
	$EdgeID
(
Objeù
 
¤c
, Objeù 
d¡
, Objeù 
Ïb–
) {

47 
ŒË
 = 
Ãw
 
	`TrË
(
¤c
, 
d¡
, 
Ïb–
);

53 
public
 
Objeù
 
	$g‘Src
() {

54  
ŒË
.
	`g‘A
();

55 
	}
}

60 
public
 
Objeù
 
	$g‘D¡
() {

61  
ŒË
.
	`g‘B
();

62 
	}
}

67 
public
 
Objeù
 
	$g‘Lab–
() {

68  
ŒË
.
	`g‘C
();

69 
	}
}

74 
public
 
	$£tSrc
(
Objeù
 
v®
) {

75 
ŒË
.
	`£tA
(
v®
);

76 
	}
}

81 
public
 
	$£tD¡
(
Objeù
 
v®
) {

82 
ŒË
.
	`£tB
(
v®
);

83 
	}
}

88 
public
 
	$£tLab–
(
Objeù
 
v®
) {

89 
ŒË
.
	`£tC
(
v®
);

90 
	}
}

97 
public
 
EdgeID
 
	$»v”£Edge
() {

98  
Ãw
 
	`EdgeID
(
this
.
	`g‘D¡
(),his.
	`g‘Src
(),his.
	`g‘Lab–
());

99 
	}
}

106 @
Ov”ride


107 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

108 ià(
obj
 
š¡ªûof
 
EdgeID
) {

109 
EdgeID
 
k
 = (EdgeIDè
obj
;

110  
this
.
ŒË
.
	`equ®s
(
k
.triple);

112  
çl£
;

113 
	}
}

115 @
Ov”ride


116 
public
 
	$hashCode
() {

117  
ŒË
.
	`hashCode
();

118 
	}
}

120 @
Ov”ride


121 
public
 
SŒšg
 
	$toSŒšg
() {

122  
ŒË
.
	`toSŒšg
();

123 
	}
}

	@src/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElement.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

38 
public
 
ab¡¿ù
 
şass
 
	gPrİ”tyG¿phEËm’t
<
VidTy³
 
ex‹nds
 
	gWr™abËCom·¿bË
<
	gVidTy³
>>

39 
im¶em’ts
 
	gWr™abË
 {

41 
public
 
	eG¿phEËm’tTy³
 {

42 
	gNULL_ELEMENT
,

43 
	gVERTEX
,

44 
	gEDGE


47 
´iv©e
 
G¿phEËm’tTy³
 
	gg¿phEËm’tTy³
;

48 
´iv©e
 
V”‹x
 
	gv”‹x
;

49 
´iv©e
 
Edge
 
	gedge
;

51 
public
 
Prİ”tyG¿phEËm’t
() {

52 
	gv”‹x
 = 
Ãw
 
V”‹x
<
VidTy³
>();

53 
	gedge
 = 
Ãw
 
Edge
<
VidTy³
>();

56 
public
 
ab¡¿ù
 
VidTy³
 
ü—‹Vid
();

64 
public
 
š™
(
G¿phEËm’tTy³
 
g¿phEËm’tTy³
, 
Objeù
 
v®ue
) {

66 
	gthis
.
	gg¿phEËm’tTy³
 = 
g¿phEËm’tTy³
;

68 ià(
	gg¿phEËm’tTy³
 =ğ
G¿phEËm’tTy³
.
VERTEX
) {

69 
this
.
v”‹x
 = (
V”‹x
<
VidTy³
>è
v®ue
;

70 
	gthis
.
	gedge
 = 
nuÎ
;

72 
	gthis
.
	gedge
 = (
Edge
<
VidTy³
>è
v®ue
;

73 
	gthis
.
	gv”‹x
 = 
nuÎ
;

81 
public
 
G¿phEËm’tTy³
 
g¿phEËm’tTy³
() {

82  
	gg¿phEËm’tTy³
;

89 
public
 
	gV”‹x
<
	gVidTy³
> 
v”‹x
() {

90  
	gv”‹x
;

97 
public
 
	gEdge
<
	gVidTy³
> 
edge
() {

98  
	gedge
;

101 @
Ov”ride


102 
public
 
»adF›lds
(
D©aIÅut
 
šput
è
throws
 
	gIOExû±iÚ
 {

104 
	gg¿phEËm’tTy³
 = 
šput
.
»adBoŞ—n
(è? 
G¿phEËm’tTy³
.
EDGE
 : G¿phEËm’tTy³.
VERTEX
;

106 ià(
	gg¿phEËm’tTy³
 =ğ
G¿phEËm’tTy³
.
VERTEX
) {

108 
VidTy³
 
vid
 = 
nuÎ
;

110 
	gŒy
 {

111 
	gvid
 = 
ü—‹Vid
();

112 } 
ÿtch
 (
Exû±iÚ
 
e
) {

113 
	ge
.
´štSckT¿û
();

116 
Prİ”tyM­
 
	gpm
 = 
Ãw
 PropertyMap();

118 
	gv”‹x
.
cÚfigu»
(
vid
, 
pm
);

119 
	gv”‹x
.
»adF›lds
(
šput
);

122 
	gŒy
 {

124 
VidTy³
 
	gsourû
 = 
ü—‹Vid
();

125 
VidTy³
 
	grg‘
 = 
ü—‹Vid
();

127 
SŒšgTy³
 
	gÏb–
 = 
Ãw
 StringType();

128 
Prİ”tyM­
 
	gpm
 = 
Ãw
 PropertyMap();

130 
	gedge
.
cÚfigu»
(
sourû
, 
rg‘
, 
Ïb–
, 
pm
);

131 
	gedge
.
»adF›lds
(
šput
);

133 } 
ÿtch
 (
Exû±iÚ
 
e
) {

134 
	ge
.
´štSckT¿û
();

139 @
Ov”ride


140 
public
 
wr™e
(
D©aOuut
 
ouut
è
throws
 
	gIOExû±iÚ
 {

142 
boŞ—n
 
	gty³B™
 = 
g¿phEËm’tTy³
 =ğ
G¿phEËm’tTy³
.
EDGE
 ? 
Œue
 : 
çl£
;

144 
	gouut
.
wr™eBoŞ—n
(
ty³B™
);

146 ià(
	gg¿phEËm’tTy³
 =ğ
G¿phEËm’tTy³
.
VERTEX
) {

147 
v”‹x
.
wr™e
(
ouut
);

149 
	gedge
.
wr™e
(
ouut
);

153 @
Ov”ride


154 
public
 
SŒšg
 
toSŒšg
() {

155 
	gg¿phEËm’tTy³
) {

156 
	gVERTEX
:

157  
v”‹x
.
toSŒšg
();

158 
	gEDGE
:

159  
edge
.
toSŒšg
();

161  
Ãw
 
SŒšg
("null graphƒlement");

	@src/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementLongTypeVids.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gLÚgTy³
;

24 
public
 
şass
 
Prİ”tyG¿phEËm’tLÚgTy³Vids
 
ex‹nds
 
	gPrİ”tyG¿phEËm’t
<
	gLÚgTy³
> {

25 
public
 
LÚgTy³
 
ü—‹Vid
() {

26  
Ãw
 
LÚgTy³
();

	@src/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementStringTypeVids.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

24 
public
 
şass
 
Prİ”tyG¿phEËm’tSŒšgTy³Vids
 
ex‹nds
 
	gPrİ”tyG¿phEËm’t
<
	gSŒšgTy³
> {

25 
public
 
SŒšgTy³
 
ü—‹Vid
() {

26  
Ãw
 
SŒšgTy³
();

	@src/com/intel/hadoop/graphbuilder/graphelements/ValueClassFactory.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’tLÚgTy³Vids
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’tSŒšgTy³Vids
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gLÚgTy³
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

31 
public
 cÏs 
	cV®ueCÏssFaùÜy
 {

40 
public
 
CÏss
 
	$g‘V®ueCÏssByVidCÏssName
(
SŒšg
 
vidCÏssName
è
throws
 
IÎeg®Argum’tExû±iÚ
 {

42 ià(
vidCÏssName
.
	`equ®s
(
SŒšgTy³
.
şass
.
	`g‘Name
())) {

43  
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
;

44 } ià(
vidCÏssName
.
	`equ®s
(
LÚgTy³
.
şass
.
	`g‘Name
())) {

45  
Prİ”tyG¿phEËm’tLÚgTy³Vids
.
şass
;

47 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("IÎeg® v”‹x ID cÏs " + 
vidCÏssName
);

50 
	}
}

	@src/com/intel/hadoop/graphbuilder/graphelements/Vertex.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

27 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

28 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

41 
public
 
şass
 
	gV”‹x
<
V”‹xIdTy³
 
ex‹nds
 
	gWr™abËCom·¿bË
<
	gV”‹xIdTy³
>> 
im¶em’ts
 
	gWr™abË
 {

43 
´iv©e
 
V”‹xIdTy³
 
	gv”‹xId
;

44 
´iv©e
 
Prİ”tyM­
 
	g´İ”t›s
;

45 
´iv©e
 
SŒšgTy³
 
	gv”‹xLab–
;

50 
public
 
V”‹x
() {

51 
	gthis
.
	g´İ”t›s
 = 
Ãw
 
Prİ”tyM­
();

52 
	gthis
.
	gv”‹xLab–
 = 
Ãw
 
SŒšgTy³
();

60 
public
 
V”‹x
(
V”‹xIdTy³
 
vid
) {

61 
	gthis
.
	gv”‹xId
 = 
vid
;

62 
	gthis
.
	g´İ”t›s
 = 
Ãw
 
Prİ”tyM­
();

63 
	gthis
.
	gv”‹xLab–
 = 
Ãw
 
SŒšgTy³
();

72 
public
 
V”‹x
(
V”‹xIdTy³
 
vid
, 
SŒšg
 
Ïb–
) {

73 
	gthis
.
	gv”‹xId
 = 
vid
;

74 
	gthis
.
	g´İ”t›s
 = 
Ãw
 
Prİ”tyM­
();

75 
	gthis
.
	gv”‹xLab–
 = 
Ãw
 
SŒšgTy³
(
Ïb–
);

82 
public
 
V”‹xIdTy³
 
g‘V”‹xId
() {

83  
	gv”‹xId
;

90 
public
 
SŒšgTy³
 
g‘V”‹xLab–
() {

91  
	gthis
.
	gv”‹xLab–
;

98 
public
 
cÚfigu»
(
V”‹xIdTy³
 
vid
, 
Prİ”tyM­
 
´İ”t›s
) {

99 
	gthis
.
	gv”‹xId
 = 
vid
;

100 
	gthis
.
	g´İ”t›s
 = 
´İ”t›s
;

108 
public
 
Objeù
 
g‘Prİ”ty
(
SŒšg
 
key
) {

109  
	g´İ”t›s
.
g‘Prİ”ty
(
key
);

117 
public
 
£tPrİ”ty
(
SŒšg
 
key
, 
Wr™abË
 
v®
) {

118 
	gthis
.
	g´İ”t›s
.
£tPrİ”ty
(
key
, 
v®
);

125 
public
 
Prİ”tyM­
 
g‘Prİ”t›s
() {

126  
	g´İ”t›s
;

133 @
Ov”ride


134 
public
 
fš®
 
SŒšg
 
toSŒšg
() {

135 ià(
	gthis
.
	gv”‹xLab–
.
isEm±y
()) {

136  
	gthis
.
	gv”‹xId
.
toSŒšg
(è+ "\t" +his.
	g´İ”t›s
.toString();

138  
	gthis
.
	gv”‹xId
.
toSŒšg
(è+ "\t" +his.
	gv”‹xLab–
.toSŒšg(è+ "\t" + 
	g´İ”t›s
.toString();

147 @
Ov”ride


148 
public
 
»adF›lds
(
D©aIÅut
 
šput
è
throws
 
	gIOExû±iÚ
 {

149 
	gv”‹xId
.
»adF›lds
(
šput
);

150 
	gv”‹xLab–
.
»adF›lds
(
šput
);

151 
	gthis
.
	g´İ”t›s
.
»adF›lds
(
šput
);

159 @
Ov”ride


160 
public
 
wr™e
(
D©aOuut
 
ouut
è
throws
 
	gIOExû±iÚ
 {

161 
	gv”‹xId
.
wr™e
(
ouut
);

162 
	gv”‹xLab–
.
wr™e
(
ouut
);

163 
	g´İ”t›s
.
wr™e
(
ouut
);

	@src/com/intel/hadoop/graphbuilder/pipeline/GraphConstructionPipeline.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV®ueCÏssFaùÜy
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gOuutCÚfigu¿tiÚ
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

54 
public
 
ab¡¿ù
 
şass
 
	gG¿phCÚ¡ruùiÚP–še
<
VidTy³
 
ex‹nds
 
	gWr™abËCom·¿bË
<
	gVidTy³
>> {

56 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
G¿phCÚ¡ruùiÚP–še
.
şass
);

58 
´iv©e
 
	gHashM­
<
	gSŒšg
, SŒšg> 
	gu£rO±s
;

60 
public
 
G¿phCÚ¡ruùiÚP–še
() {

61 
	gthis
.
	gu£rO±s
 = 
Ãw
 
HashM­
<
SŒšg
, 
	gSŒšg
>();

64 
public
 
ab¡¿ù
 
boŞ—n
 
shouldCËªBiDœeùiÚ®Edges
();

66 
public
 
ab¡¿ù
 
boŞ—n
 
shouldU£HBa£
();

68 
public
 
addU£rO±
(
SŒšg
 
key
, SŒšg 
v®ue
) {

69 
	gu£rO±s
.
put
(
key
, 
v®ue
);

72 
public
 
run
(
IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
,

73 
G¿phBudšgRuË
 
g¿phBudšgRuË
,

74 
OuutCÚfigu¿tiÚ
 
ouutCÚfigu¿tiÚ
,

75 
CommªdLše
 
cmd
) {

78 
G¿phG’”©iÚMRJob
 
	gg¿phG’”©iÚMRJob
 = 
ouutCÚfigu¿tiÚ
.
g‘G¿phG’”©iÚMRJob
();

82 
	gg¿phG’”©iÚMRJob
.
š™
(
šputCÚfigu¿tiÚ
, 
g¿phBudšgRuË
);

84 
CÏss
 
	gvidCÏss
 = 
g¿phBudšgRuË
.
vidCÏss
();

85 
CÏss
 
	gv®ueCÏss
 = 
V®ueCÏssFaùÜy
.
g‘V®ueCÏssByVidCÏssName
(
vidCÏss
.
g‘Name
());

87 
	gg¿phG’”©iÚMRJob
.
£tVidCÏss
(
vidCÏss
);

88 
	gg¿phG’”©iÚMRJob
.
£tV®ueCÏss
(
v®ueCÏss
);

92 
	gg¿phG’”©iÚMRJob
.
£tCËªBidœeùiÚ®Edges
(
shouldCËªBiDœeùiÚ®Edges
());

96 ià(
	gu£rO±s
 !ğ
nuÎ
) {

97 
g¿phG’”©iÚMRJob
.
£tU£rO±iÚs
(
u£rO±s
);

100 
	gŒy
 {

101 
	gg¿phG’”©iÚMRJob
.
run
(
cmd
);

102 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

103 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

104 "IO Exû±iÚ duršg m­-»duû jobƒxecutiÚ.", 
LOG
, 
e
);

105 } 
ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

106 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

107 "CÏs nÙ foundƒxû±iÚ duršg m­-»duû jobƒxecutiÚ.", 
LOG
, 
e
);

108 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

109 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
HADOOP_REPORTED_ERROR
,

110 "IÁ”ru±iÚ duršg m­-»duû jobƒxecutiÚ.", 
LOG
, 
e
);

	@src/com/intel/hadoop/graphbuilder/pipeline/input/BaseMapper.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gKeyFunùiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

34 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

43 
public
 cÏs 
	cBa£M­³r
 {

50 
´iv©e
 
	eCouÁ”s
 {

51 
	mVERTEX_WRITE_ERROR
,

52 
	mEDGE_WRITE_ERROR
,

55 
´iv©e
 
Logg”
 
	glog
;

56 
´iv©e
 
IÁWr™abË
 
	gm­Key
;

57 
´iv©e
 
Prİ”tyG¿phEËm’t
 
	gm­V®
;

58 
´iv©e
 
CÏss
 
	gv®CÏss
;

59 
´iv©e
 
G¿phTok’iz”
 
	gtok’iz”
;

60 
´iv©e
 
KeyFunùiÚ
 
	gkeyFunùiÚ
;

61 
´iv©e
 
	gM­³r
.
CÚ‹xt
 
	gcÚ‹xt
;

62 
´iv©e
 
CÚfigu¿tiÚ
 
	gcÚf
;

72 
public
 
	$Ba£M­³r
(
M­³r
.
CÚ‹xt
 
cÚ‹xt
, 
CÚfigu¿tiÚ
 
cÚf
, 
Logg”
 
log
) {

73 
this
.
cÚ‹xt
 = context;

74 
this
.
log
 =†og;

75 
this
.
cÚf
 = conf;

76 
	`£tUp
(
cÚf
);

77 
	}
}

87 
public
 
	$£tUp
(
CÚfigu¿tiÚ
 
cÚf
) {

89 
	`š™ŸlizeTok’iz”
(
cÚf
);

90 
	`š™ŸlizeKeyFunùiÚ
(
cÚf
);

91 
	`£tV®CÏss
(
cÚ‹xt
.
	`g‘M­OuutV®ueCÏss
());

93 
Œy
 {

94 
	`£tM­V®
((
Prİ”tyG¿phEËm’t
è
v®CÏss
.
	`ÃwIn¡ªû
());

95 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

96 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

97 "CªnÙ in¡ªtŸ‹ m­ v®uşas (" + 
Prİ”tyG¿phEËm’t
.
şass
.
	`g‘Name
(è+ " )", 
log
, 
e
);

98 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

99 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

101 + 
Prİ”tyG¿phEËm’t
.
şass
.
	`g‘Name
(è+ " )", 
log
, 
e
);

104 
	`£tM­Key
(
Ãw
 
	`IÁWr™abË
());

105 
	}
}

113 
´Ùeùed
 
	$š™ŸlizeKeyFunùiÚ
(
CÚfigu¿tiÚ
 
cÚf
) {

114 
Œy
 {

115 
this
.
keyFunùiÚ
 = (
KeyFunùiÚ
è
CÏss
.
	`fÜName
(
cÚf
.
	`g‘
("KeyFunùiÚ")).
	`ÃwIn¡ªû
();

116 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

117 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

118 "Could‚Ù fšd cÏs Çmed fÜ key funùiÚ.", 
log
, 
e
);

119 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

120 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

121 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg key funùiÚ.", 
log
, 
e
);

122 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

123 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

124 "In¡ªtŸtiÚƒxû±iÚ wh’ in¡ªtŸtšg key funùiÚ.", 
log
, 
e
);

126 
	}
}

134 
´Ùeùed
 
	$š™ŸlizeTok’iz”
(
CÚfigu¿tiÚ
 
cÚf
) {

135 
Œy
 {

136 
this
.
tok’iz”
 = (
G¿phTok’iz”
è
CÏss
.
	`fÜName
(
cÚf
.
	`g‘
("G¿phTok’iz”")).
	`ÃwIn¡ªû
();

137 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

138 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

139 "Could‚Ù fšd cÏs Çmed fÜok’iz”.", 
log
, 
e
);

140 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

141 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

142 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšgok’iz”.", 
log
, 
e
);

143 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

144 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

145 "In¡ªtŸtiÚƒxû±iÚ wh’ in¡ªtŸtšgok’iz”.", 
log
, 
e
);

147 
this
.
tok’iz”
.
	`cÚfigu»
(
cÚf
);

148 
	}
}

156 
´Ùeùed
 
	$šüem’tE¼ÜCouÁ”
(
M­³r
.
CÚ‹xt
 
cÚ‹xt
, 
Prİ”tyG¿phEËm’t
 
v®
) {

157 ià(
v®
.
	`g¿phEËm’tTy³
().
	`equ®s
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
EDGE
)) {

158 
cÚ‹xt
.
	`g‘CouÁ”
(
	`g‘EdgeWr™eE¼ÜCouÁ”
()).
	`šüem’t
(1);

159 } ià(
v®
.
	`g¿phEËm’tTy³
().
	`equ®s
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
)) {

160 
cÚ‹xt
.
	`g‘CouÁ”
(
	`g‘V”‹xWr™eE¼ÜCouÁ”
()).
	`šüem’t
(1);

162 
	}
}

172 
´Ùeùed
 
	$cÚ‹xtWr™e
(
M­³r
.
CÚ‹xt
 
cÚ‹xt
, 
IÁWr™abË
 
key
, 
Prİ”tyG¿phEËm’t
 
v®
) {

173 
Œy
 {

174 
cÚ‹xt
.
	`wr™e
(
key
, 
v®
);

175 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

176 
	`šüem’tE¼ÜCouÁ”
(
cÚ‹xt
, 
v®
);

177 
log
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

178 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

179 
	`šüem’tE¼ÜCouÁ”
(
cÚ‹xt
, 
v®
);

180 
log
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

182 
	}
}

190 
public
 
	$wr™eEdges
(
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

191 
Œy
 {

192 
I‹¿tÜ
<
Edge
> 
edgeI‹¿tÜ
 = 
tok’iz”
.
	`g‘Edges
();

194 
edgeI‹¿tÜ
.
	`hasNext
()) {

196 
Edge
 
edge
 = 
edgeI‹¿tÜ
.
	`Ãxt
();

198 
m­V®
.
	`š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
EDGE
, 
edge
);

199 
m­Key
.
	`£t
(
keyFunùiÚ
.
	`g‘EdgeKey
(
edge
));

201 
	`cÚ‹xtWr™e
(
cÚ‹xt
, 
m­Key
, 
m­V®
);

203 } 
	`ÿtch
 (
NuÎPoš‹rExû±iÚ
 
e
) {

204 
cÚ‹xt
.
	`g‘CouÁ”
(
	`g‘EdgeWr™eE¼ÜCouÁ”
()).
	`šüem’t
(1);

205 
log
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

207 
	}
}

215 
public
 
	$wr™eV”tiûs
(
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

216 
Œy
 {

217 
I‹¿tÜ
<
V”‹x
> 
v”‹xI‹¿tÜ
 = 
tok’iz”
.
	`g‘V”tiûs
();

218 
v”‹xI‹¿tÜ
.
	`hasNext
()) {

220 
V”‹x
 
v”‹x
 = 
v”‹xI‹¿tÜ
.
	`Ãxt
();

222 
m­V®
.
	`š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
, 
v”‹x
);

223 
m­Key
.
	`£t
(
keyFunùiÚ
.
	`g‘V”‹xKey
(
v”‹x
));

225 
	`cÚ‹xtWr™e
(
cÚ‹xt
, 
m­Key
, 
m­V®
);

227 } 
	`ÿtch
 (
NuÎPoš‹rExû±iÚ
 
e
) {

228 
cÚ‹xt
.
	`g‘CouÁ”
(
	`g‘V”‹xWr™eE¼ÜCouÁ”
()).
	`šüem’t
(1);

229 
log
.
	`”rÜ
(
e
.
	`g‘Mes§ge
(),ƒ);

231 
	}
}

233 
public
 
	$£tM­Key
(
IÁWr™abË
 
m­Key
) {

234 
this
.
m­Key
 = mapKey;

235 
	}
}

237 
public
 
	$£tM­V®
(
Prİ”tyG¿phEËm’t
 
m­V®
) {

238 
this
.
m­V®
 = mapVal;

239 
	}
}

241 
public
 
	$£tV®CÏss
(
CÏss
 
v®CÏss
) {

242 
this
.
v®CÏss
 = valClass;

243 
	}
}

245 
public
 
G¿phTok’iz”
 
	$g‘Tok’iz”
() {

246  
tok’iz”
;

247 
	}
}

255 
public
 
CouÁ”s
 
	$g‘EdgeWr™eE¼ÜCouÁ”
() {

256  
CouÁ”s
.
EDGE_WRITE_ERROR
;

257 
	}
}

265 
public
 
CouÁ”s
 
	$g‘V”‹xWr™eE¼ÜCouÁ”
() {

266  
CouÁ”s
.
VERTEX_WRITE_ERROR
;

267 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/input/InputConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gJob
;

40 
public
 
š‹rçû
 
	gIÅutCÚfigu¿tiÚ
 {

42 
public
 
upd©eCÚfigu¿tiÚFÜM­³r
 (
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
CommªdLše
 
cmd
);

44 
public
 
upd©eJobFÜM­³r
(
Job
 
job
, 
CommªdLše
 
cmd
);

46 
public
 
boŞ—n
 
u£sHBa£
();

48 
public
 
CÏss
 
g‘M­³rCÏss
();

50 
public
 
SŒšg
 
g‘DesütiÚ
();

	@src/com/intel/hadoop/graphbuilder/pipeline/input/hbase/GBHTableConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gRuÁimeCÚfig
;

27 
public
 cÏs 
	cGBHTabËCÚfigu¿tiÚ
 {

29 
public
 
	eCouÁ”s
 {

30 
	mHTABLE_ROWS_READ
,

31 
	mHTABLE_COLS_READ
,

32 
	mHTABLE_COLS_IGNORED
,

33 
	mHTABLE_ROWS_WRITTEN
,

34 
	mHTABLE_COLS_WRITTEN
,

35 
	mVERTICES_WRITTEN
,

36 
	mVERTEX_PROPERTIES_WRITTEN
,

37 
	mHTABLE_COL_READ_ERROR
,

38 
	mERROR
,

45 
public
 
fš®
 
SŒšg
 
	gCOL_NAME_SEPARATOR
 = "#";

46 
public
 
fš®
 
SŒšg
 
	gVIDMAP_HTABLE_NAME
 = "GB_VidMap";

47 
public
 
fš®
 
SŒšg
 
	gVIDMAP_HTABLE_HCD
 = "vidmap";

48 
public
 
fš®
 
SŒšg
 
	gVCN_CONF_NAME
 = "VertexColNames";

49 
public
 
fš®
 
SŒšg
 
	gECN_CONF_NAME
 = "EdgeColNames";

50 
public
 
fš®
 
SŒšg
 
	gDECN_CONF_NAME
 = "DirectedEdgeColNames";

51 
public
 
fš®
 
SŒšg
 
	gVERTEX_PROP_COLFAMILY
 = "VertexPropertyCF";

52 
public
 
fš®
 
SŒšg
 
	gVERTEX_PROP_IDCOLQUALIFIER
 = "VertexID";

53 
public
 
fš®
 
SŒšg
 
	gCMD_EDGES_OPTNAME
 = "edges";

54 
public
 
fš®
 
SŒšg
 
	gCMD_DIRECTED_EDGES_OPTNAME
 = "directedEdges";

55 
public
 
fš®
 
SŒšg
 
	gCMD_TABLE_OPTNAME
 = "tablename";

56 
public
 
fš®
 
SŒšg
 
	gCMD_VERTICES_OPTNAME
 = "vertices";

57 
public
 
fš®
 
SŒšg
 
	gFLATTEN_LISTS_OPTNAME
 = "flattenlists";

60 
public
 
fš®
 
	gHBASE_CACHE_SIZE
 = 500;

61 
public
 
fš®
 
SŒšg
 
	gTITAN_HBASE_TABLENAME
 = "GBTitan";

62 
public
 
fš®
 
SŒšg
 
	gTITAN_HBASE_STORAGE_TIMEOUT
 = "10000";

64 
public
 
fš®
 
SŒšg
 
	gHBASE_COLUMN_SEPARATOR
 = ":";

65 
public
 
fš®
 
SŒšg
 
	gGRAPH_PROPERTY_SEPARATOR
 = "_";

66 
public
 
fš®
 
SŒšg
 
	gNULLKEY
 = "NULLKEY";

68 
public
 
RuÁimeCÚfig
 
	gcÚfig
 = RuÁimeCÚfig.
g‘In¡ªû
(
GBHTabËCÚfigu¿tiÚ
.
şass
);

	@src/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseInputConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gHBa£Uts
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gSÿn
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gm­»duû
.
	gTabËM­ReduûUt
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gJob
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

35 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

55 
public
 cÏs 
	cHBa£IÅutCÚfigu¿tiÚ
 
im¶em’ts
 
	mIÅutCÚfigu¿tiÚ
 {

57 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
HBa£IÅutCÚfigu¿tiÚ
.
şass
);

59 
´iv©e
 
HBa£Uts
 
	mhBa£Uts
 = 
nuÎ
;

60 
´iv©e
 
SŒšg
 
	m¤cTabËName
 = 
nuÎ
;

61 
´iv©e
 
Sÿn
 
	msÿn
 = 
Ãw
 Scan();

63 
´iv©e
 
CÏss
 
	mm­³rCÏss
 = 
HBa£R—d”M­³r
.
şass
;

68 
public
 
	$HBa£IÅutCÚfigu¿tiÚ
(
SŒšg
 
¤cTabËName
) {

70 
this
.
¤cTabËName
 = srcTableName;

71 
Œy
 {

72 
this
.
hBa£Uts
 = 
HBa£Uts
.
	`g‘In¡ªû
();

73 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

74 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_CONNECT_TO_HBASE
,

75 "CªnÙ‡Îoÿ‹hHBa£Ut objeù. Check hba£ cÚÃùiÚ.", 
LOG
, 
e
);

78 
Œy
 {

79 ià(!
hBa£Uts
.
	`bËExi¡s
(
¤cTabËName
)) {

80 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
MISSING_HBASE_TABLE
,

81 "GRAPHBUILDER ERROR: " + 
¤cTabËName
 + "abË dÛ nÙƒxi¡", 
LOG
);

83 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

84 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

85 "GRAPHBUILDER ERROR: IOƒxû±iÚ wh’‡‰em±šgØ»ad HBa£abË " + 
¤cTabËName
, 
LOG
, 
e
);

93 
public
 
boŞ—n
 
	$u£sHBa£
() {

94  
Œue
;

95 
	}
}

102 
public
 
	$upd©eCÚfigu¿tiÚFÜM­³r
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
CommªdLše
 
cmd
) {

104 
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

106 
cÚfigu¿tiÚ
.
	`£t
("SRCTABLENAME", 
¤cTabËName
);

109 
sÿn
.
	`£tCachšg
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”tyIÁ
("HBASE_CACHE_SIZE"));

110 
sÿn
.
	`£tCacheBlocks
(
çl£
);

112 
cÚfigu¿tiÚ
.
	`£tBoŞ—n
("HBASE_TOKENIZER_FLATTEN_LISTS", 
cmd
.
	`hasO±iÚ
("flattenlists"));

113 
	}
}

120 
public
 
	$upd©eJobFÜM­³r
(
Job
 
job
, 
CommªdLše
 
cmd
) {

121 
Œy
 {

122 
TabËM­ReduûUt
.
	`š™TabËM­³rJob
(
¤cTabËName
, 
sÿn
, 
HBa£R—d”M­³r
.
şass
, 
Text
.şass, 
Prİ”tyG¿phEËm’t
.şass, 
job
);

123 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

124 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
HADOOP_REPORTED_ERROR
,

125 "Could‚Ù in™ŸlizbË m­³¸job", 
LOG
, 
e
);

127 
	}
}

134 
public
 
CÏss
 
	$g‘M­³rCÏss
() {

135  
m­³rCÏss
;

136 
	}
}

142 
public
 
SŒšg
 
	$g‘DesütiÚ
() {

143  "Hba£abË‚ame: " + 
¤cTabËName
;

144 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseReaderMapper.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gBa£M­³r
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gRecÜdTy³HBa£Row
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gio
.
	gImmubËBy‹sWr™abË
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gm­»duû
.
	gTabËM­³r
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

38 
public
 
şass
 
HBa£R—d”M­³r
 
ex‹nds
 
	gTabËM­³r
<
	gIÁWr™abË
, 
	gPrİ”tyG¿phEËm’t
> {

39 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
HBa£R—d”M­³r
.
şass
);

41 
´iv©e
 
Ba£M­³r
 
	gba£M­³r
;

51 @
Ov”ride


52 
´Ùeùed
 
£tup
(
CÚ‹xt
 
cÚ‹xt
) {

54 
CÚfigu¿tiÚ
 
	gcÚf
 = 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
();

58 
£tBa£M­³r
(
Ãw
 
Ba£M­³r
(
cÚ‹xt
, 
cÚf
, 
LOG
));

70 @
Ov”ride


71 
public
 
m­
(
ImmubËBy‹sWr™abË
 
row
, 
ResuÉ
 
cŞumns
, 
CÚ‹xt
 
cÚ‹xt
) {

73 
	gcÚ‹xt
.
g‘CouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_ROWS_READ
).
šüem’t
(1);

75 
RecÜdTy³HBa£Row
 
	g»cÜd
 = 
g‘RecÜdTy³HBa£Row
(
row
, 
cŞumns
);

77 
	gba£M­³r
.
g‘Tok’iz”
().
·r£
(
»cÜd
, 
cÚ‹xt
);

81 
	gba£M­³r
.
wr™eEdges
(
cÚ‹xt
);

83 
	gba£M­³r
.
wr™eV”tiûs
(
cÚ‹xt
);

86 
public
 
£tBa£M­³r
(
Ba£M­³r
 
ba£M­³r
) {

87 
	gthis
.
	gba£M­³r
 = 
ba£M­³r
;

90 
´iv©e
 
RecÜdTy³HBa£Row
 
g‘RecÜdTy³HBa£Row
(
ImmubËBy‹sWr™abË
 
row
, 
ResuÉ
 
cŞumns
) {

91  
Ãw
 
RecÜdTy³HBa£Row
(
row
, 
cŞumns
);

	@src/com/intel/hadoop/graphbuilder/pipeline/input/text/TextFileInputConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gP©h
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gJob
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gFeIÅutFÜm©
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gTextIÅutFÜm©
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

33 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

45 
public
 cÏs 
	cTextFeIÅutCÚfigu¿tiÚ
 
im¶em’ts
 
	mIÅutCÚfigu¿tiÚ
 {

47 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
TextFeIÅutCÚfigu¿tiÚ
.
şass
);

49 
´iv©e
 
TextIÅutFÜm©
 
	mšputFÜm©
;

50 
´iv©e
 
CÏss
 
	mM­³rCÏss
 = 
TextP¬sšgM­³r
.
şass
;

53 
´iv©e
 
	$TextFeIÅutCÚfigu¿tiÚ
() {

56 
public
 
	$TextFeIÅutCÚfigu¿tiÚ
(
TextIÅutFÜm©
 
šputFÜm©
) {

57 
this
.
šputFÜm©
 = inputFormat;

58 
	}
}

60 
public
 
boŞ—n
 
	$u£sHBa£
() {

61  
çl£
;

62 
	}
}

64 
public
 
	$upd©eCÚfigu¿tiÚFÜM­³r
 (
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
CommªdLše
 
cmd
) {

65 
	}
}

67 
public
 
	$upd©eJobFÜM­³r
(
Job
 
job
, 
CommªdLše
 
cmd
) {

68 
job
.
	`£tM­³rCÏss
(
M­³rCÏss
);

69 
job
.
	`£tIÅutFÜm©CÏss
(
šputFÜm©
.
	`g‘CÏss
());

71 
SŒšg
 
šputP©h
 = 
cmd
.
	`g‘O±iÚV®ue
("in");

73 
Œy
 {

74 
FeIÅutFÜm©
.
	`addIÅutP©h
(
job
, 
Ãw
 
	`P©h
(
šputP©h
));

75 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

76 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_LOAD_INPUT_FILE
,

77 "UÇbËØ£ˆšpuˆ·th " + 
šputP©h
, 
LOG
, 
e
);

79 
	}
}

81 
public
 
CÏss
 
	$g‘M­³rCÏss
(){

82  
M­³rCÏss
;

83 
	}
}

85 
public
 
	$£tM­³rCÏss
(
CÏss
 
M­³rCÏss
) {

86 
this
.
M­³rCÏss
 = MapperClass;

87 
	}
}

89 
public
 
SŒšg
 
	$g‘DesütiÚ
() {

90  "FšpuˆfÜm©: " + 
šputFÜm©
.
	`toSŒšg
();

91 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/input/text/TextParsingMapper.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gBa£M­³r
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gKeyFunùiÚ
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gLÚgWr™abË
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

43 
public
 
şass
 
TextP¬sšgM­³r
 
ex‹nds
 
	gM­³r
<
	gLÚgWr™abË
, 
	gText
, 
	gIÁWr™abË
, 
	gPrİ”tyG¿phEËm’t
> {

45 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
TextP¬sšgM­³r
.
şass
);

47 
´iv©e
 
Ba£M­³r
 
	gba£M­³r
;

49 
public
 
£tBa£M­³r
(
Ba£M­³r
 
ba£M­³r
) {

50 
	gthis
.
	gba£M­³r
 = 
ba£M­³r
;

53 @
Ov”ride


54 
public
 
£tup
(
CÚ‹xt
 
cÚ‹xt
) {

56 
CÚfigu¿tiÚ
 
	gcÚf
 = 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
();

58 
£tBa£M­³r
(
Ãw
 
Ba£M­³r
(
cÚ‹xt
, 
cÚf
, 
LOG
));

62 @
Ov”ride


63 
public
 
m­
(
LÚgWr™abË
 
key
, 
Text
 
v®ue
, 
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
 {

64 
	gba£M­³r
.
g‘Tok’iz”
().
·r£
(
v®ue
.
toSŒšg
(), 
cÚ‹xt
);

66 
	gba£M­³r
.
wr™eEdges
(
cÚ‹xt
);

68 
	gba£M­³r
.
wr™eV”tiûs
(
cÚ‹xt
);

	@src/com/intel/hadoop/graphbuilder/pipeline/input/text/textinputformats/WikiPageInputFormat.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
.
	g‹xtšputfÜm©s
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gLÚgWr™abË
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gIÅutS¶™
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gRecÜdR—d”
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gTaskA‰em±CÚ‹xt
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gTextIÅutFÜm©
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

33 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

35 
public
 cÏs 
	cWikiPageIÅutFÜm©
 
ex‹nds
 
	mTextIÅutFÜm©
 {

37 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
WikiPageIÅutFÜm©
.
şass
);

39 
public
 
fš®
 
SŒšg
 
	mSTART_TAG
 = "<page>";

40 
public
 
fš®
 
SŒšg
 
	mEND_TAG
 = "</page>";

42 @
Ov”ride


43 
public
 
	mRecÜdR—d”
<
	mLÚgWr™abË
, 
	mText
> 
	$ü—‹RecÜdR—d”
(
IÅutS¶™
 
¥l™
, 
TaskA‰em±CÚ‹xt
 
cÚ‹xt
) {

45 
CÚfigu¿tiÚ
 
cÚf
 = 
cÚ‹xt
.
	`g‘CÚfigu¿tiÚ
();

46 
cÚf
.
	`£t
(
XMLIÅutFÜm©
.
START_TAG_KEY
, 
START_TAG
);

47 
cÚf
.
	`£t
(
XMLIÅutFÜm©
.
END_TAG_KEY
, 
END_TAG
);

49 
XMLIÅutFÜm©
.
XMLRecÜdR—d”
 
xmlRecÜdR—d”
 = 
nuÎ
;

51 
Œy
 {

52 
xmlRecÜdR—d”
 = 
Ãw
 
XMLIÅutFÜm©
.
	`XMLRecÜdR—d”
(
cÚ‹xt
);

53 
xmlRecÜdR—d”
.
	`š™Ÿlize
(
¥l™
, 
cÚ‹xt
);

54 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

55 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

56 "UÇbËØš™ŸlizxmÈ»cÜd„—d”.", 
LOG
, 
e
);

59  
xmlRecÜdR—d”
;

61 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/input/text/textinputformats/XMLInputFormat.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
.
	g‹xtšputfÜm©s
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gFSD©aIÅutSŒ—m
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gFeSy¡em
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gP©h
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gS“kabË
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gD©aOuutBufãr
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gLÚgWr™abË
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gcom´ess
.
	gCom´essiÚCodec
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gcom´ess
.
	gCom´essiÚCodecFaùÜy
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gIÅutS¶™
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gRecÜdR—d”
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gTaskA‰em±CÚ‹xt
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gFeS¶™
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gTextIÅutFÜm©
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

41 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅutSŒ—m
;

42 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

53 
public
 cÏs 
	cXMLIÅutFÜm©
 
ex‹nds
 
	mTextIÅutFÜm©
 {

55 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
XMLIÅutFÜm©
.
şass
);

61 
public
 
fš®
 
SŒšg
 
	mSTART_TAG_KEY
 = "xmlinput.start";

67 
public
 
fš®
 
SŒšg
 
	mEND_TAG_KEY
 = "xmlinput.end";

69 @
Ov”ride


70 
public
 
	mRecÜdR—d”
<
	mLÚgWr™abË
, 
	mText
> 
	$ü—‹RecÜdR—d”
(
IÅutS¶™
 
šputS¶™
, 
TaskA‰em±CÚ‹xt
 
cÚ‹xt
) {

72 
XMLRecÜdR—d”
 
xmlRecÜdR—d”
 = 
nuÎ
;

74 
Œy
 {

75 
xmlRecÜdR—d”
 = 
Ãw
 
	`XMLRecÜdR—d”
(
cÚ‹xt
);

76 
xmlRecÜdR—d”
.
	`š™Ÿlize
(
šputS¶™
, 
cÚ‹xt
);

78 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

79 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

80 "UÇbËØü—‹ xmÈ»cÜd„—d”.", 
LOG
, 
e
);

83  
xmlRecÜdR—d”
;

92 
public
 
şass
 
XMLRecÜdR—d”
 
ex‹nds
 
RecÜdR—d”
<
LÚgWr™abË
, 
Text
> {

94 
´iv©e
 
fš®
 
Logg”
 
LOG
 = Logg”.
	`g‘Logg”
(
XMLRecÜdR—d”
.
şass
);

96 
´iv©e
 
CÚfigu¿tiÚ
 
cÚf
;

98 
´iv©e
 
by‹
[] 
¡¬tTag
;

99 
´iv©e
 
by‹
[] 
’dTag
;

100 
´iv©e
 
¡¬t
;

101 
´iv©e
 
’d
;

102 
´iv©e
 
pos
;

103 
´iv©e
 
»cÜdS¹Pos
;

105 
´iv©e
 
Text
 
v®ue
 = 
Ãw
 
	`Text
();

106 
´iv©e
 
LÚgWr™abË
 
key
 = 
Ãw
 
	`LÚgWr™abË
();

108 
´iv©e
 
D©aIÅutSŒ—m
 
fsIn
 = 
nuÎ
;

109 
´iv©e
 
D©aOuutBufãr
 
bufãr
 = 
Ãw
 
	`D©aOuutBufãr
();

110 
´iv©e
 
FeS¶™
 
feS¶™
;

112 
´iv©e
 
fš®
 
SŒšg
 
TEXT_ENCODING
 = "utf-8";

114 
public
 
	`XMLRecÜdR—d”
(
TaskA‰em±CÚ‹xt
 
cÚ‹xt
è
throws
 
IOExû±iÚ
 {

116 
this
.
cÚf
 = 
cÚ‹xt
.
	`g‘CÚfigu¿tiÚ
();

118 ià(
this
.
cÚf
.
	`g‘
(
START_TAG_KEY
è=ğ
nuÎ
 ||his.cÚf.g‘(
END_TAG_KEY
) ==‚ull) {

119 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Error! XML start‡ndƒndags unspecified!");

122 
¡¬tTag
 = 
this
.
cÚf
.
	`g‘
(
START_TAG_KEY
).
	`g‘By‹s
(
TEXT_ENCODING
);

123 
’dTag
 = 
this
.
cÚf
.
	`g‘
(
END_TAG_KEY
).
	`g‘By‹s
(
TEXT_ENCODING
);

126 
public
 
	`š™Ÿlize
(
IÅutS¶™
 
¥l™
, 
TaskA‰em±CÚ‹xt
 
cÚ‹xt
è
throws
 
IOExû±iÚ
 {

128 
this
.
cÚf
 = 
cÚ‹xt
.
	`g‘CÚfigu¿tiÚ
();

130 
this
.
feS¶™
 = (
FeS¶™
è
¥l™
;

131 
P©h
 
fe
 = 
feS¶™
.
	`g‘P©h
();

132 
¡¬t
 = 
feS¶™
.
	`g‘S¹
();

134 
Com´essiÚCodecFaùÜy
 
com´essiÚCodecs
 = 
Ãw
 
	`Com´essiÚCodecFaùÜy
(
this
.
cÚf
);

135 
Com´essiÚCodec
 
codec
 = 
com´essiÚCodecs
.
	`g‘Codec
(
fe
);

137 
FeSy¡em
 
fs
 = 
fe
.
	`g‘FeSy¡em
(
this
.
cÚf
);

139 ià(
codec
 !ğ
nuÎ
) {

140 
LOG
.
	`šfo
("Reading compressed file...");

142 
fsIn
 = 
Ãw
 
	`D©aIÅutSŒ—m
(
codec
.
	`ü—‹IÅutSŒ—m
(
fs
.
	`İ’
(
fe
)));

144 
’d
 = 
LÚg
.
MAX_VALUE
;

146 
LOG
.
	`šfo
("Reading uncompressed file...");

148 
FSD©aIÅutSŒ—m
 
feIn
 = 
fs
.
	`İ’
(
fe
);

150 
feIn
.
	`£ek
(
¡¬t
);

151 
fsIn
 = 
feIn
;

153 
’d
 = 
¡¬t
 + 
feS¶™
.
	`g‘L’gth
();

156 
»cÜdS¹Pos
 = 
¡¬t
;

161 
pos
 = 
¡¬t
;

164 @
Ov”ride


165 
public
 
boŞ—n
 
	`ÃxtKeyV®ue
(è
throws
 
IOExû±iÚ
 {

167 ià(
pos
 < 
’d
) {

169 
key
.
	`£t
(
pos
);

171 ià(
	`»adUÁM©ch
(
¡¬tTag
, 
çl£
)) {

173 
»cÜdS¹Pos
 = 
pos
 - 
¡¬tTag
.
Ëngth
;

175 
Œy
 {

176 
bufãr
.
	`wr™e
(
¡¬tTag
);

177 ià(
	`»adUÁM©ch
(
’dTag
, 
Œue
)) {

178 
key
.
	`£t
(
»cÜdS¹Pos
);

179 
v®ue
.
	`£t
(
bufãr
.
	`g‘D©a
(), 0, bufãr.
	`g‘L’gth
());

180  
Œue
;

182 } 
fš®ly
 {

194 ià(
fsIn
 
š¡ªûof
 
S“kabË
) {

196 ià(
pos
 !ğ((
S“kabË
è
fsIn
).
	`g‘Pos
()) {

198 
LOG
.
	`šfo
("by‹ cÚusmedƒ¼Ü: " + 
SŒšg
.
	`v®ueOf
(
pos
)

199 + " !ğ" + 
SŒšg
.
	`v®ueOf
(((
S“kabË
è
fsIn
).
	`g‘Pos
()));

203 
bufãr
.
	`»£t
();

207  
çl£
;

210 @
Ov”ride


211 
public
 
Text
 
	`g‘Cu¼’tV®ue
() {

212  
this
.
v®ue
;

215 @
Ov”ride


216 
public
 
LÚgWr™abË
 
	`g‘Cu¼’tKey
() {

217  
this
.
key
;

220 @
Ov”ride


221 
public
 
	`şo£
(è
throws
 
IOExû±iÚ
 {

222 
fsIn
.
	`şo£
();

225 @
Ov”ride


226 
public
 
	`g‘Prog»ss
(è
throws
 
IOExû±iÚ
 {

227  ((è(
pos
 - 
¡¬t
)è/ ((è(
’d
 - start));

230 
public
 
	`g‘S¹
() {

231  
¡¬t
;

234 
public
 
	`g‘End
() {

235  
’d
;

238 
´iv©e
 
boŞ—n
 
	`»adUÁM©ch
(
by‹
[] 
m©ch
, boŞ—À
w™hšBlock
)

239 
throws
 
IOExû±iÚ
 {

241 
pos™iÚ
 = 0;

243 
Œue
) {

244 
šputIÁeg”
 = 
fsIn
.
	`»ad
();

246 
pos
++;

249 ià(
šputIÁeg”
 == -1) {

250  
çl£
;

254 ià(
w™hšBlock
) {

255 
bufãr
.
	`wr™e
(
šputIÁeg”
);

259 ià(
šputIÁeg”
 =ğ
m©ch
[
pos™iÚ
]) {

261 
pos™iÚ
++;

263 ià(
pos™iÚ
 >ğ
m©ch
.
Ëngth
) {

264  
Œue
;

267 
pos™iÚ
 = 0;

271 ià(!
w™hšBlock
 && 
pos™iÚ
 =ğ0 && 
pos
 >ğ
’d
) {

272  
çl£
;

276 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/GraphGenerationMRJob.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

26 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

27 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
public
 
ab¡¿ù
 cÏs 
	cG¿phG’”©iÚMRJob
 {

36 
public
 
ab¡¿ù
 
£tV®ueCÏss
(
CÏss
 
v®ueCÏss
);

37 
public
 
ab¡¿ù
 
£tVidCÏss
(
CÏss
 
vidCÏss
);

38 
public
 
ab¡¿ù
 
£tCËªBidœeùiÚ®Edges
(
boŞ—n
 
ş—n
);

39 
public
 
ab¡¿ù
 
£tU£rO±iÚs
(
HashM­
<
SŒšg
, SŒšg> 
u£rO±s
);

40 
public
 
ab¡¿ù
 
š™
(
IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
, 
G¿phBudšgRuË
 
g¿phBudšgRuË
);

41 
public
 
ab¡¿ù
 
	$run
(
CommªdLše
 
cmd
è
throws
 
IOExû±iÚ
, 
CÏssNÙFoundExû±iÚ
, 
IÁ”ru±edExû±iÚ
;

	@src/com/intel/hadoop/graphbuilder/pipeline/output/OutputConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
;

22 
public
 
š‹rçû
 
	gOuutCÚfigu¿tiÚ


24 
public
 
G¿phG’”©iÚMRJob
 
g‘G¿phG’”©iÚMRJob
();

	@src/com/intel/hadoop/graphbuilder/pipeline/output/rdfgraph/RDFGraphMR.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	grdfg¿ph
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gEËm’tIdKeyFunùiÚ
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

32 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gHBa£Uts
;

33 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gP©h
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gNuÎWr™abË
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gJob
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gFeOuutFÜm©
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gLazyOuutFÜm©
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gTextOuutFÜm©
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

46 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gFunùiÚ®
;

78 
public
 cÏs 
	cRDFG¿phMR
 
ex‹nds
 
	mG¿phG’”©iÚMRJob
 {

80 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
RDFG¿phMR
.
şass
);

82 
´iv©e
 
CÚfigu¿tiÚ
 
	mcÚf
;

84 
´iv©e
 
HBa£Uts
 
	mhba£Uts
 = 
nuÎ
;

85 
´iv©e
 
boŞ—n
 
	musšgHBa£
 = 
çl£
;

87 
´iv©e
 
G¿phBudšgRuË
 
	mg¿phBudšgRuË
;

88 
´iv©e
 
IÅutCÚfigu¿tiÚ
 
	mšputCÚfigu¿tiÚ
;

90 
´iv©e
 
Prİ”tyG¿phEËm’t
 
	mm­V®ueTy³
;

91 
´iv©e
 
CÏss
 
	mvidCÏss
;

93 
´iv©e
 
fš®
 
CÏss
 
	mkeyFuncCÏss
 = 
EËm’tIdKeyFunùiÚ
.
şass
;

95 
´iv©e
 
FunùiÚ®
 
	mv”‹xReduûrFunùiÚ
;

96 
´iv©e
 
FunùiÚ®
 
	medgeReduûrFunùiÚ
;

97 
´iv©e
 
boŞ—n
 
	mş—nBidœeùiÚ®Edge
;

111 @
Ov”ride


112 
public
 
	$š™
(
IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
, 
G¿phBudšgRuË
 
g¿phBudšgRuË
) {

114 
this
.
g¿phBudšgRuË
 = graphBuildingRule;

115 
this
.
šputCÚfigu¿tiÚ
 = inputConfiguration;

116 
this
.
usšgHBa£
 = 
šputCÚfigu¿tiÚ
.
	`u£sHBa£
();

118 ià(
usšgHBa£
) {

119 
Œy
 {

120 
this
.
hba£Uts
 = 
HBa£Uts
.
	`g‘In¡ªû
();

121 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

122 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_CONNECT_TO_HBASE
,

123 "CªnÙ‡Îoÿ‹hHBa£Ut objeù. Check hba£ cÚÃùiÚ.", 
LOG
, 
e
);

125 
this
.
cÚf
 = 
hba£Uts
.
	`g‘CÚfigu¿tiÚ
();

127 
this
.
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

140 
public
 
	$£tFunùiÚCÏss
(
CÏss
 
v”‹xReduûrFunùiÚ
, CÏs 
edgeReduûrFunùiÚ
) {

141 
Œy
 {

142 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

143 
this
.
v”‹xReduûrFunùiÚ
 = (
FunùiÚ®
èv”‹xReduûrFunùiÚ.
	`ÃwIn¡ªû
();

146 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

147 
this
.
edgeReduûrFunùiÚ
 = (
FunùiÚ®
èedgeReduûrFunùiÚ.
	`ÃwIn¡ªû
();

149 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

150 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

151 "CªnÙ in¡ªtŸ‹„eduû¸funùiÚs.", 
LOG
, 
e
);

152 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

153 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

154 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs.", 
LOG
, 
e
);

156 
	}
}

164 @
Ov”ride


165 
public
 
	$£tCËªBidœeùiÚ®Edges
(
boŞ—n
 
ş—n
) {

166 
ş—nBidœeùiÚ®Edge
 = 
ş—n
;

167 
	}
}

180 @
Ov”ride


181 
public
 
	$£tV®ueCÏss
(
CÏss
 
v®ueCÏss
) {

182 
Œy
 {

183 
this
.
m­V®ueTy³
 = (
Prİ”tyG¿phEËm’t
è
v®ueCÏss
.
	`ÃwIn¡ªû
();

184 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

185 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

186 "CªnÙ s‘ v®uşas Ğ" + 
v®ueCÏss
.
	`g‘Name
(è+ ")", 
LOG
, 
e
);

187 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

188 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

189 "IÎeg®‡cûs exû±iÚ wh’ s‘tšg v®uşas Ğ" + 
v®ueCÏss
.
	`g‘Name
(è+ ")", 
LOG
, 
e
);

191 
	}
}

203 @
Ov”ride


204 
public
 
	$£tVidCÏss
(
CÏss
 
vidCÏss
) {

205 
this
.
vidCÏss
 = vidClass;

206 
	}
}

213 
public
 
CÚfigu¿tiÚ
 
	$g‘CÚf
() {

214  
this
.
cÚf
;

215 
	}
}

222 @
Ov”ride


223 
public
 
£tU£rO±iÚs
(
HashM­
<
SŒšg
, SŒšg> 
u£rO±s
) {

224 
	gS‘
<
	gSŒšg
> 
	gkeys
 = 
u£rO±s
.
keyS‘
();

225 
SŒšg
 
	gkey
 : 
keys
)

226 
cÚf
.
£t
(
key
, 
u£rO±s
.
g‘
(key.
toSŒšg
()));

238 
public
 
	$run
(
CommªdLše
 
cmd
è
throws
 
IOExû±iÚ
, 
CÏssNÙFoundExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

240 
SŒšg
 
ouutP©h
 = 
cmd
.
	`g‘O±iÚV®ue
("out");

244 
SŒšg
 
‹¡
 = 
g¿phBudšgRuË
.
	`g‘CÏss
().
	`g‘Name
();

246 
cÚf
.
	`£t
("G¿phTok’iz”", 
g¿phBudšgRuË
.
	`g‘G¿phTok’iz”CÏss
().
	`g‘Name
());

247 
cÚf
.
	`£tBoŞ—n
("noBiDœ", 
ş—nBidœeùiÚ®Edge
);

248 
cÚf
.
	`£t
("vidCÏss", 
vidCÏss
.
	`g‘Name
());

249 
cÚf
.
	`£t
("KeyFunùiÚ", 
keyFuncCÏss
.
	`g‘Name
());

253 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

254 
cÚf
.
	`£t
("v”‹xReduûrFunùiÚ", 
v”‹xReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

256 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

257 
cÚf
.
	`£t
("edgeReduûrFunùiÚ", 
edgeReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

262 
šputCÚfigu¿tiÚ
.
	`upd©eCÚfigu¿tiÚFÜM­³r
(
cÚf
, 
cmd
);

266 
g¿phBudšgRuË
.
	`upd©eCÚfigu¿tiÚFÜTok’iz”
(
cÚf
, 
cmd
);

270 
Job
 
job
 = 
Ãw
 
	`Job
(
cÚf
, "RDFGraphMR");

271 
job
.
	`£tJ¬ByCÏss
(
RDFG¿phMR
.
şass
);

275 
šputCÚfigu¿tiÚ
.
	`upd©eJobFÜM­³r
(
job
, 
cmd
);

277 
job
.
	`£tM­OuutKeyCÏss
(
IÁWr™abË
.
şass
);

278 
job
.
	`£tM­OuutV®ueCÏss
(
m­V®ueTy³
.
	`g‘CÏss
());

282 
job
.
	`£tReduûrCÏss
(
RDFG¿phReduûr
.
şass
);

284 
job
.
	`£tOuutKeyCÏss
(
NuÎWr™abË
.
şass
);

285 
job
.
	`£tOuutV®ueCÏss
(
Text
.
şass
);

290 
job
.
	`£tOuutFÜm©CÏss
(
TextOuutFÜm©
.
şass
);

292 
LazyOuutFÜm©
.
	`£tOuutFÜm©CÏss
(
job
, 
TextOuutFÜm©
.
şass
);

294 
FeOuutFÜm©
.
	`£tOuutP©h
(
job
, 
Ãw
 
	`P©h
(
ouutP©h
));

298 
LOG
.
	`šfo
("=========== Job: Creating vertex†ist‡ndƒdge†ist from input data, saving‡sext file ===========");

300 
LOG
.
	`šfo
("šput: " + 
šputCÚfigu¿tiÚ
.
	`g‘DesütiÚ
());

301 
LOG
.
	`šfo
("Ouuˆğ" + 
ouutP©h
);

303 
LOG
.
	`šfo
("IÅutFÜm© = " + 
šputCÚfigu¿tiÚ
.
	`g‘DesütiÚ
());

304 
LOG
.
	`šfo
("G¿phTok’iz”FromSŒšg = " + 
g¿phBudšgRuË
.
	`g‘CÏss
().
	`g‘Name
());

306 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

307 
LOG
.
	`šfo
("v”‹xReduûrFunùiÚ = " + 
v”‹xReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

310 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

311 
LOG
.
	`šfo
("edgeReduûrFunùiÚ = " + 
edgeReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

314 
LOG
.
	`šfo
("==================== Start ====================================");

315 
job
.
	`wa™FÜCom¶‘iÚ
(
Œue
);

316 
LOG
.
	`šfo
("=================== Done ====================================\n");

317 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/rdfgraph/RDFGraphOutputConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	grdfg¿ph
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gOuutCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

25 
public
 cÏs 
	cRDFG¿phOuutCÚfigu¿tiÚ
 
im¶em’ts
 
	mOuutCÚfigu¿tiÚ
 {

26 
´iv©e
 
G¿phG’”©iÚMRJob
 
	mg¿phG’”©iÚMRJob
;

29 
public
 
	$RDFG¿phOuutCÚfigu¿tiÚ
() {

30 
g¿phG’”©iÚMRJob
 = 
Ãw
 
	`RDFG¿phMR
();

33 
public
 
G¿phG’”©iÚMRJob
 
	$g‘G¿phG’”©iÚMRJob
() {

34  
g¿phG’”©iÚMRJob
;

35 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/rdfgraph/RDFGraphReducer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	grdfg¿ph
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

27 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

30 
impÜt
 
	gcom
.
	ghp
.
	gh¶
.
	gj’a
.
	gÚtŞogy
.
	gOÁCÏss
;

31 
impÜt
 
	gcom
.
	ghp
.
	gh¶
.
	gj’a
.
	gÚtŞogy
.
	gOÁMod–
;

32 
impÜt
 
	gcom
.
	ghp
.
	gh¶
.
	gj’a
.
	gÚtŞogy
.
	gOÁPrİ”ty
;

33 
impÜt
 
	gcom
.
	ghp
.
	gh¶
.
	gj’a
.
	grdf
.
	gmod–
.*;

34 
impÜt
 
	gcom
.
	ghp
.
	gh¶
.
	gj’a
.
	gvoÿbuÏry
.*;

35 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdgeID
;

36 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

37 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

38 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

39 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

40 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

41 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gNuÎWr™abË
;

45 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

46 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

47 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gReduûr
;

49 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gFunùiÚ®
;

50 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gMuÉËOuuts
;

51 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

53 
impÜt
 
	gÜg
.
	g­ache
.
	gj’a
.
	griÙ
.
	gRDFD©aMgr
;

54 
impÜt
 
	gÜg
.
	gİ’rdf
.
	grio
.
	gRDFFÜm©
;

71 
public
 
şass
 
RDFG¿phReduûr
 
ex‹nds
 
	gReduûr
<
	gIÁWr™abË
, 
	gPrİ”tyG¿phEËm’t
, 
	gNuÎWr™abË
, 
	gText
> {

73 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
RDFG¿phReduûr
.
şass
);

75 
´iv©e
 
	gMuÉËOuuts
<
	gNuÎWr™abË
, 
	gText
> 
	gmuÉËOuuts
;

77 
´iv©e
 
boŞ—n
 
	gnoBiDœ
;

78 
´iv©e
 
FunùiÚ®
 
	gedgeReduûrFunùiÚ
;

79 
´iv©e
 
FunùiÚ®
 
	gv”‹xReduûrFunùiÚ
;

80 
´iv©e
 
SŒšg
 
	grdfName¥aû
;

82 
´iv©e
 
	eCouÁ”s
 {

83 
	gNUM_VERTICES
,

84 
	gNUM_EDGES


87 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, SŒšg> 
	gRDFName¥aûM­
;

89 
	gRDFName¥aûM­
 = 
Ãw
 
HashM­
<
SŒšg
, 
	gSŒšg
>();

90 
	gRDFName¥aûM­
.
put
("OWL", 
OWL
.
NS
);

91 
	gRDFName¥aûM­
.
put
("DC", 
DC
.
NS
);

92 
	gRDFName¥aûM­
.
put
("LOCMAP", 
LoÿtiÚM­pšgVoÿb
.
NS
);

93 
	gRDFName¥aûM­
.
put
("ONTDOC", 
OÁDocMªag”Voÿb
.
NS
);

94 
	gRDFName¥aûM­
.
put
("ONTEVENTS", 
OÁDocMªag”Voÿb
.
NS
);

95 
	gRDFName¥aûM­
.
put
("OWL2", 
OWL2
.
NS
);

96 
	gRDFName¥aûM­
.
put
("RDFS", 
RDFS
.
g‘URI
());

102 @
Ov”ride


103 
public
 
£tup
(
CÚ‹xt
 
cÚ‹xt
) {

105 
CÚfigu¿tiÚ
 
	gcÚf
 = 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
();

107 
	gthis
.
	gnoBiDœ
 = 
cÚf
.
g‘BoŞ—n
("noBiDœ", 
çl£
);

109 
	gthis
.
	gmuÉËOuuts
 = 
Ãw
 
MuÉËOuuts
<
NuÎWr™abË
, 
	gText
>(
	gcÚ‹xt
);

111 
	gŒy
 {

112 ià(
	gcÚf
.
g‘
("edgeReduûrFunùiÚ"è!ğ
nuÎ
) {

113 
this
.
edgeReduûrFunùiÚ
 =

114 (
FunùiÚ®
è
CÏss
.
fÜName
(
cÚf
.
g‘
("edgeReduûrFunùiÚ")).
ÃwIn¡ªû
();

116 
	gthis
.
	gedgeReduûrFunùiÚ
.
cÚfigu»
(
cÚf
);

119 ià(
	gcÚf
.
g‘
("v”‹xReduûrFunùiÚ"è!ğ
nuÎ
) {

120 
this
.
v”‹xReduûrFunùiÚ
 =

121 (
FunùiÚ®
è
CÏss
.
fÜName
(
cÚf
.
g‘
("v”‹xReduûrFunùiÚ")).
ÃwIn¡ªû
();

123 
	gthis
.
	gv”‹xReduûrFunùiÚ
.
cÚfigu»
(
cÚf
);

126 ià(
	gcÚf
.
g‘
("rdfName¥aû"è!ğ
nuÎ
) {

127 
this
.
rdfName¥aû
 = 
cÚf
.
g‘
("rdfNamespace");

130 } 
ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

131 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

132 "Could‚Ù in¡ªtŸ‹„eduû¸funùiÚs", 
LOG
, 
e
);

133 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

134 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

135 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs", 
LOG
, 
e
);

136 } 
ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

137 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

138 "CÏs nÙ foundƒxû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs", 
LOG
, 
e
);

139 } 
ÿtch
 (
FunùiÚ®
.
FunùiÚ®CÚfigu¿tiÚE¼Ü
 
e
) {

140 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

141 "CÚfigu¿tiÚƒ¼Ü wh’ cÚfiguršg„eduû¸funùiÚ®s.", 
LOG
, 
e
);

145 @
Ov”ride


146 
public
 
»duû
(
IÁWr™abË
 
key
, 
I‹¿bË
<
Prİ”tyG¿phEËm’t
> 
v®ues
, 
CÚ‹xt
 
cÚ‹xt
)

147 
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

149 
	gHashM­
<
	gEdgeID
, 
	gWr™abË
> 
	gedgePrİ”t›sM­
 = 
Ãw
 
HashM­
();

150 
	gHashM­
<
	gObjeù
, 
	gWr™abË
> 
	gv”‹xPrİ”t›sM­
 = 
Ãw
 
HashM­
();

151 
	gI‹¿tÜ
<
	gPrİ”tyG¿phEËm’t
> 
	gv®ueI‹¿tÜ
 = 
v®ues
.
™”©Ü
();

153 
	gv®ueI‹¿tÜ
.
hasNext
()) {

155 
Prİ”tyG¿phEËm’t
 
	gÃxt
 = 
v®ueI‹¿tÜ
.
Ãxt
();

159 ià(
	gÃxt
.
g¿phEËm’tTy³
(è=ğ
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
) {

161 
Objeù
 
v”‹xId
 = 
Ãxt
.
v”‹x
().
g‘V”‹xId
();

162 
V”‹x
 
	gv”‹x
 = 
Ãxt
.
v”‹x
();

164 ià(
	gv”‹xPrİ”t›sM­
.
cÚšsKey
(
v”‹xId
)) {

168 ià(
	gv”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

169 
v”‹xPrİ”t›sM­
.
put
(
v”‹xId
,

170 
v”‹xReduûrFunùiÚ
.
»duû
(
v”‹x
.
g‘Prİ”t›s
(),

171 
v”‹xPrİ”t›sM­
.
g‘
(
v”‹xId
)));

179 
Prİ”tyM­
 
	gexi¡šgPrİ”tyM­
 = (Prİ”tyM­è
v”‹xPrİ”t›sM­
.
g‘
(
v”‹xId
);

180 
	gexi¡šgPrİ”tyM­
.
m”gePrİ”t›s
(
v”‹x
.
g‘Prİ”t›s
());

186 ià(
	gv”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

187 
v”‹xPrİ”t›sM­
.
put
(
v”‹xId
,

188 
v”‹xReduûrFunùiÚ
.
»duû
(
v”‹x
.
g‘Prİ”t›s
(),

189 
v”‹xReduûrFunùiÚ
.
id’t™yV®ue
()));

191 
	gv”‹xPrİ”t›sM­
.
put
(
v”‹xId
, 
v”‹x
.
g‘Prİ”t›s
());

199 
	gEdge
<?> 
	gedge
 = 
Ãxt
.
edge
();

200 
EdgeID
 
	gedgeID
 = 
Ãw
 EdgeID(
edge
.
g‘Src
(),ƒdge.
g‘D¡
(),ƒdge.
g‘EdgeLab–
());

202 ià(
	gedge
.
isS–fEdge
()) {

207 ià(
	gedgePrİ”t›sM­
.
cÚšsKey
(
edgeID
)) {

213 ià(
	gedgeReduûrFunùiÚ
 !ğ
nuÎ
) {

214 
edgePrİ”t›sM­
.
put
(
edgeID
,

215 
edgeReduûrFunùiÚ
.
»duû
(
edge
.
g‘Prİ”t›s
(),

216 
edgePrİ”t›sM­
.
g‘
(
edgeID
)));

223 
Prİ”tyM­
 
	gexi¡šgPrİ”tyM­
 = (Prİ”tyM­è
edgePrİ”t›sM­
.
g‘
(
edgeID
);

224 
	gexi¡šgPrİ”tyM­
.
m”gePrİ”t›s
(
edge
.
g‘Prİ”t›s
());

231 ià(
	gnoBiDœ
 && 
	gedgePrİ”t›sM­
.
cÚšsKey
(
edgeID
.
»v”£Edge
())) {

237 ià(
	gedgeReduûrFunùiÚ
 !ğ
nuÎ
) {

238 
edgePrİ”t›sM­
.
put
(
edgeID
,

239 
edgeReduûrFunùiÚ
.
»duû
(
edge
.
g‘Prİ”t›s
(),

240 
edgeReduûrFunùiÚ
.
id’t™yV®ue
()));

242 
	gedgePrİ”t›sM­
.
put
(
edgeID
, 
edge
.
g‘Prİ”t›s
());

249 
	gv”‹xCouÁ
 = 0;

250 
	gedgeCouÁ
 = 0;

251 
SŒšg
 
	goutP©h
 = 
nuÎ
;

255 
	gI‹¿tÜ
<
	gEÁry
<
	gObjeù
, 
	gWr™abË
>> 
	gv”‹xI‹¿tÜ
 = 
v”‹xPrİ”t›sM­
.
’ŒyS‘
().
™”©Ü
();

257 
	goutP©h
 = 
Ãw
 
SŒšg
("vdata/rdftriples");

259 
	gv”‹xI‹¿tÜ
.
hasNext
()) {

261 
EÁry
 
	gv
 = 
v”‹xI‹¿tÜ
.
Ãxt
();

263 
v”‹xToRdf
(
v
.
g‘Key
().
toSŒšg
(), "PeİË", (
Prİ”tyM­
èv.
g‘V®ue
(), 
outP©h
);

264 
	gv”‹xCouÁ
++;

267 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_VERTICES
).
šüem’t
(
v”‹xCouÁ
);

271 
	gI‹¿tÜ
<
	gEÁry
<
	gEdgeID
, 
	gWr™abË
>> 
	gedgeI‹¿tÜ
 = 
edgePrİ”t›sM­
.
’ŒyS‘
().
™”©Ü
();

273 
	goutP©h
 = 
Ãw
 
SŒšg
("edata/rdftriples");

275 
	gedgeI‹¿tÜ
.
hasNext
()) {

277 
	gEÁry
<
	gEdgeID
, 
	gWr™abË
> 
	ge
 = 
edgeI‹¿tÜ
.
Ãxt
();

281 
edgeToRdf
(
e
.
g‘Key
().
g‘Src
().
toSŒšg
(),

282 
e
.
g‘Key
().
g‘D¡
().
toSŒšg
(),

283 
e
.
g‘Key
().
g‘Lab–
().
toSŒšg
(),

284 (
Prİ”tyM­
è
e
.
g‘V®ue
(),

285 
outP©h
);

287 
	gedgeCouÁ
++;

290 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_EDGES
).
šüem’t
(
edgeCouÁ
);

298 
v”‹xToRdf
(
SŒšg
 
key
, SŒšg 
Ïb–
, 
Prİ”tyM­
 
´İ”tyM­
, SŒšg 
outP©h
)

299 
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

302 
SŒšg
 
	gÇme¥aû
 = 
RDFName¥aûM­
.
g‘
(
this
.
rdfName¥aû
);

304 
Mod–
 
	gmod–
 = 
Mod–FaùÜy
.
ü—‹DeçuÉMod–
();

306 
Resourû
 
	gv”‹xRdf
 = 
mod–
.
ü—‹Resourû
(
Çme¥aû
 + 
key
);

307 
	gS‘
<
	gWr™abË
> 
	gvpkeys
 = 
´İ”tyM­
.
g‘Prİ”tyKeys
();

308 
Wr™abË
 
	g´İ”ty
 : 
vpkeys
) {

309 
v”‹xRdf
.
addPrİ”ty
(
DC
.
t™Ë
, 
´İ”tyM­
.
g‘Prİ”ty
(
´İ”ty
.
toSŒšg
()).toString());

313 
StmtI‹¿tÜ
 
	g™”
 = 
mod–
.
li¡S‹m’ts
();

315 
	g™”
.
hasNext
()) {

316 
S‹m’t
 
	g¡mt
 = 
™”
.
ÃxtS‹m’t
();

317 
Resourû
 
	gsubjeù
 = 
¡mt
.
g‘Subjeù
();

318 
Prİ”ty
 
	g´ediÿ‹
 = 
¡mt
.
g‘P»diÿ‹
();

319 
RDFNode
 
	gobjeù
 = 
¡mt
.
g‘Objeù
();

320 
Text
 
	g‹xt
 = 
Ãw
 Text(
subjeù
.
toSŒšg
(è+ " " + 
´ediÿ‹
.toSŒšg(è+ " " + 
objeù
.toString() + " .");

321 
	gthis
.
	gmuÉËOuuts
.
wr™e
(
NuÎWr™abË
.
g‘
(), 
‹xt
, 
outP©h
);

332 
edgeToRdf
(
SŒšg
 
sourû
, SŒšg 
rg‘
, SŒšg 
Ïb–
, 
Prİ”tyM­
 
´İ”tyM­
, SŒšg 
outP©h
)

333 
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

336 
SŒšg
 
	gÇme¥aû
 = 
RDFName¥aûM­
.
g‘
(
this
.
rdfName¥aû
);

338 
Mod–
 
	gmod–
 = 
Mod–FaùÜy
.
ü—‹DeçuÉMod–
();

340 
Resourû
 
	gedgeRdf
 = 
mod–
.
ü—‹Resourû
(
Çme¥aû
 + 
Ïb–
);

341 
	gedgeRdf
.
addPrİ”ty
(
DC
.
t™Ë
, 
sourû
);

342 
	gedgeRdf
.
addPrİ”ty
(
DC
.
t™Ë
, 
rg‘
);

343 
	gS‘
<
	gWr™abË
> 
	g•keys
 = 
´İ”tyM­
.
g‘Prİ”tyKeys
();

344 
Wr™abË
 
	g´İ”ty
 : 
•keys
) {

345 
edgeRdf
.
addPrİ”ty
(
DC
.
t™Ë
, 
´İ”tyM­
.
g‘Prİ”ty
(
´İ”ty
.
toSŒšg
()).toString());

349 
StmtI‹¿tÜ
 
	g™”
 = 
mod–
.
li¡S‹m’ts
();

351 
	g™”
.
hasNext
()) {

352 
S‹m’t
 
	g¡mt
 = 
™”
.
ÃxtS‹m’t
();

353 
Resourû
 
	gsubjeù
 = 
¡mt
.
g‘Subjeù
();

354 
Prİ”ty
 
	g´ediÿ‹
 = 
¡mt
.
g‘P»diÿ‹
();

355 
RDFNode
 
	gobjeù
 = 
¡mt
.
g‘Objeù
();

356 
Text
 
	g‹xt
 = 
Ãw
 Text(
subjeù
.
toSŒšg
(è+ " " + 
´ediÿ‹
.toSŒšg(è+ " " + 
objeù
.toString() + " .");

357 
	gthis
.
	gmuÉËOuuts
.
wr™e
(
NuÎWr™abË
.
g‘
(), 
‹xt
, 
outP©h
);

361 @
Ov”ride


362 
public
 
ş—nup
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

363 
	gmuÉËOuuts
.
şo£
();

	@src/com/intel/hadoop/graphbuilder/pipeline/output/textgraph/TextGraphMR.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	g‹xtg¿ph
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gEËm’tIdKeyFunùiÚ
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

32 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gHBa£Uts
;

33 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gP©h
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gNuÎWr™abË
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gJob
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gFeOuutFÜm©
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gLazyOuutFÜm©
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gTextOuutFÜm©
;

44 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

46 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gFunùiÚ®
;

78 
public
 cÏs 
	cTextG¿phMR
 
ex‹nds
 
	mG¿phG’”©iÚMRJob
 {

80 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
TextG¿phMR
.
şass
);

82 
´iv©e
 
CÚfigu¿tiÚ
 
	mcÚf
;

84 
´iv©e
 
HBa£Uts
 
	mhba£Uts
 = 
nuÎ
;

85 
´iv©e
 
boŞ—n
 
	musšgHBa£
 = 
çl£
;

87 
´iv©e
 
G¿phBudšgRuË
 
	mg¿phBudšgRuË
;

88 
´iv©e
 
IÅutCÚfigu¿tiÚ
 
	mšputCÚfigu¿tiÚ
;

90 
´iv©e
 
Prİ”tyG¿phEËm’t
 
	mm­V®ueTy³
;

91 
´iv©e
 
CÏss
 
	mvidCÏss
;

93 
´iv©e
 
fš®
 
CÏss
 
	mkeyFuncCÏss
 = 
EËm’tIdKeyFunùiÚ
.
şass
;

95 
´iv©e
 
FunùiÚ®
 
	mv”‹xReduûrFunùiÚ
;

96 
´iv©e
 
FunùiÚ®
 
	medgeReduûrFunùiÚ
;

97 
´iv©e
 
boŞ—n
 
	mş—nBidœeùiÚ®Edge
;

111 @
Ov”ride


112 
public
 
	$š™
(
IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
, 
G¿phBudšgRuË
 
g¿phBudšgRuË
) {

114 
this
.
g¿phBudšgRuË
 = graphBuildingRule;

115 
this
.
šputCÚfigu¿tiÚ
 = inputConfiguration;

116 
this
.
usšgHBa£
 = 
šputCÚfigu¿tiÚ
.
	`u£sHBa£
();

118 ià(
usšgHBa£
) {

119 
Œy
 {

120 
this
.
hba£Uts
 = 
HBa£Uts
.
	`g‘In¡ªû
();

121 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

122 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_CONNECT_TO_HBASE
,

123 "CªnÙ‡Îoÿ‹hHBa£Ut objeù. Check hba£ cÚÃùiÚ.", 
LOG
, 
e
);

125 
this
.
cÚf
 = 
hba£Uts
.
	`g‘CÚfigu¿tiÚ
();

127 
this
.
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

140 
public
 
	$£tFunùiÚCÏss
(
CÏss
 
v”‹xReduûrFunùiÚ
, CÏs 
edgeReduûrFunùiÚ
) {

141 
Œy
 {

142 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

143 
this
.
v”‹xReduûrFunùiÚ
 = (
FunùiÚ®
èv”‹xReduûrFunùiÚ.
	`ÃwIn¡ªû
();

146 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

147 
this
.
edgeReduûrFunùiÚ
 = (
FunùiÚ®
èedgeReduûrFunùiÚ.
	`ÃwIn¡ªû
();

149 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

150 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

151 "CªnÙ in¡ªtŸ‹„eduû¸funùiÚs.", 
LOG
, 
e
);

152 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

153 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

154 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs.", 
LOG
, 
e
);

156 
	}
}

164 @
Ov”ride


165 
public
 
	$£tCËªBidœeùiÚ®Edges
(
boŞ—n
 
ş—n
) {

166 
ş—nBidœeùiÚ®Edge
 = 
ş—n
;

167 
	}
}

180 @
Ov”ride


181 
public
 
	$£tV®ueCÏss
(
CÏss
 
v®ueCÏss
) {

182 
Œy
 {

183 
this
.
m­V®ueTy³
 = (
Prİ”tyG¿phEËm’t
è
v®ueCÏss
.
	`ÃwIn¡ªû
();

184 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

185 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

186 "CªnÙ s‘ v®uşas Ğ" + 
v®ueCÏss
.
	`g‘Name
(è+ ")", 
LOG
, 
e
);

187 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

188 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

189 "IÎeg®‡cûs exû±iÚ wh’ s‘tšg v®uşas Ğ" + 
v®ueCÏss
.
	`g‘Name
(è+ ")", 
LOG
, 
e
);

191 
	}
}

203 @
Ov”ride


204 
public
 
	$£tVidCÏss
(
CÏss
 
vidCÏss
) {

205 
this
.
vidCÏss
 = vidClass;

206 
	}
}

213 
public
 
CÚfigu¿tiÚ
 
	$g‘CÚf
() {

214  
this
.
cÚf
;

215 
	}
}

222 @
Ov”ride


223 
public
 
£tU£rO±iÚs
(
HashM­
<
SŒšg
, SŒšg> 
u£rO±s
) {

224 
	gS‘
<
	gSŒšg
> 
	gkeys
 = 
u£rO±s
.
keyS‘
();

225 
SŒšg
 
	gkey
 : 
keys
)

226 
cÚf
.
£t
(
key
, 
u£rO±s
.
g‘
(key.
toSŒšg
()));

238 
public
 
	$run
(
CommªdLše
 
cmd
è
throws
 
IOExû±iÚ
, 
CÏssNÙFoundExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

240 
SŒšg
 
ouutP©h
 = 
cmd
.
	`g‘O±iÚV®ue
("out");

244 
SŒšg
 
‹¡
 = 
g¿phBudšgRuË
.
	`g‘CÏss
().
	`g‘Name
();

246 
cÚf
.
	`£t
("G¿phTok’iz”", 
g¿phBudšgRuË
.
	`g‘G¿phTok’iz”CÏss
().
	`g‘Name
());

247 
cÚf
.
	`£tBoŞ—n
("noBiDœ", 
ş—nBidœeùiÚ®Edge
);

248 
cÚf
.
	`£t
("vidCÏss", 
vidCÏss
.
	`g‘Name
());

249 
cÚf
.
	`£t
("KeyFunùiÚ", 
keyFuncCÏss
.
	`g‘Name
());

253 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

254 
cÚf
.
	`£t
("v”‹xReduûrFunùiÚ", 
v”‹xReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

256 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

257 
cÚf
.
	`£t
("edgeReduûrFunùiÚ", 
edgeReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

262 
šputCÚfigu¿tiÚ
.
	`upd©eCÚfigu¿tiÚFÜM­³r
(
cÚf
, 
cmd
);

266 
g¿phBudšgRuË
.
	`upd©eCÚfigu¿tiÚFÜTok’iz”
(
cÚf
, 
cmd
);

270 
Job
 
job
 = 
Ãw
 
	`Job
(
cÚf
, "TextGraphMR");

271 
job
.
	`£tJ¬ByCÏss
(
TextG¿phMR
.
şass
);

275 
šputCÚfigu¿tiÚ
.
	`upd©eJobFÜM­³r
(
job
, 
cmd
);

277 
job
.
	`£tM­OuutKeyCÏss
(
IÁWr™abË
.
şass
);

278 
job
.
	`£tM­OuutV®ueCÏss
(
m­V®ueTy³
.
	`g‘CÏss
());

282 
job
.
	`£tReduûrCÏss
(
TextG¿phReduûr
.
şass
);

284 
job
.
	`£tOuutKeyCÏss
(
NuÎWr™abË
.
şass
);

285 
job
.
	`£tOuutV®ueCÏss
(
Text
.
şass
);

290 
job
.
	`£tOuutFÜm©CÏss
(
TextOuutFÜm©
.
şass
);

292 
LazyOuutFÜm©
.
	`£tOuutFÜm©CÏss
(
job
, 
TextOuutFÜm©
.
şass
);

294 
FeOuutFÜm©
.
	`£tOuutP©h
(
job
, 
Ãw
 
	`P©h
(
ouutP©h
));

298 
LOG
.
	`šfo
("=========== Job: Creating vertex†ist‡ndƒdge†ist from input data, saving‡sext file ===========");

300 
LOG
.
	`šfo
("šput: " + 
šputCÚfigu¿tiÚ
.
	`g‘DesütiÚ
());

301 
LOG
.
	`šfo
("Ouuˆğ" + 
ouutP©h
);

303 
LOG
.
	`šfo
("IÅutFÜm© = " + 
šputCÚfigu¿tiÚ
.
	`g‘DesütiÚ
());

304 
LOG
.
	`šfo
("G¿phTok’iz”FromSŒšg = " + 
g¿phBudšgRuË
.
	`g‘CÏss
().
	`g‘Name
());

306 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

307 
LOG
.
	`šfo
("v”‹xReduûrFunùiÚ = " + 
v”‹xReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

310 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

311 
LOG
.
	`šfo
("edgeReduûrFunùiÚ = " + 
edgeReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

314 
LOG
.
	`šfo
("==================== Start ====================================");

315 
job
.
	`wa™FÜCom¶‘iÚ
(
Œue
);

316 
LOG
.
	`šfo
("=================== Done ====================================\n");

317 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/textgraph/TextGraphOutputConfiguration.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	g‹xtg¿ph
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gOuutCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

25 
public
 cÏs 
	cTextG¿phOuutCÚfigu¿tiÚ
 
im¶em’ts
 
	mOuutCÚfigu¿tiÚ
 {

26 
´iv©e
 
G¿phG’”©iÚMRJob
 
	mg¿phG’”©iÚMRJob
;

29 
public
 
	$TextG¿phOuutCÚfigu¿tiÚ
() {

30 
g¿phG’”©iÚMRJob
 = 
Ãw
 
	`TextG¿phMR
();

33 
public
 
G¿phG’”©iÚMRJob
 
	$g‘G¿phG’”©iÚMRJob
() {

34  
g¿phG’”©iÚMRJob
;

35 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/textgraph/TextGraphReducer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	g‹xtg¿ph
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdgeID
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

32 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

33 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gNuÎWr™abË
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gReduûr
;

41 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gFunùiÚ®
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gMuÉËOuuts
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

60 
public
 
şass
 
TextG¿phReduûr
 
ex‹nds
 
	gReduûr
<
	gIÁWr™abË
, 
	gPrİ”tyG¿phEËm’t
, 
	gNuÎWr™abË
, 
	gText
> {

62 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
TextG¿phReduûr
.
şass
);

64 
´iv©e
 
	gMuÉËOuuts
<
	gNuÎWr™abË
, 
	gText
> 
	gmuÉËOuuts
;

66 
´iv©e
 
boŞ—n
 
	gnoBiDœ
;

67 
´iv©e
 
FunùiÚ®
 
	gedgeReduûrFunùiÚ
;

68 
´iv©e
 
FunùiÚ®
 
	gv”‹xReduûrFunùiÚ
;

70 
´iv©e
 
	eCouÁ”s
 {

71 
	gNUM_VERTICES
,

72 
	gNUM_EDGES


75 @
Ov”ride


76 
public
 
£tup
(
CÚ‹xt
 
cÚ‹xt
) {

78 
CÚfigu¿tiÚ
 
	gcÚf
 = 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
();

80 
	gthis
.
	gnoBiDœ
 = 
cÚf
.
g‘BoŞ—n
("noBiDœ", 
çl£
);

82 
	gmuÉËOuuts
 = 
Ãw
 
MuÉËOuuts
<
NuÎWr™abË
, 
	gText
>(
	gcÚ‹xt
);

83 
	gŒy
 {

84 ià(
	gcÚf
.
g‘
("edgeReduûrFunùiÚ"è!ğ
nuÎ
) {

85 
this
.
edgeReduûrFunùiÚ
 =

86 (
FunùiÚ®
è
CÏss
.
fÜName
(
cÚf
.
g‘
("edgeReduûrFunùiÚ")).
ÃwIn¡ªû
();

88 
	gthis
.
	gedgeReduûrFunùiÚ
.
cÚfigu»
(
cÚf
);

91 ià(
	gcÚf
.
g‘
("v”‹xReduûrFunùiÚ"è!ğ
nuÎ
) {

92 
this
.
v”‹xReduûrFunùiÚ
 =

93 (
FunùiÚ®
è
CÏss
.
fÜName
(
cÚf
.
g‘
("v”‹xReduûrFunùiÚ")).
ÃwIn¡ªû
();

95 
	gthis
.
	gv”‹xReduûrFunùiÚ
.
cÚfigu»
(
cÚf
);

97 } 
ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

98 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

99 "Could‚Ù in¡ªtŸ‹„eduû¸funùiÚs", 
LOG
, 
e
);

100 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

101 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

102 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs", 
LOG
, 
e
);

103 } 
ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

104 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

105 "CÏs nÙ foundƒxû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs", 
LOG
, 
e
);

106 } 
ÿtch
 (
FunùiÚ®
.
FunùiÚ®CÚfigu¿tiÚE¼Ü
 
e
) {

107 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

108 "CÚfigu¿tiÚƒ¼Ü wh’ cÚfiguršg„eduû¸funùiÚ®s.", 
LOG
, 
e
);

112 @
Ov”ride


113 
public
 
»duû
(
IÁWr™abË
 
key
, 
I‹¿bË
<
Prİ”tyG¿phEËm’t
> 
v®ues
, 
CÚ‹xt
 
cÚ‹xt
)

114 
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

116 
	gHashM­
<
	gEdgeID
, 
	gWr™abË
> 
	gedgePrİ”t›sM­
 = 
Ãw
 
HashM­
();

117 
	gHashM­
<
	gObjeù
, 
	gWr™abË
> 
	gv”‹xPrİ”t›sM­
 = 
Ãw
 
HashM­
();

119 
	gI‹¿tÜ
<
	gPrİ”tyG¿phEËm’t
> 
	gv®ueI‹¿tÜ
 = 
v®ues
.
™”©Ü
();

121 
	gv®ueI‹¿tÜ
.
hasNext
()) {

123 
Prİ”tyG¿phEËm’t
 
	gÃxt
 = 
v®ueI‹¿tÜ
.
Ãxt
();

127 ià(
	gÃxt
.
g¿phEËm’tTy³
(è=ğ
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
) {

129 
Objeù
 
v”‹xId
 = 
Ãxt
.
v”‹x
().
g‘V”‹xId
();

130 
V”‹x
 
	gv”‹x
 = 
Ãxt
.
v”‹x
();

132 ià(
	gv”‹xPrİ”t›sM­
.
cÚšsKey
(
v”‹xId
)) {

136 ià(
	gv”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

137 
v”‹xPrİ”t›sM­
.
put
(
v”‹xId
,

138 
v”‹xReduûrFunùiÚ
.
»duû
(
v”‹x
.
g‘Prİ”t›s
(),

139 
v”‹xPrİ”t›sM­
.
g‘
(
v”‹xId
)));

147 
Prİ”tyM­
 
	gexi¡šgPrİ”tyM­
 = (Prİ”tyM­è
v”‹xPrİ”t›sM­
.
g‘
(
v”‹xId
);

148 
	gexi¡šgPrİ”tyM­
.
m”gePrİ”t›s
(
v”‹x
.
g‘Prİ”t›s
());

154 ià(
	gv”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

155 
v”‹xPrİ”t›sM­
.
put
(
v”‹xId
,

156 
v”‹xReduûrFunùiÚ
.
»duû
(
v”‹x
.
g‘Prİ”t›s
(), v”‹xReduûrFunùiÚ.
id’t™yV®ue
()));

158 
	gv”‹xPrİ”t›sM­
.
put
(
v”‹xId
, 
v”‹x
.
g‘Prİ”t›s
());

166 
	gEdge
<?> 
	gedge
 = 
Ãxt
.
edge
();

167 
EdgeID
 
	gedgeID
 = 
Ãw
 EdgeID(
edge
.
g‘Src
(),ƒdge.
g‘D¡
(),ƒdge.
g‘EdgeLab–
());

169 ià(
	gedge
.
isS–fEdge
()) {

174 ià(
	gedgePrİ”t›sM­
.
cÚšsKey
(
edgeID
)) {

180 ià(
	gedgeReduûrFunùiÚ
 !ğ
nuÎ
) {

181 
edgePrİ”t›sM­
.
put
(
edgeID
, 
edgeReduûrFunùiÚ
.
»duû
(
edge
.
g‘Prİ”t›s
(),

182 
edgePrİ”t›sM­
.
g‘
(
edgeID
)));

189 
Prİ”tyM­
 
	gexi¡šgPrİ”tyM­
 = (Prİ”tyM­è
edgePrİ”t›sM­
.
g‘
(
edgeID
);

190 
	gexi¡šgPrİ”tyM­
.
m”gePrİ”t›s
(
edge
.
g‘Prİ”t›s
());

197 ià(
	gnoBiDœ
 && 
	gedgePrİ”t›sM­
.
cÚšsKey
(
edgeID
.
»v”£Edge
())) {

203 ià(
	gedgeReduûrFunùiÚ
 !ğ
nuÎ
) {

204 
edgePrİ”t›sM­
.
put
(
edgeID
, 
edgeReduûrFunùiÚ
.
»duû
(
edge
.
g‘Prİ”t›s
(),

205 
edgeReduûrFunùiÚ
.
id’t™yV®ue
()));

207 
	gedgePrİ”t›sM­
.
put
(
edgeID
, 
edge
.
g‘Prİ”t›s
());

214 
	gv”‹xCouÁ
 = 0;

215 
	gedgeCouÁ
 = 0;

216 
SŒšg
 
	goutP©h
 = 
nuÎ
;

220 
	gI‹¿tÜ
<
	gEÁry
<
	gObjeù
, 
	gWr™abË
>> 
	gv”‹xI‹¿tÜ
 = 
v”‹xPrİ”t›sM­
.
’ŒyS‘
().
™”©Ü
();

222 
	goutP©h
 = 
Ãw
 
SŒšg
("vdata/part");

224 
	gv”‹xI‹¿tÜ
.
hasNext
()) {

226 
EÁry
 
	gv
 = 
v”‹xI‹¿tÜ
.
Ãxt
();

227 
Text
 
	gv®ue
 = 
Ãw
 Text(
v
.
g‘Key
().
toSŒšg
(è+ "\t" + v.
g‘V®ue
().toString());

229 
	gmuÉËOuuts
.
wr™e
(
NuÎWr™abË
.
g‘
(), 
v®ue
, 
outP©h
);

230 
	gv”‹xCouÁ
++;

233 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_VERTICES
).
šüem’t
(
v”‹xCouÁ
);

237 
	gI‹¿tÜ
<
	gEÁry
<
	gEdgeID
, 
	gWr™abË
>> 
	gedgeI‹¿tÜ
 = 
edgePrİ”t›sM­
.
’ŒyS‘
().
™”©Ü
();

239 
	goutP©h
 = 
Ãw
 
SŒšg
("edata/part");

241 
	gedgeI‹¿tÜ
.
hasNext
()) {

243 
	gEÁry
<
	gEdgeID
, 
	gWr™abË
> 
	ge
 = 
edgeI‹¿tÜ
.
Ãxt
();

245 
Text
 
	gv®ue
 = 
Ãw
 Text(
e
.
g‘Key
().
g‘Src
(è+ "\t" +ƒ.g‘Key().
g‘D¡
(è+ "\t" +ƒ.g‘Key().
g‘Lab–
()

246 + "\t" + 
e
.
g‘V®ue
().
toSŒšg
());

248 
	gmuÉËOuuts
.
wr™e
(
NuÎWr™abË
.
g‘
(), 
v®ue
, 
outP©h
);

249 
	gedgeCouÁ
++;

252 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_EDGES
).
šüem’t
(
edgeCouÁ
);

255 @
Ov”ride


256 
public
 
ş—nup
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

257 
	gmuÉËOuuts
.
şo£
();

	@src/com/intel/hadoop/graphbuilder/pipeline/output/titan/EdgesIntoTitanReducer.java

2 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
;

4 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdgeID
;

5 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

6 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

7 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

8 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gEnÿpsuÏ‹dObjeù
;

9 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gLÚgTy³
;

10 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

11 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

12 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phD©aba£CÚÃùÜ
;

13 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

14 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªG¿ph
;

15 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gcÚfigu¿tiÚ
.
	gBa£CÚfigu¿tiÚ
;

16 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

17 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

18 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gReduûr
;

19 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

21 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
public
 
şass
 
EdgesIÁoT™ªReduûr
 
ex‹nds
 
	gReduûr
<
	gIÁWr™abË
, 
	gPrİ”tyG¿phEËm’t
, IntWritable, PropertyGraphElement> {

37 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
EdgesIÁoT™ªReduûr
.
şass
);

38 
´iv©e
 
T™ªG¿ph
 
	gg¿ph
;

39 
´iv©e
 
	gHashM­
<
	gObjeù
, 
	gLÚg
> 
	gv”‹xNameToT™ªID
;

43 
´iv©e
 
	eCouÁ”s
 {

44 
	gEDGE_PROPERTIES_WRITTEN
,

45 
	gNUM_EDGES


54 
´iv©e
 
T™ªG¿ph
 
G¿phFaùÜyO³n
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
 {

55 
Ba£CÚfigu¿tiÚ
 
	gt™ªCÚfig
 = 
Ãw
 BaseConfiguration();

56  
	gG¿phD©aba£CÚÃùÜ
.
İ’
("t™ª", 
t™ªCÚfig
, 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
());

66 @
Ov”ride


67 
public
 
£tup
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

69 
	gthis
.
	gv”‹xNameToT™ªID
 = 
Ãw
 
HashM­
<
Objeù
, 
	gLÚg
>();

71 
	gthis
.
	gg¿ph
 = 
G¿phFaùÜyO³n
(
cÚ‹xt
);

91 @
Ov”ride


92 
public
 
»duû
(
IÁWr™abË
 
key
, 
I‹¿bË
<
Prİ”tyG¿phEËm’t
> 
v®ues
, 
CÚ‹xt
 
cÚ‹xt
)

93 
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

95 
	gHashM­
<
	gEdgeID
, 
	gWr™abË
> 
	gedgePrİ”tyTabË
 = 
Ãw
 
HashM­
();

97 
	gI‹¿tÜ
<
	gPrİ”tyG¿phEËm’t
> 
	gv®ueI‹¿tÜ
 = 
v®ues
.
™”©Ü
();

99 
	gv®ueI‹¿tÜ
.
hasNext
()) {

101 
Prİ”tyG¿phEËm’t
 
	gÃxtEËm’t
 = 
v®ueI‹¿tÜ
.
Ãxt
();

105 ià(
	gÃxtEËm’t
.
g¿phEËm’tTy³
(è=ğ
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
) {

107 
V”‹x
 
v”‹x
 = 
ÃxtEËm’t
.vertex();

109 
Objeù
 
	gv”‹xId
 = 
v”‹x
.
g‘V”‹xId
();

110 
Prİ”tyM­
 
	g´İ”tyM­
 = 
v”‹x
.
g‘Prİ”t›s
();

111 
	gv”‹xT™ªId
 = ((
LÚgTy³
è
´İ”tyM­
.
g‘Prİ”ty
("T™ªID")).
g‘
();

113 
	gv”‹xNameToT™ªID
.
put
(
v”‹xId
, 
v”‹xT™ªId
);

120 
	gEdge
<?> 
	gedge
 = 
ÃxtEËm’t
.
edge
();

121 
EdgeID
 
	gedgeID
 = 
Ãw
 EdgeID(
edge
.
g‘Src
(),ƒdge.
g‘D¡
(),ƒdge.
g‘EdgeLab–
());

123 
	gedgePrİ”tyTabË
.
put
(
edgeID
, 
edge
.
g‘Prİ”t›s
());

127 
	gedgeCouÁ
 = 0;

131 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gEdgeID
, 
	gWr™abË
>> 
	gedgeI‹¿tÜ
 = 
edgePrİ”tyTabË
.
’ŒyS‘
().
™”©Ü
();

133 
	gedgeI‹¿tÜ
.
hasNext
()) {

135 
	gM­
.
	gEÁry
<
	gEdgeID
, 
	gWr™abË
> 
	gedgeM­EÁry
 = 
edgeI‹¿tÜ
.
Ãxt
();

137 
Objeù
 
	gd¡
 = 
edgeM­EÁry
.
g‘Key
().
g‘D¡
();

138 
SŒšg
 
	gÏb–
 = 
edgeM­EÁry
.
g‘Key
().
g‘Lab–
().
toSŒšg
();

140 
Prİ”tyM­
 
	g´İ”tyM­
 = (Prİ”tyM­è
edgeM­EÁry
.
g‘V®ue
();

142 
	g¤cT™ªId
 = ((
LÚgTy³
è
´İ”tyM­
.
g‘Prİ”ty
("¤cT™ªID")).
g‘
();

143 
	gd¡T™ªId
 = 
v”‹xNameToT™ªID
.
g‘
(
d¡
);

145 
	gcom
.
	gtšk”pİ
.
	gblu•ršts
.
V”‹x
 
	g¤cBlu•rštsV”‹x
 = 
this
.
g¿ph
.
g‘V”‹x
(
¤cT™ªId
);

146 
	gcom
.
	gtšk”pİ
.
	gblu•ršts
.
V”‹x
 
	gtgtBlu•rštsV”‹x
 = 
this
.
g¿ph
.
g‘V”‹x
(
d¡T™ªId
);

150 
	gcom
.
	gtšk”pİ
.
	gblu•ršts
.
Edge
 
	gbluePrštsEdge
 = 
nuÎ
;

151 
	gŒy
 {

152 
	gbluePrštsEdge
 = 
this
.
g¿ph
.
addEdge
(
nuÎ
,

153 
¤cBlu•rštsV”‹x
,

154 
tgtBlu•rštsV”‹x
,

155 
Ïb–
);

156 } 
ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {;

157 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
TITAN_ERROR
,

158 "Could‚Ù‡ddƒdgtØT™ª;†ik–y‡ schem¨”rÜ. ThÏb– oÀthedgi  " + 
Ïb–
,

159 
LOG
, 
e
);

167 
	g´İ”tyM­
.
»movePrİ”ty
("srcTitanID");

169 
Wr™abË
 
	g´İ”tyKey
 : 
´İ”tyM­
.
g‘Prİ”tyKeys
()) {

170 
EnÿpsuÏ‹dObjeù
 
m­EÁry
 = (EnÿpsuÏ‹dObjeùè
´İ”tyM­
.
g‘Prİ”ty
(
´İ”tyKey
.
toSŒšg
());

172 
	gŒy
 {

173 
	gbluePrštsEdge
.
£tPrİ”ty
(
´İ”tyKey
.
toSŒšg
(), 
m­EÁry
.
g‘Ba£Objeù
());

174 } 
ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

175 
	gLOG
.
çl
("Could‚Ù‡ddƒdg´İ”ty;…robably‡ schem¨”rÜ. ThÏb– oÀthedgi  " + 
Ïb–
);

176 
	gLOG
.
çl
("Th´İ”ty oÀthedgi " + 
´İ”tyKey
.
toSŒšg
());

177 
	gLOG
.
çl
(
e
.
g‘Mes§ge
());

178 
	ge
.
´štSckT¿û
();

179 
	gSy¡em
.
ex™
(1);

184 
	gedgeCouÁ
++;

187 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_EDGES
).
šüem’t
(
edgeCouÁ
);

198 @
Ov”ride


199 
public
 
ş—nup
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

200 
	gthis
.
	gg¿ph
.
shutdown
();

	@src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanCommandLineOptions.java

1 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
;

3 
public
 cÏs 
	cT™ªCommªdLšeO±iÚs
 {

4 
public
 
fš®
 
SŒšg
 
	mAPPEND
 = "append";

	@src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanConfig.java

1 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
;

4 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gRuÁimeCÚfig
;

6 
public
 cÏs 
	cT™ªCÚfig
 {

8 
public
 
fš®
 
SŒšg
 
	mTITAN_STORAGE_BACKEND
 = "hbase";

9 
public
 
fš®
 
SŒšg
 
	mTITAN_STORAGE_HOSTNAME
 = "localhost";

10 
public
 
fš®
 
SŒšg
 
	mTITAN_STORAGE_TABLENAME
 = "titan";

11 
public
 
fš®
 
SŒšg
 
	mTITAN_STORAGE_PORT
 = "2181";

12 
public
 
fš®
 
SŒšg
 
	mTITAN_STORAGE_CONNECTION_TIMEOUT
 = "10000";

14 
public
 
fš®
 
RuÁimeCÚfig
 
	mcÚfig
 = RuÁimeCÚfig.
g‘In¡ªû
(
T™ªCÚfig
.
şass
);

	@src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanOutputConfiguration.java

3 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
;

5 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gOuutCÚfigu¿tiÚ
;

6 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

8 
public
 cÏs 
	cT™ªOuutCÚfigu¿tiÚ
 
im¶em’ts
 
	mOuutCÚfigu¿tiÚ
 {

9 
´iv©e
 
G¿phG’”©iÚMRJob
 
	mg¿phG’”©iÚMRJob
;

12 
public
 
	$T™ªOuutCÚfigu¿tiÚ
() {

13 
g¿phG’”©iÚMRJob
 = 
Ãw
 
	`T™ªWr™”MRChaš
();

16 
public
 
G¿phG’”©iÚMRJob
 
	$g‘G¿phG’”©iÚMRJob
() {

17  
g¿phG’”©iÚMRJob
;

18 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanWriterMRChain.java

3 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
;

5 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gIÅutCÚfigu¿tiÚ
;

6 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gSourûV”‹xKeyFunùiÚ
;

7 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gG¿phG’”©iÚMRJob
;

8 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gEdgeSchema
;

9 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tyG¿phSchema
;

10 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tySchema
;

11 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gV”‹xSchema
;

12 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

13 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

14 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.*;

15 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªG¿ph
;

16 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªKey
;

17 
impÜt
 
	gcom
.
	gtšk”pİ
.
	gblu•ršts
.
	gV”‹x
;

19 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gcÚfigu¿tiÚ
.
	gBa£CÚfigu¿tiÚ
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gFeSy¡em
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gP©h
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gJob
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gFeIÅutFÜm©
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gšput
.
	gSequ’ûFeIÅutFÜm©
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gFeOuutFÜm©
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	glib
.
	gouut
.
	gSequ’ûFeOuutFÜm©
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

32 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

33 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

36 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

79 
public
 cÏs 
	cT™ªWr™”MRChaš
 
ex‹nds
 
	mG¿phG’”©iÚMRJob
 {

81 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
T™ªWr™”MRChaš
.
şass
);

82 
´iv©e
 
fš®
 
	mRANDOM_MIN
 = 1;

83 
´iv©e
 
fš®
 
	mRANDOM_MAX
 = 1000000;

84 
´iv©e
 
CÚfigu¿tiÚ
 
	mcÚf
;

86 
´iv©e
 
HBa£Uts
 
	mhba£Uts
 = 
nuÎ
;

87 
´iv©e
 
boŞ—n
 
	musšgHBa£
 = 
çl£
;

89 
´iv©e
 
G¿phBudšgRuË
 
	mg¿phBudšgRuË
;

90 
´iv©e
 
IÅutCÚfigu¿tiÚ
 
	mšputCÚfigu¿tiÚ
;

92 
´iv©e
 
Prİ”tyG¿phEËm’t
 
	mm­V®ueTy³
;

93 
´iv©e
 
CÏss
 
	mvidCÏss
;

94 
´iv©e
 
Prİ”tyG¿phSchema
 
	mg¿phSchema
;

96 
´iv©e
 
FunùiÚ®
 
	mv”‹xReduûrFunùiÚ
;

97 
´iv©e
 
FunùiÚ®
 
	medgeReduûrFunùiÚ
;

98 
´iv©e
 
boŞ—n
 
	mş—nBidœeùiÚ®Edge
;

108 @
Ov”ride


109 
public
 
	$š™
(
IÅutCÚfigu¿tiÚ
 
šputCÚfigu¿tiÚ
, 
G¿phBudšgRuË
 
g¿phBudšgRuË
) {

111 
this
.
g¿phBudšgRuË
 = graphBuildingRule;

112 
this
.
šputCÚfigu¿tiÚ
 = inputConfiguration;

113 
this
.
g¿phSchema
 = 
g¿phBudšgRuË
.
	`g‘G¿phSchema
();

114 
this
.
usšgHBa£
 = 
Œue
;

116 
Œy
 {

117 
this
.
hba£Uts
 = 
HBa£Uts
.
	`g‘In¡ªû
();

118 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

119 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_CONNECT_TO_HBASE
,

120 "CªnÙ‡Îoÿ‹hHBa£Ut objeù. Check hba£ cÚÃùiÚ.", 
LOG
, 
e
);

123 
this
.
cÚf
 = 
hba£Uts
.
	`g‘CÚfigu¿tiÚ
();

136 
public
 
	$£tFunùiÚCÏss
(
CÏss
 
v”‹xReduûrFunùiÚ
, CÏs 
edgeReduûrFunùiÚ
) {

137 
Œy
 {

138 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

139 
this
.
v”‹xReduûrFunùiÚ
 = (
FunùiÚ®
èv”‹xReduûrFunùiÚ.
	`ÃwIn¡ªû
();

142 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

143 
this
.
edgeReduûrFunùiÚ
 = (
FunùiÚ®
èedgeReduûrFunùiÚ.
	`ÃwIn¡ªû
();

145 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

146 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

147 "UÇbËØš¡ªtŸ‹„eduû¸funùiÚs.", 
LOG
, 
e
);

148 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

149 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

150 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs.", 
LOG
, 
e
);

152 
	}
}

160 @
Ov”ride


161 
public
 
	$£tCËªBidœeùiÚ®Edges
(
boŞ—n
 
ş—n
) {

162 
ş—nBidœeùiÚ®Edge
 = 
ş—n
;

163 
	}
}

176 @
Ov”ride


177 
public
 
	$£tV®ueCÏss
(
CÏss
 
v®ueCÏss
) {

178 
Œy
 {

179 
this
.
m­V®ueTy³
 = (
Prİ”tyG¿phEËm’t
è
v®ueCÏss
.
	`ÃwIn¡ªû
();

180 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

181 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

182 "CªnÙ s‘ v®uşas Ğ" + 
v®ueCÏss
.
	`g‘Name
(è+ ")", 
LOG
, 
e
);

183 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

184 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

185 "IÎeg®‡cûs exû±iÚ wh’ s‘tšg v®uşas Ğ" + 
v®ueCÏss
.
	`g‘Name
(è+ ")", 
LOG
, 
e
);

187 
	}
}

198 @
Ov”ride


199 
public
 
	$£tVidCÏss
(
CÏss
 
vidCÏss
) {

200 
this
.
vidCÏss
 = vidClass;

201 
	}
}

207 
public
 
CÚfigu¿tiÚ
 
	$g‘CÚf
() {

208  
this
.
cÚf
;

209 
	}
}

212 
´iv©e
 
IÁeg”
 
	$¿ndom
(){

213 
Rªdom
 
¿nd
 = 
Ãw
 
	`Rªdom
();

215 
¿ndomNum
 = 
¿nd
.
	`ÃxtIÁ
((
RANDOM_MAX
 - 
RANDOM_MIN
) + 1) + RANDOM_MIN;

217  
¿ndomNum
;

219 
	}
}

225 @
Ov”ride


226 
public
 
£tU£rO±iÚs
(
HashM­
<
SŒšg
, SŒšg> 
u£rO±s
) {

227 
	gS‘
<
	gSŒšg
> 
	gkeys
 = 
u£rO±s
.
keyS‘
();

228 
SŒšg
 
	gkey
 : 
keys
)

229 
cÚf
.
£t
(
key
, 
u£rO±s
.
g‘
(key.
toSŒšg
()));

239 
´iv©e
 
T™ªG¿ph
 
	$G¿phFaùÜyO³n
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
è
throws
 
IOExû±iÚ
 {

240 
Ba£CÚfigu¿tiÚ
 
t™ªCÚfig
 = 
Ãw
 
	`Ba£CÚfigu¿tiÚ
();

242  
G¿phD©aba£CÚÃùÜ
.
	`İ’
("t™ª", 
t™ªCÚfig
, 
cÚfigu¿tiÚ
);

243 
	}
}

248 
´iv©e
 
	$š™T™ªG¿ph
 () {

249 
T™ªG¿ph
 
g¿ph
 = 
nuÎ
;

251 
Œy
 {

252 
g¿ph
 = 
	`G¿phFaùÜyO³n
(
cÚf
);

253 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

254 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

255 "GRAPHBUILDER FAILURE: UnhªdËd IOƒxû±iÚ wh©‹m±šgØcÚÃùØT™ª.", 
LOG
, 
e
);

258 
g¿ph
.
	`makeKey
("ŒueName").
	`d©aTy³
(
SŒšg
.
şass
).
	`šdexed
(
V”‹x
.şass).
	`unique
().
	`make
();

260 
V”‹xSchema
 
v”‹xSchema
 : 
g¿phSchema
.
	`g‘V”‹xSchem©a
()) {

261 
Prİ”tySchema
 
vps
 : 
v”‹xSchema
.
	`g‘Prİ”tySchem©a
()) {

262 
g¿ph
.
	`makeKey
(
vps
.
	`g‘Name
()).
	`d©aTy³
(vps.
	`g‘Ty³
()).
	`make
();

267 
EdgeSchema
 
edgeSchema
 : 
g¿phSchema
.
	`g‘EdgeSchem©a
()) {

268 
A¼ayLi¡
<
T™ªKey
> 
t™ªKeys
 = 
Ãw
 ArrayList<TitanKey>();

270 
Prİ”tySchema
 
•s
 : 
edgeSchema
.
	`g‘Prİ”tySchem©a
()) {

271 
t™ªKeys
.
	`add
(
g¿ph
.
	`makeKey
(
•s
.
	`g‘Name
()).
	`d©aTy³
Óps.
	`g‘Ty³
()).
	`make
());

274 
T™ªKey
[] 
t™ªKeyA¼ay
 = 
t™ªKeys
.
	`toA¼ay
(
Ãw
 T™ªKey[t™ªKeys.
	`size
()]);

275 
g¿ph
.
	`makeLab–
(
edgeSchema
.
	`g‘Lab–
()).
	`sigÇtu»
(
t™ªKeyA¼ay
).
	`make
();

278 
g¿ph
.
	`comm™
();

279 
	}
}

291 
public
 
	$run
(
CommªdLše
 
cmd
)

292 
throws
 
IOExû±iÚ
, 
CÏssNÙFoundExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

296 
SŒšg
 
t™ªTabËName
 = 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_TABLENAME");

298 ià(
hba£Uts
.
	`bËExi¡s
(
t™ªTabËName
)) {

299 ià(
cmd
.
	`hasO±iÚ
(
T™ªCommªdLšeO±iÚs
.
APPEND
)) {

300 
LOG
.
	`šfo
("WARNING: hba£abË " + 
t™ªTabËName
 +

303 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

304 "GRAPHBUILDER FAILURE: hba£abË " + 
t™ªTabËName
 +

305 "‡Ì—dyƒxi¡s. U£ -¨İtiÚ iàyou wishØ­³nd‚ew g¿phØexi¡šg d©a.", 
LOG
);

309 
SŒšg
 
š‹rmedŸ‹D©aFeName
 = "g¿phbud”_‹mp_fe-" + 
	`¿ndom
().
	`toSŒšg
();

310 
P©h
 
š‹rmedŸ‹D©aFeP©h
 = 
Ãw
 
	`P©h
("/tmp/" + 
š‹rmedŸ‹D©aFeName
);

313 
	`š™T™ªG¿ph
();

315 
	`runR—dIÅutLßdV”tiûsMRJob
(
š‹rmedŸ‹D©aFeP©h
, 
cmd
);

317 
	`runEdgeLßdMRJob
(
š‹rmedŸ‹D©aFeP©h
);

319 
FeSy¡em
 
fs
 = FeSy¡em.
	`g‘
(
	`g‘CÚf
());

320 
fs
.
	`d–‘e
(
š‹rmedŸ‹D©aFeP©h
, 
Œue
);

321 
	}
}

323 
´iv©e
 
	$runR—dIÅutLßdV”tiûsMRJob
(
P©h
 
š‹rmedŸ‹D©aFeP©h
, 
CommªdLše
 
cmd
)

324 
throws
 
IOExû±iÚ
, 
CÏssNÙFoundExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

328 
cÚf
.
	`£t
("G¿phTok’iz”", 
g¿phBudšgRuË
.
	`g‘G¿phTok’iz”CÏss
().
	`g‘Name
());

329 
cÚf
.
	`£tBoŞ—n
("noBiDœ", 
ş—nBidœeùiÚ®Edge
);

330 
cÚf
.
	`£t
("vidCÏss", 
vidCÏss
.
	`g‘Name
());

331 
cÚf
.
	`£t
("KeyFunùiÚ", 
SourûV”‹xKeyFunùiÚ
.
şass
.
	`g‘Name
());

335 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

336 
cÚf
.
	`£t
("v”‹xReduûrFunùiÚ", 
v”‹xReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

338 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

339 
cÚf
.
	`£t
("edgeReduûrFunùiÚ", 
edgeReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

344 
šputCÚfigu¿tiÚ
.
	`upd©eCÚfigu¿tiÚFÜM­³r
(
cÚf
, 
cmd
);

348 
g¿phBudšgRuË
.
	`upd©eCÚfigu¿tiÚFÜTok’iz”
(
cÚf
, 
cmd
);

352 
Job
 
lßdV”tiûsJob
 = 
Ãw
 
	`Job
(
cÚf
, "TitanWriterMRChain Job 1: Writing Vertices into Titan");

353 
lßdV”tiûsJob
.
	`£tJ¬ByCÏss
(
T™ªWr™”MRChaš
.
şass
);

357 
šputCÚfigu¿tiÚ
.
	`upd©eJobFÜM­³r
(
lßdV”tiûsJob
, 
cmd
);

359 
lßdV”tiûsJob
.
	`£tM­OuutKeyCÏss
(
IÁWr™abË
.
şass
);

360 
lßdV”tiûsJob
.
	`£tM­OuutV®ueCÏss
(
m­V®ueTy³
.
	`g‘CÏss
());

364 
lßdV”tiûsJob
.
	`£tReduûrCÏss
(
V”tiûsIÁoT™ªReduûr
.
şass
);

368 
G¿phD©aba£CÚÃùÜ
.
	`checkT™ªIn¡®ÏtiÚ
();

372 
lßdV”tiûsJob
.
	`£tOuutFÜm©CÏss
(
Sequ’ûFeOuutFÜm©
.
şass
);

373 
lßdV”tiûsJob
.
	`£tOuutKeyCÏss
(
IÁWr™abË
.
şass
);

374 
lßdV”tiûsJob
.
	`£tOuutV®ueCÏss
(
m­V®ueTy³
.
	`g‘CÏss
());

376 
FeOuutFÜm©
.
	`£tOuutP©h
(
lßdV”tiûsJob
, 
š‹rmedŸ‹D©aFeP©h
);

380 
LOG
.
	`šfo
("=========== TitanWriterMRChain Job 1: Create initial graphƒlements from„aw data,†oad verticeso Titan ===========");

382 
LOG
.
	`šfo
("šput: " + 
šputCÚfigu¿tiÚ
.
	`g‘DesütiÚ
());

383 
LOG
.
	`šfo
("Ouuˆi ¨t™ª dba£ = " + 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_TABLENAME"));

385 
LOG
.
	`šfo
("IÅutFÜm© = " + 
šputCÚfigu¿tiÚ
.
	`g‘DesütiÚ
());

386 
LOG
.
	`šfo
("G¿phBudšgRuË = " + 
g¿phBudšgRuË
.
	`g‘CÏss
().
	`g‘Name
());

388 ià(
v”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

389 
LOG
.
	`šfo
("v”‹xReduûrFunùiÚ = " + 
v”‹xReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

392 ià(
edgeReduûrFunùiÚ
 !ğ
nuÎ
) {

393 
LOG
.
	`šfo
("edgeReduûrFunùiÚ = " + 
edgeReduûrFunùiÚ
.
	`g‘CÏss
().
	`g‘Name
());

396 
LOG
.
	`šfo
("==================== Start ====================================");

397 
lßdV”tiûsJob
.
	`wa™FÜCom¶‘iÚ
(
Œue
);

398 
LOG
.
	`šfo
("=================== Done ====================================\n");

400 
	}
}

402 
´iv©e
 
	$runEdgeLßdMRJob
(
P©h
 
š‹rmedŸ‹D©aFeP©h
)

403 
throws
 
IOExû±iÚ
, 
CÏssNÙFoundExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

407 
Job
 
wr™eEdgesJob
 = 
Ãw
 
	`Job
(
cÚf
, "TitanWriterMRChain Job 2: Writing Edgeso Titan");

408 
wr™eEdgesJob
.
	`£tJ¬ByCÏss
(
T™ªWr™”MRChaš
.
şass
);

412 
wr™eEdgesJob
.
	`£tM­³rCÏss
(
PassThruM­³rIÁeg”Key
.
şass
);

414 
wr™eEdgesJob
.
	`£tM­OuutKeyCÏss
(
IÁWr™abË
.
şass
);

415 
wr™eEdgesJob
.
	`£tM­OuutV®ueCÏss
(
m­V®ueTy³
.
	`g‘CÏss
());

419 
wr™eEdgesJob
.
	`£tReduûrCÏss
(
EdgesIÁoT™ªReduûr
.
şass
);

423 
wr™eEdgesJob
.
	`£tIÅutFÜm©CÏss
(
Sequ’ûFeIÅutFÜm©
.
şass
);

425 
Œy
 {

426 
FeIÅutFÜm©
.
	`addIÅutP©h
(
wr™eEdgesJob
, 
š‹rmedŸ‹D©aFeP©h
);

427 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

428 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

429 "CªnÙ‡cûs ‹mpÜ¬yƒdgfe.", 
LOG
, 
e
);

432 
wr™eEdgesJob
.
	`£tOuutFÜm©CÏss
(
Üg
.
­ache
.
hadoİ
.
m­»duû
.
lib
.
ouut
.
NuÎOuutFÜm©
.
şass
);

434 
LOG
.
	`šfo
("=========== Job 2: Propagate Titan Vertex IDso Edges‡nd Load Edges into Titan ===========");

436 
LOG
.
	`šfo
("==================== Start ====================================");

437 
wr™eEdgesJob
.
	`wa™FÜCom¶‘iÚ
(
Œue
);

438 
LOG
.
	`šfo
("=================== Done ====================================\n");

439 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/output/titan/VerticesIntoTitanReducer.java

2 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
;

4 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdgeID
;

5 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gDe¡š©iÚV”‹xKeyFunùiÚ
;

6 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gKeyFunùiÚ
;

7 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gEnÿpsuÏ‹dObjeù
;

8 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

9 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

10 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

11 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

12 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phD©aba£CÚÃùÜ
;

13 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

14 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªEËm’t
;

15 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªG¿ph
;

17 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

18 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

19 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gFunùiÚ®
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.*;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gReduûr
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gcÚfigu¿tiÚ
.
	gBa£CÚfigu¿tiÚ
;

26 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

27 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

34 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gLÚgTy³
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

46 
public
 
şass
 
V”tiûsIÁoT™ªReduûr
 
ex‹nds
 
	gReduûr
<
	gIÁWr™abË
, 
	gPrİ”tyG¿phEËm’t
, IntWritable, PropertyGraphElement> {

48 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
V”tiûsIÁoT™ªReduûr
.
şass
);

50 
´iv©e
 
boŞ—n
 
	gnoBiDœ
;

51 
´iv©e
 
FunùiÚ®
 
	gedgeReduûrFunùiÚ
;

52 
´iv©e
 
FunùiÚ®
 
	gv”‹xReduûrFunùiÚ
;

53 
´iv©e
 
T™ªG¿ph
 
	gg¿ph
;

55 
´iv©e
 
	gHashM­
<
	gObjeù
, 
	gLÚg
> 
	gv”‹xNameToT™ªID
;

56 
´iv©e
 
IÁWr™abË
 
	goutKey
;

57 
´iv©e
 
Prİ”tyG¿phEËm’t
 
	goutV®ue
;

58 
´iv©e
 
CÏss
 
	goutCÏss
;

60 
´iv©e
 
fš®
 
KeyFunùiÚ
 
	gkeyFunùiÚ
 = 
Ãw
 
De¡š©iÚV”‹xKeyFunùiÚ
();

62 
´iv©e
 
	eCouÁ”s
 {

63 
	gNUM_VERTICES
,

64 
	gNUM_EDGES


73 
´Ùeùed
 
T™ªG¿ph
 
G¿phFaùÜyO³n
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
 {

74 
Ba£CÚfigu¿tiÚ
 
	gt™ªCÚfig
 = 
Ãw
 BaseConfiguration();

75  
	gG¿phD©aba£CÚÃùÜ
.
İ’
("t™ª", 
t™ªCÚfig
, 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
());

78 @
Ov”ride


79 
public
 
£tup
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

81 
CÚfigu¿tiÚ
 
	gcÚf
 = 
cÚ‹xt
.
g‘CÚfigu¿tiÚ
();

83 
	goutCÏss
 = 
cÚ‹xt
.
g‘M­OuutV®ueCÏss
();

84 
	goutKey
 = 
Ãw
 
IÁWr™abË
();

86 
	gŒy
 {

87 
	goutV®ue
 = (
Prİ”tyG¿phEËm’t
è
outCÏss
.
ÃwIn¡ªû
();

88 } 
ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

89 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

90 "CªnÙ in¡ªtŸ‹‚ew„eduû¸ouuˆv®uĞ" + 
outCÏss
.
g‘Name
(è+ ")", 
LOG
, 
e
);

91 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

92 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

93 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸ouuˆv®uĞ" + 
outCÏss
.
g‘Name
() + ")",

94 
LOG
, 
e
);

98 
	gthis
.
	gv”‹xNameToT™ªID
 = 
Ãw
 
HashM­
<
Objeù
, 
	gLÚg
>();

100 
	gthis
.
	gg¿ph
 = 
G¿phFaùÜyO³n
(
cÚ‹xt
);

101 
as£¹
 (
nuÎ
 !ğ
this
.
g¿ph
);

103 
	gthis
.
	gnoBiDœ
 = 
cÚf
.
g‘BoŞ—n
("noBiDœ", 
çl£
);

105 
	gŒy
 {

106 ià(
	gcÚf
.
g‘
("edgeReduûrFunùiÚ"è!ğ
nuÎ
) {

107 
this
.
edgeReduûrFunùiÚ
 =

108 (
FunùiÚ®
è
CÏss
.
fÜName
(
cÚf
.
g‘
("edgeReduûrFunùiÚ")).
ÃwIn¡ªû
();

110 
	gthis
.
	gedgeReduûrFunùiÚ
.
cÚfigu»
(
cÚf
);

113 ià(
	gcÚf
.
g‘
("v”‹xReduûrFunùiÚ"è!ğ
nuÎ
) {

114 
this
.
v”‹xReduûrFunùiÚ
 =

115 (
FunùiÚ®
è
CÏss
.
fÜName
(
cÚf
.
g‘
("v”‹xReduûrFunùiÚ")).
ÃwIn¡ªû
();

117 
	gthis
.
	gv”‹xReduûrFunùiÚ
.
cÚfigu»
(
cÚf
);

119 } 
ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 
e
) {

120 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

121 "Could‚Ù in¡ªtŸ‹„eduû¸funùiÚs", 
LOG
, 
e
);

122 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

123 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

124 "IÎeg®‡cûs exû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs", 
LOG
, 
e
);

125 } 
ÿtch
 (
CÏssNÙFoundExû±iÚ
 
e
) {

126 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

127 "CÏs nÙ foundƒxû±iÚ wh’ in¡ªtŸtšg„eduû¸funùiÚs", 
LOG
, 
e
);

128 } 
ÿtch
 (
FunùiÚ®
.
FunùiÚ®CÚfigu¿tiÚE¼Ü
 
e
) {

129 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
CLASS_INSTANTIATION_ERROR
,

130 "FunùiÚ®ƒ¼Ü cÚfiguršg„eduû¸funùiÚ", 
LOG
, 
e
);

134 @
Ov”ride


135 
public
 
»duû
(
IÁWr™abË
 
key
, 
I‹¿bË
<
Prİ”tyG¿phEËm’t
> 
v®ues
, 
CÚ‹xt
 
cÚ‹xt
)

136 
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

138 
	gHashM­
<
	gEdgeID
, 
	gWr™abË
> 
	gedgeS‘
 = 
Ãw
 
HashM­
();

139 
	gHashM­
<
	gObjeù
, 
	gWr™abË
> 
	gv”‹xS‘
 = 
Ãw
 
HashM­
();

140 
	gI‹¿tÜ
<
	gPrİ”tyG¿phEËm’t
> 
	gv®ueI‹¿tÜ
 = 
v®ues
.
™”©Ü
();

142 
	gv®ueI‹¿tÜ
.
hasNext
()) {

144 
Prİ”tyG¿phEËm’t
 
	gÃxt
 = 
v®ueI‹¿tÜ
.
Ãxt
();

148 ià(
	gÃxt
.
g¿phEËm’tTy³
(è=ğ
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
) {

150 
Objeù
 
vid
 = 
Ãxt
.
v”‹x
().
g‘V”‹xId
();

152 ià(
	gv”‹xS‘
.
cÚšsKey
(
vid
)) {

156 ià(
	gv”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

157 
v”‹xS‘
.
put
(
vid
,

158 
v”‹xReduûrFunùiÚ
.
»duû
(
Ãxt
.
v”‹x
().
g‘Prİ”t›s
(),

159 
v”‹xS‘
.
g‘
(
vid
)));

167 
Prİ”tyM­
 
	gexi¡šgPrİ”tyM­
 = (Prİ”tyM­è
v”‹xS‘
.
g‘
(
vid
);

168 
	gexi¡šgPrİ”tyM­
.
m”gePrİ”t›s
(
Ãxt
.
v”‹x
().
g‘Prİ”t›s
());

174 ià(
	gv”‹xReduûrFunùiÚ
 !ğ
nuÎ
) {

175 
v”‹xS‘
.
put
(
vid
,

176 
v”‹xReduûrFunùiÚ
.
»duû
(
Ãxt
.
v”‹x
().
g‘Prİ”t›s
(),

177 
v”‹xReduûrFunùiÚ
.
id’t™yV®ue
()));

179 
	gv”‹xS‘
.
put
(
vid
, 
Ãxt
.
v”‹x
().
g‘Prİ”t›s
());

187 
	gEdge
<?> 
	gedge
 = 
Ãxt
.
edge
();

188 
EdgeID
 
	gedgeID
 = 
Ãw
 EdgeID(
edge
.
g‘Src
(),ƒdge.
g‘D¡
(),ƒdge.
g‘EdgeLab–
());

190 ià(
	gedge
.
isS–fEdge
()) {

195 ià(
	gedgeS‘
.
cÚšsKey
(
edgeID
)) {

199 ià(
	gedgeReduûrFunùiÚ
 !ğ
nuÎ
) {

200 
edgeS‘
.
put
(
edgeID
, 
edgeReduûrFunùiÚ
.
»duû
(
edge
.
g‘Prİ”t›s
(),ƒdgeS‘.
g‘
(edgeID)));

208 
Prİ”tyM­
 
	gexi¡šgPrİ”tyM­
 = (Prİ”tyM­è
edgeS‘
.
g‘
(
edgeID
);

209 
	gexi¡šgPrİ”tyM­
.
m”gePrİ”t›s
(
edge
.
g‘Prİ”t›s
());

215 ià(
	gnoBiDœ
 && 
	gedgeS‘
.
cÚšsKey
(
edgeID
.
»v”£Edge
())) {

221 ià(
	gedgeReduûrFunùiÚ
 !ğ
nuÎ
) {

222 
edgeS‘
.
put
(
edgeID
,

223 
edgeReduûrFunùiÚ
.
»duû
(
edge
.
g‘Prİ”t›s
(),

224 
edgeReduûrFunùiÚ
.
id’t™yV®ue
()));

226 
	gedgeS‘
.
put
(
edgeID
, 
edge
.
g‘Prİ”t›s
());

233 
	gv”‹xCouÁ
 = 0;

234 
	gedgeCouÁ
 = 0;

238 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gObjeù
, 
	gWr™abË
>> 
	gv”‹xI‹¿tÜ
 = 
v”‹xS‘
.
’ŒyS‘
().
™”©Ü
();

241 
	gv”‹xI‹¿tÜ
.
hasNext
()) {

243 
	gM­
.
EÁry
 
	gv
 = 
v”‹xI‹¿tÜ
.
Ãxt
();

247 
	gcom
.
	gtšk”pİ
.
	gblu•ršts
.
V”‹x
 
	gbpV”‹x
 = 
g¿ph
.
addV”‹x
(
nuÎ
);

249 
	gbpV”‹x
.
£tPrİ”ty
("ŒueName", 
v
.
g‘Key
().
toSŒšg
());

251 
Prİ”tyM­
 
	g´İ”tyM­
 = (Prİ”tyM­è
v
.
g‘V®ue
();

253 
Wr™abË
 
	gkeyName
 : 
´İ”tyM­
.
g‘Prİ”tyKeys
()) {

254 
EnÿpsuÏ‹dObjeù
 
m­EÁry
 = (EnÿpsuÏ‹dObjeùè
´İ”tyM­
.
g‘Prİ”ty
(
keyName
.
toSŒšg
());

256 
	gbpV”‹x
.
£tPrİ”ty
(
keyName
.
toSŒšg
(), 
m­EÁry
.
g‘Ba£Objeù
());

259 
	gv”‹xId
 = ((
T™ªEËm’t
è
bpV”‹x
).
g‘ID
();

261 
V”‹x
 
	gv”‹x
 = 
Ãw
 Vertex();

262 
	g´İ”tyM­
.
£tPrİ”ty
("T™ªID", 
Ãw
 
LÚgTy³
(
v”‹xId
));

263 
	gv”‹x
.
cÚfigu»
((
Wr™abËCom·¿bË
è
v
.
g‘Key
(), 
´İ”tyM­
);

265 
	goutV®ue
.
š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
, 
v”‹x
);

266 
	goutKey
.
£t
(
keyFunùiÚ
.
g‘V”‹xKey
(
v”‹x
));

268 
	gcÚ‹xt
.
wr™e
(
outKey
, 
outV®ue
);

270 
	gv”‹xNameToT™ªID
.
put
(
v
.
g‘Key
(), 
v”‹xId
);

272 
	gv”‹xCouÁ
++;

275 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_VERTICES
).
šüem’t
(
v”‹xCouÁ
);

279 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<
	gEdgeID
, 
	gWr™abË
>> 
	gedgeI‹¿tÜ
 = 
edgeS‘
.
’ŒyS‘
().
™”©Ü
();

282 
	gedgeI‹¿tÜ
.
hasNext
()) {

284 
	gM­
.
	gEÁry
<
	gEdgeID
, 
	gWr™abË
> 
	ge
 = 
edgeI‹¿tÜ
.
Ãxt
();

286 
Objeù
 
	g¤c
 = 
e
.
g‘Key
().
g‘Src
();

287 
Objeù
 
	gd¡
 = 
e
.
g‘Key
().
g‘D¡
();

288 
SŒšg
 
	gÏb–
 = 
e
.
g‘Key
().
g‘Lab–
().
toSŒšg
();

290 
Prİ”tyM­
 
	g´İ”tyM­
 = (Prİ”tyM­è
e
.
g‘V®ue
();

292 
	g¤cT™ªId
 = 
v”‹xNameToT™ªID
.
g‘
(
¤c
);

294 
Edge
 
	gedge
 = 
Ãw
 Edge();

296 
	g´İ”tyM­
.
£tPrİ”ty
("¤cT™ªID", 
Ãw
 
LÚgTy³
(
¤cT™ªId
));

298 
	gedge
.
cÚfigu»
((
Wr™abËCom·¿bË
è
¤c
, (Wr™abËCom·¿bËè
d¡
, 
Ãw
 
SŒšgTy³
(
Ïb–
), 
´İ”tyM­
);

300 
	goutV®ue
.
š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
EDGE
, 
edge
);

301 
	goutKey
.
£t
(
keyFunùiÚ
.
g‘EdgeKey
(
edge
));

303 
	gcÚ‹xt
.
wr™e
(
outKey
, 
outV®ue
);

305 
	gedgeCouÁ
++;

308 
	gcÚ‹xt
.
g‘CouÁ”
(
CouÁ”s
.
NUM_EDGES
).
šüem’t
(
edgeCouÁ
);

311 @
Ov”ride


312 
public
 
ş—nup
(
CÚ‹xt
 
cÚ‹xt
è
throws
 
	gIOExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
 {

313 
	gthis
.
	gg¿ph
.
shutdown
();

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/DestinationVertexKeyFunction.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

30 
public
 cÏs 
	cDe¡š©iÚV”‹xKeyFunùiÚ
 
im¶em’ts
 
	mKeyFunùiÚ
 {

38 
public
 
	$g‘EdgeKey
(
Edge
 
edge
) {

39  
edge
.
	`g‘D¡
().
	`hashCode
();

48 
public
 
	$g‘V”‹xKey
(
V”‹x
 
v”‹x
) {

49  
v”‹x
.
	`g‘V”‹xId
().
	`hashCode
();

50 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/ElementIdKeyFunction.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

31 
public
 cÏs 
	cEËm’tIdKeyFunùiÚ
 
im¶em’ts
 
	mKeyFunùiÚ
 {

39 
public
 
	$g‘EdgeKey
(
Edge
 
edge
) {

40  
edge
.
	`g‘EdgeID
().
	`hashCode
();

49 
public
 
	$g‘V”‹xKey
(
V”‹x
 
v”‹x
) {

50  
v”‹x
.
	`g‘V”‹xId
().
	`hashCode
();

51 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/KeyFunction.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

25 
public
 
š‹rçû
 
	gKeyFunùiÚ
 {

27 
public
 
g‘EdgeKey
(
Edge
 
edge
);

28 
public
 
g‘V”‹xKey
(
V”‹x
 
v”‹x
);

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/SourceVertexKeyFunction.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

30 
public
 cÏs 
	cSourûV”‹xKeyFunùiÚ
 
im¶em’ts
 
	mKeyFunùiÚ
 {

38 
public
 
	$g‘EdgeKey
(
Edge
 
edge
) {

39  
edge
.
	`g‘Src
().
	`hashCode
();

49 
public
 
	$g‘V”‹xKey
(
V”‹x
 
v”‹x
) {

50  
v”‹x
.
	`g‘V”‹xId
().
	`hashCode
();

51 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/EdgeSchema.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

30 
public
 cÏs 
	cEdgeSchema
 {

32 
´iv©e
 
	mA¼ayLi¡
<
	mPrİ”tySchema
> 
	m´İ”tySchem©a
;

34 
´iv©e
 
SŒšg
 
	mÏb–
;

36 
´iv©e
 
	$EdgeSchema
() {

37 
Ïb–
 = 
nuÎ
;

38 
´İ”tySchem©a
 = 
Ãw
 
A¼ayLi¡
<
Prİ”tySchema
>();

41 
public
 
	$EdgeSchema
(
SŒšg
 
Ïb–
) {

42 
this
.
Ïb–
 =†abel;

43 
´İ”tySchem©a
 = 
Ãw
 
A¼ayLi¡
<
Prİ”tySchema
>();

44 
	}
}

45 
public
 
	$£tLab–
(
SŒšg
 
Ïb–
) {

46 
this
.
Ïb–
 =†abel;

47 
	}
}

49 
public
 
SŒšg
 
	$g‘Lab–
() {

50  
this
.
Ïb–
;

51 
	}
}

52 
public
 
	gA¼ayLi¡
<
	gPrİ”tySchema
> 
	$g‘Prİ”tySchem©a
() {

53  
´İ”tySchem©a
;

54 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertyGraphSchema.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

31 
public
 cÏs 
	cPrİ”tyG¿phSchema
 {

33 
´iv©e
 
	mA¼ayLi¡
<
	mV”‹xSchema
> 
	mv”‹xSchem©a
;

34 
´iv©e
 
	mA¼ayLi¡
<
	mEdgeSchema
> 
	medgeSchem©a
;

36 
public
 
	$Prİ”tyG¿phSchema
() {

37 
v”‹xSchem©a
 = 
Ãw
 
A¼ayLi¡
<
V”‹xSchema
>();

38 
edgeSchem©a
 = 
Ãw
 
A¼ayLi¡
<
EdgeSchema
>();

41 
public
 
	$addV”‹xSchema
(
V”‹xSchema
 
v”‹xSchema
) {

42 
v”‹xSchem©a
.
	`add
(
v”‹xSchema
);

43 
	}
}

45 
public
 
	gA¼ayLi¡
<
	gV”‹xSchema
> 
	$g‘V”‹xSchem©a
() {

46  
v”‹xSchem©a
;

47 
	}
}

49 
public
 
	$addEdgeSchema
(
EdgeSchema
 
edgeSchema
) {

50 
edgeSchem©a
.
	`add
(
edgeSchema
);

51 
	}
}

53 
public
 
	gA¼ayLi¡
<
	gEdgeSchema
> 
	$g‘EdgeSchem©a
() {

54  
edgeSchem©a
;

55 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertySchema.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

27 
public
 cÏs 
	cPrİ”tySchema
 {

29 
´iv©e
 
SŒšg
 
	mÇme
;

31 
´iv©e
 
	mCÏss
<?> 
	mty³
;

33 
´iv©e
 
	$Prİ”tySchema
() {

34 
this
.
Çme
 = 
nuÎ
;

35 
this
.
ty³
 = 
nuÎ
;

38 
public
 
	`Prİ”tySchema
(
SŒšg
 
Çme
, 
CÏss
<?> 
ty³
) {

39 
this
.
Çme
 =‚ame;

40 
this
.
ty³
 =ype;

41 
	}
}

43 
public
 
	$£tName
(
SŒšg
 
Çme
) {

44 
this
.
Çme
 =‚ame;

45 
	}
}

47 
public
 
SŒšg
 
	$g‘Name
() {

48  
this
.
Çme
;

49 
	}
}

51 
public
 
£tTy³
(
CÏss
<?> 
ty³
) {

52 
	gthis
.
	gty³
 = 
ty³
;

55 
public
 
	gCÏss
<?> 
	$g‘Ty³
() {

56  
this
.
ty³
;

57 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/VertexSchema.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

31 
public
 cÏs 
	cV”‹xSchema
 {

33 
´iv©e
 
	mA¼ayLi¡
<
	mPrİ”tySchema
> 
	m´İ”tySchem©a
;

35 
public
 
	$V”‹xSchema
() {

36 
´İ”tySchem©a
 = 
Ãw
 
A¼ayLi¡
<
Prİ”tySchema
>();

39 
public
 
A¼ayLi¡
<
Prİ”tySchema
> 
	$g‘Prİ”tySchem©a
() {

40  
´İ”tySchem©a
;

41 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/GraphBuildingRule.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tyG¿phSchema
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

42 
public
 
š‹rçû
 
	gG¿phBudšgRuË
 {

53 
public
 
upd©eCÚfigu¿tiÚFÜTok’iz”
 (
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
CommªdLše
 
cmd
);

65 
public
 
Prİ”tyG¿phSchema
 
g‘G¿phSchema
();

73 
public
 
	gCÏss
<? 
ex‹nds
 
	gG¿phTok’iz”
> 
g‘G¿phTok’iz”CÏss
();

79 
public
 
CÏss
 
vidCÏss
();

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/GraphTokenizer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
;

22 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

41 
public
 
š‹rçû
 
	gG¿phTok’iz”
<
	gRecÜdTy³
, 
VidTy³
 
ex‹nds
 
	gWr™abËCom·¿bË
<
	gVidTy³
>> {

47 
cÚfigu»
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
);

56 
·r£
(
RecÜdTy³
 
»cÜd
, 
M­³r
.
CÚ‹xt
 
cÚ‹xt
);

61 
	gI‹¿tÜ
<
	gV”‹x
<
	gVidTy³
>> 
g‘V”tiûs
();

66 
	gI‹¿tÜ
<
	gEdge
<
	gVidTy³
>> 
g‘Edges
();

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/RecordTypeHBaseRow.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gio
.
	gImmubËBy‹sWr™abË
;

35 
public
 cÏs 
	cRecÜdTy³HBa£Row
 {

37 
´iv©e
 
ImmubËBy‹sWr™abË
 
	mrow
;

38 
´iv©e
 
ResuÉ
 
	mcŞumns
;

45 
public
 
	$RecÜdTy³HBa£Row
(
ImmubËBy‹sWr™abË
 
row
, 
ResuÉ
 
cŞumns
) {

46 
this
.
row
 =„ow;

47 
this
.
cŞumns
 = columns;

50 
public
 
	$£tRow
(
ImmubËBy‹sWr™abË
 
row
) {

51 
this
.
row
 =„ow;

52 
	}
}

54 
public
 
ImmubËBy‹sWr™abË
 
	$g‘Row
() {

55  
this
.
row
;

56 
	}
}

58 
public
 
	$£tCŞumns
(
ResuÉ
 
cŞumns
) {

59 
this
.
cŞumns
 = columns;

60 
	}
}

62 
public
 
ResuÉ
 
	$g‘CŞumns
() {

63  
this
.
cŞumns
;

64 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/hbase/HBaseGraphBuildingRule.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gGBHTabËCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gEdgeSchema
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tyG¿phSchema
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tySchema
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gV”‹xSchema
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gHBa£Uts
;

32 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

37 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

38 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

39 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

90 
public
 cÏs 
	cHBa£G¿phBudšgRuË
 
im¶em’ts
 
	mG¿phBudšgRuË
 {

92 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
HBa£G¿phBudšgRuË
.
şass
);

94 
´iv©e
 
Prİ”tyG¿phSchema
 
	mg¿phSchema
;

95 
´iv©e
 
HBa£Uts
 
	mhBa£Uts
;

96 
´iv©e
 
SŒšg
 
	m¤cTabËName
;

97 
´iv©e
 
	mSŒšg
[] 
	mv”‹xRuËs
;

98 
´iv©e
 
	mSŒšg
[] 
	medgeRuËs
;

99 
´iv©e
 
	mSŒšg
[] 
	mdœeùedEdgeRuËs
;

101 
´iv©e
 
CÏss
 
	mvidCÏss
 = 
SŒšgTy³
.
şass
;

102 
´iv©e
 
	mCÏss
<? 
ex‹nds
 
	mG¿phTok’iz”
> 
	mtok’iz”CÏss
 = 
HBa£Tok’iz”
.
şass
;

112 
public
 
	$HBa£G¿phBudšgRuË
(
CommªdLše
 
cmd
) {

114 
this
.
g¿phSchema
 = 
Ãw
 
	`Prİ”tyG¿phSchema
();

115 
Œy
 {

116 
this
.
hBa£Uts
 = 
HBa£Uts
.
	`g‘In¡ªû
();

117 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

118 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_CONNECT_TO_HBASE
,

119 "CªnÙ‡Îoÿ‹hHBa£Ut objeù. Check hba£ cÚÃùiÚ.", 
LOG
, 
e
);

122 
this
.
¤cTabËName
 = 
cmd
.
	`g‘O±iÚV®ue
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_TABLE_OPTNAME"));

124 
this
.
v”‹xRuËs
 =

125 
	`nuÎsIÁoEm±ySŒšgA¼ays
(
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_VERTICES_OPTNAME")));

127 
this
.
edgeRuËs
 =

128 
	`nuÎsIÁoEm±ySŒšgA¼ays
(
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_EDGES_OPTNAME")));

130 
this
.
dœeùedEdgeRuËs
 =

131 
	`nuÎsIÁoEm±ySŒšgA¼ays
(
cmd
.
	`g‘O±iÚV®ues
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("CMD_DIRECTED_EDGES_OPTNAME")));

133 
	`checkSyÁaxOfV”‹xRuËs
();

134 
	`checkSyÁaxOfEdgeRuËs
();

136 
	`v®id©eV”‹xRuËCŞumnFam›s
();

137 
	`v®id©eEdgeRuËCŞumnFam›s
();

139 
	`g’”©eEdgeSchem©a
();

140 
	`g’”©eV”‹xSchem©a
();

146 
´iv©e
 
SŒšg
[] 
	$nuÎsIÁoEm±ySŒšgA¼ays
(
SŒšg
[] 
š
) {

147 ià(
š
 =ğ
nuÎ
) {

148  
Ãw
 
SŒšg
[0];

150  
š
;

152 
	}
}

159 
´iv©e
 
	$checkSyÁaxOfV”‹xRuËs
() {

161 
	}
}

168 
´iv©e
 
	$checkSyÁaxOfEdgeRuËs
() {

171 
SŒšg
 
edgeRuË
 : 
edgeRuËs
) {

172 ià(
edgeRuË
.
	`¥l™
("\\,").
Ëngth
 < 3) {

173 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

175 + 
edgeRuË
, 
LOG
);

179 
SŒšg
 
dœeùedEdgeRuË
 : 
dœeùedEdgeRuËs
) {

180 ià(
dœeùedEdgeRuË
.
	`¥l™
("\\,").
Ëngth
 < 3) {

181 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

183 + 
dœeùedEdgeRuË
, 
LOG
);

186 
	}
}

196 
´iv©e
 
boŞ—n
 
	$v®id©eV”‹xRuËCŞumnFam›s
() {

198 
boŞ—n
 
»tuºV®ue
 = 
Œue
;

200 
SŒšg
 
v”‹xRuË
 : 
v”‹xRuËs
) {

202 
SŒšg
 
vidCŞumn
 = 
HBa£G¿phBudšgRuË
.
	`g‘VidCŞNameFromV”‹xRuË
(
v”‹xRuË
);

204 
»tuºV®ue
 &ğ
hBa£Uts
.
	`cŞumnHasV®idFamy
(
vidCŞumn
, 
¤cTabËName
);

206 ià(
»tuºV®ue
 =ğ
çl£
) {

207 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

208 "GRAPHBUILDER FAILURE: " + 
vidCŞumn
 + " does‚ot belongo‡ valid column family ofable "

209 + 
¤cTabËName
, 
LOG
);

212 
SŒšg
[] 
v”‹xPrİ”t›sCŞumnNames
 =

213 
HBa£G¿phBudšgRuË
.
	`g‘V”‹xPrİ”tyCŞumnsFromV”‹xRuË
(
v”‹xRuË
);

215 
SŒšg
 
cŞumnName
 : 
v”‹xPrİ”t›sCŞumnNames
) {

216 
»tuºV®ue
 &ğ
hBa£Uts
.
	`cŞumnHasV®idFamy
(
cŞumnName
, 
¤cTabËName
);

217 ià(
»tuºV®ue
 =ğ
çl£
) {

218 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

219 "GRAPHBUILDER FAILURE: " + 
cŞumnName
 + " does‚ot belongo‡ valid column family ofable "

220 + 
¤cTabËName
, 
LOG
);

225  
»tuºV®ue
;

226 
	}
}

237 
´iv©e
 
boŞ—n
 
	$v®id©eEdgeRuËCŞumnFam›s
() {

239 
boŞ—n
 
»tuºV®ue
 = 
Œue
;

241 
SŒšg
 
edgeRuË
 : 
edgeRuËs
) {

243 
SŒšg
 
¤cV”‹xCŞName
 = 
HBa£G¿phBudšgRuË
.
	`g‘SrcCŞNameFromEdgeRuË
(
edgeRuË
);

244 
SŒšg
 
tgtV”‹xCŞName
 = 
HBa£G¿phBudšgRuË
.
	`g‘D¡CŞNameFromEdgeRuË
(
edgeRuË
);

246 
Li¡
<
SŒšg
> 
´İ”tyCŞNames
 = 
HBa£G¿phBudšgRuË
.
	`g‘EdgePrİ”tyCŞumnNamesFromEdgeRuË
(
edgeRuË
);

248 
»tuºV®ue
 &ğ
hBa£Uts
.
	`cŞumnHasV®idFamy
(
¤cV”‹xCŞName
, 
¤cTabËName
);

249 ià(
»tuºV®ue
 =ğ
çl£
) {

250 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

251 "GRAPHBUILDER FAILURE: " + 
¤cV”‹xCŞName
 + " does‚ot belongo‡ valid column family ofable "

252 + 
¤cTabËName
, 
LOG
);

255 
»tuºV®ue
 &ğ
hBa£Uts
.
	`cŞumnHasV®idFamy
(
tgtV”‹xCŞName
, 
¤cTabËName
);

256 ià(
»tuºV®ue
 =ğ
çl£
) {

257 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

258 "GRAPHBUILDER FAILURE: " + 
tgtV”‹xCŞName
 + " does‚ot belongo‡ valid column family ofable "

259 + 
¤cTabËName
, 
LOG
);

262 
SŒšg
 
´İ”tyCŞName
 : 
´İ”tyCŞNames
) {

263 
»tuºV®ue
 &ğ
hBa£Uts
.
	`cŞumnHasV®idFamy
(
´İ”tyCŞName
, 
¤cTabËName
);

264 ià(
»tuºV®ue
 =ğ
çl£
) {

265 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

266 "GRAPHBUILDER FAILURE: " + 
´İ”tyCŞName
 + " does‚ot belongo‡ valid column family ofable "

267 + 
¤cTabËName
, 
LOG
);

272  
»tuºV®ue
;

273 
	}
}

282 
public
 
	$upd©eCÚfigu¿tiÚFÜTok’iz”
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
CommªdLše
 
cmd
) {

283 
	`·ckV”‹xRuËsIÁoCÚfigu¿tiÚ
(
cÚfigu¿tiÚ
, 
v”‹xRuËs
);

284 
	`·ckEdgeRuËsIÁoCÚfigu¿tiÚ
(
cÚfigu¿tiÚ
, 
edgeRuËs
);

285 
	`·ckDœeùedEdgeRuËsIÁoCÚfigu¿tiÚ
(
cÚfigu¿tiÚ
, 
dœeùedEdgeRuËs
);

286 
	}
}

294 
public
 
	gCÏss
<? 
ex‹nds
 
	gG¿phTok’iz”
> 
	$g‘G¿phTok’iz”CÏss
() {

295  
this
.
tok’iz”CÏss
;

296 
	}
}

303 
public
 
CÏss
 
	$vidCÏss
() {

304  
this
.
vidCÏss
;

305 
	}
}

313 
public
 
Prİ”tyG¿phSchema
 
	$g‘G¿phSchema
() {

314  
g¿phSchema
;

315 
	}
}

317 
´iv©e
 
	$g’”©eV”‹xSchem©a
() {

319 
SŒšg
 
v”‹xRuË
 : 
v”‹xRuËs
) {

321 
V”‹xSchema
 
v”‹xSchema
 = 
Ãw
 
	`V”‹xSchema
();

323 
SŒšg
[] 
cŞumnNames
 = 
HBa£G¿phBudšgRuË
.
	`g‘V”‹xPrİ”tyCŞumnsFromV”‹xRuË
(
v”‹xRuË
);

325 
SŒšg
 
v”‹xPrİ”tyCŞumnName
 : 
cŞumnNames
) {

326 
Prİ”tySchema
 
´İ”tySchema
 = 
Ãw
 
	`Prİ”tySchema
(
v”‹xPrİ”tyCŞumnName
, 
SŒšg
.
şass
);

327 
v”‹xSchema
.
	`g‘Prİ”tySchem©a
().
	`add
(
´İ”tySchema
);

330 
g¿phSchema
.
	`addV”‹xSchema
(
v”‹xSchema
);

332 
	}
}

334 
´iv©e
 
	$g’”©eEdgeSchem©a
() {

336 
SŒšg
 
edgeRuË
 : 
edgeRuËs
) {

338 
Li¡
<
SŒšg
> 
cŞumnNames
 = 
HBa£G¿phBudšgRuË
.
	`g‘EdgePrİ”tyCŞumnNamesFromEdgeRuË
(
edgeRuË
);

339 
SŒšg
 
Ïb–
 = 
HBa£G¿phBudšgRuË
.
	`g‘Lab–FromEdgeRuË
(
edgeRuË
);

341 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
(
Ïb–
);

343 
SŒšg
 
cŞumnName
 : 
cŞumnNames
) {

344 
SŒšg
 
edgePrİ”tyName
 = 
cŞumnName
.
	`»¶aûAÎ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("HBASE_COLUMN_SEPARATOR"),

345 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("GRAPH_PROPERTY_SEPARATOR"));

346 
Prİ”tySchema
 
´İ”tySchema
 = 
Ãw
 
	`Prİ”tySchema
(
edgePrİ”tyName
, 
SŒšg
.
şass
);

347 
edgeSchema
.
	`g‘Prİ”tySchem©a
().
	`add
(
´İ”tySchema
);

350 
g¿phSchema
.
	`addEdgeSchema
(
edgeSchema
);

353 
SŒšg
 
dœeùedEdgeRuË
 : 
dœeùedEdgeRuËs
) {

355 
Li¡
<
SŒšg
> 
cŞumnNames
 = 
HBa£G¿phBudšgRuË
.
	`g‘EdgePrİ”tyCŞumnNamesFromEdgeRuË
(
dœeùedEdgeRuË
);

356 
SŒšg
 
Ïb–
 = 
HBa£G¿phBudšgRuË
.
	`g‘Lab–FromEdgeRuË
(
dœeùedEdgeRuË
);

358 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
(
Ïb–
);

360 
SŒšg
 
cŞumnName
 : 
cŞumnNames
) {

361 
SŒšg
 
edgePrİ”tyName
 = 
cŞumnName
.
	`»¶aûAÎ
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("HBASE_COLUMN_SEPARATOR"),

362 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("GRAPH_PROPERTY_SEPARATOR"));

363 
Prİ”tySchema
 
´İ”tySchema
 = 
Ãw
 
	`Prİ”tySchema
(
edgePrİ”tyName
, 
SŒšg
.
şass
);

364 
edgeSchema
.
	`g‘Prİ”tySchem©a
().
	`add
(
´İ”tySchema
);

367 
g¿phSchema
.
	`addEdgeSchema
(
edgeSchema
);

369 
	}
}

371 
public
 
	$·ckV”‹xRuËsIÁoCÚfigu¿tiÚ
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
SŒšg
[] 
v”‹xRuËs
) {

373 
SŒšg
 
£·¿tÜ
 = 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("COL_NAME_SEPARATOR");

374 
SŒšgBufãr
 
bufãr
 = 
Ãw
 
	`SŒšgBufãr
();

376 
bufãr
.
	`­³nd
(
v”‹xRuËs
[0]);

378 
i
 = 1; i < 
v”‹xRuËs
.
Ëngth
; i++) {

379 
bufãr
.
	`­³nd
(
£·¿tÜ
);

380 
bufãr
.
	`­³nd
(
v”‹xRuËs
[
i
]);

383 
cÚfigu¿tiÚ
.
	`£t
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("VCN_CONF_NAME"), 
bufãr
.
	`toSŒšg
());

384 
	}
}

395 
public
 
	gSŒšg
[] 
	$uÅackV”‹xRuËsFromCÚfigu¿tiÚ
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
) {

396 
SŒšg
 
£·¿tÜs
 = "\\" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("COL_NAME_SEPARATOR");

397 
SŒšg
[] 
v”‹xRuËs
 = 
cÚfigu¿tiÚ
.
	`g‘
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("VCN_CONF_NAME")).
	`¥l™
(
£·¿tÜs
);

399  
v”‹xRuËs
;

400 
	}
}

402 
public
 
	$·ckEdgeRuËsIÁoCÚfigu¿tiÚ
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
SŒšg
[] 
edgeRuËs
) {

403 
SŒšg
 
£·¿tÜ
 = 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("COL_NAME_SEPARATOR");

404 
SŒšgBufãr
 
edgeRuËBufãr
 = 
Ãw
 
	`SŒšgBufãr
();

406 ià(
edgeRuËs
.
Ëngth
 > 0) {

408 
edgeRuËBufãr
.
	`­³nd
(
edgeRuËs
[0]);

410 
i
 = 1; i < 
edgeRuËs
.
Ëngth
; i++) {

411 
edgeRuËBufãr
.
	`­³nd
(
£·¿tÜ
);

412 
edgeRuËBufãr
.
	`­³nd
(
edgeRuËs
[
i
]);

415 
cÚfigu¿tiÚ
.
	`£t
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("ECN_CONF_NAME"), 
edgeRuËBufãr
.
	`toSŒšg
());

416 
	}
}

418 
public
 
	$·ckDœeùedEdgeRuËsIÁoCÚfigu¿tiÚ
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
, 
SŒšg
[] 
dœeùedEdgeRuËs
) {

420 
SŒšg
 
£·¿tÜ
 = 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("COL_NAME_SEPARATOR");

421 
SŒšgBufãr
 
dœeùedEdgeRuËBufãr
 = 
Ãw
 
	`SŒšgBufãr
();

423 ià(
dœeùedEdgeRuËs
.
Ëngth
 > 0) {

425 
dœeùedEdgeRuËBufãr
.
	`­³nd
(
dœeùedEdgeRuËs
[0]);

427 
i
 = 1; i < 
dœeùedEdgeRuËs
.
Ëngth
; i++) {

428 
dœeùedEdgeRuËBufãr
.
	`­³nd
(
£·¿tÜ
);

429 
dœeùedEdgeRuËBufãr
.
	`­³nd
(
dœeùedEdgeRuËs
[
i
]);

433 
cÚfigu¿tiÚ
.
	`£t
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("DECN_CONF_NAME"), 
dœeùedEdgeRuËBufãr
.
	`toSŒšg
());

434 
	}
}

447 
public
 
	gSŒšg
[] 
	$uÅackEdgeRuËsFromCÚfigu¿tiÚ
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
) {

448 
SŒšg
 
£·¿tÜ
 = "\\" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("COL_NAME_SEPARATOR");

450 
SŒšg
 
·ckedEdgeRuËs
 = 
cÚfigu¿tiÚ
.
	`g‘
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("ECN_CONF_NAME"));

452 
SŒšg
[] 
edgeRuËs
 = 
nuÎ
;

454 ià(
·ckedEdgeRuËs
 =ğ
nuÎ
 ||…ackedEdgeRuËs.
	`Ëngth
() == 0) {

455 
edgeRuËs
 = 
Ãw
 
SŒšg
[0];

457 
edgeRuËs
 = 
·ckedEdgeRuËs
.
	`¥l™
(
£·¿tÜ
);

460  
edgeRuËs
;

461 
	}
}

473 
public
 
	gSŒšg
[] 
	$uÅackDœeùedEdgeRuËsFromCÚfigu¿tiÚ
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
) {

474 
SŒšg
 
£·¿tÜ
 = "\\" + 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("COL_NAME_SEPARATOR");

476 
SŒšg
 
·ckedDœeùedEdgeRuËs
 = 
cÚfigu¿tiÚ
.
	`g‘
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("DECN_CONF_NAME"));

478 
SŒšg
[] 
dœeùedEdgeRuËs
 = 
nuÎ
;

480 ià(
·ckedDœeùedEdgeRuËs
 =ğ
nuÎ
 ||…ackedDœeùedEdgeRuËs.
	`Ëngth
() == 0) {

481 
dœeùedEdgeRuËs
 = 
Ãw
 
SŒšg
[0];

483 
dœeùedEdgeRuËs
 = 
·ckedDœeùedEdgeRuËs
.
	`¥l™
(
£·¿tÜ
);

486  
dœeùedEdgeRuËs
;

487 
	}
}

496 
public
 
SŒšg
 
	$g‘VidCŞNameFromV”‹xRuË
(
SŒšg
 
v”‹xRuË
) {

498 
SŒšg
[] 
cŞumnNames
 = 
v”‹xRuË
.
	`¥l™
("\\=");

499 
SŒšg
 
v”‹xIdCŞumnName
 = 
cŞumnNames
[0];

501  
v”‹xIdCŞumnName
;

502 
	}
}

511 
public
 
	gSŒšg
[] 
	$g‘V”‹xPrİ”tyCŞumnsFromV”‹xRuË
(
SŒšg
 
v”‹xRuË
) {

512 
SŒšg
[] 
v”‹xPrİ”tyCŞumns
 = 
nuÎ
;

514 ià(
v”‹xRuË
.
	`cÚšs
("=")) {

515 
SŒšg
[] 
cŞumnNames
 = 
v”‹xRuË
.
	`¥l™
("\\=");

516 
v”‹xPrİ”tyCŞumns
 = 
cŞumnNames
[1].
	`¥l™
("\\,");

518 
v”‹xPrİ”tyCŞumns
 = 
Ãw
 
SŒšg
[0];

521  
v”‹xPrİ”tyCŞumns
;

522 
	}
}

534 
public
 
SŒšg
 
	$g‘SrcCŞNameFromEdgeRuË
(
SŒšg
 
edgeRuË
) {

535 
SŒšg
[] 
cŞumnNames
 = 
edgeRuË
.
	`¥l™
("\\,");

536 
SŒšg
 
¤cV”‹xCŞName
 = 
cŞumnNames
[0];

538  
¤cV”‹xCŞName
;

539 
	}
}

550 
public
 
SŒšg
 
	$g‘D¡CŞNameFromEdgeRuË
(
SŒšg
 
edgeRuË
) {

551 
SŒšg
[] 
cŞumnNames
 = 
edgeRuË
.
	`¥l™
("\\,");

552 
SŒšg
 
d¡V”‹xCŞName
 = 
cŞumnNames
[1];

553  
d¡V”‹xCŞName
;

554 
	}
}

566 
public
 
SŒšg
 
	$g‘Lab–FromEdgeRuË
(
SŒšg
 
edgeRuË
) {

567 
SŒšg
[] 
cŞumnNames
 = 
edgeRuË
.
	`¥l™
("\\,");

568 
SŒšg
 
Ïb–
 = 
cŞumnNames
[2];

569  
Ïb–
;

570 
	}
}

582 
public
 
	gA¼ayLi¡
<
	gSŒšg
> 
	$g‘EdgePrİ”tyCŞumnNamesFromEdgeRuË
(
SŒšg
 
edgeRuË
) {

584 
SŒšg
[] 
cŞumnNames
 = 
edgeRuË
.
	`¥l™
("\\,");

586 
A¼ayLi¡
<
SŒšg
> 
edgePrİ”tyCŞumnNames
 = 
Ãw
 ArrayList<String>();

588 ià(
cŞumnNames
.
Ëngth
 >= 3) {

589 
i
 = 3; i < 
cŞumnNames
.
Ëngth
; i++) {

590 
edgePrİ”tyCŞumnNames
.
	`add
(
cŞumnNames
[
i
]);

594  
edgePrİ”tyCŞumnNames
;

595 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/hbase/HBaseTokenizer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gGBHTabËCÚfigu¿tiÚ
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gRecÜdTy³HBa£Row
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gHBa£Uts
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gio
.
	gImmubËBy‹sWr™abË
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

36 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

37 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

38 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

39 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

50 
public
 
şass
 
HBa£Tok’iz”
 
im¶em’ts
 
	gG¿phTok’iz”
<
	gRecÜdTy³HBa£Row
, 
	gSŒšgTy³
> {

52 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
HBa£Tok’iz”
.
şass
);

54 
´iv©e
 
	gLi¡
<
	gSŒšg
> 
	gv”‹xIdCŞumnLi¡
;

55 
´iv©e
 
	gHashM­
<
	gSŒšg
, SŒšg[]> 
	gv”‹xPrİCŞM­
;

56 
´iv©e
 
	gA¼ayLi¡
<
	gV”‹x
<
	gSŒšgTy³
>> 
	gv”‹xLi¡
;

58 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gEdgeRuË
> 
	gedgeLab–ToEdgeRuËs
;

59 
´iv©e
 
	gA¼ayLi¡
<
	gSŒšg
> 
	gedgeLab–Li¡
;

60 
´iv©e
 
	gA¼ayLi¡
<
	gEdge
<
	gSŒšgTy³
>> 
	gedgeLi¡
;

62 
´iv©e
 
boŞ—n
 
	gæ©‹nLi¡s
;

78 
´iv©e
 cÏs 
	cEdgeRuË
 {

79 
´iv©e
 
SŒšg
 
	g¤cCŞumnName
;

80 
´iv©e
 
SŒšg
 
	gd¡CŞumnName
;

81 
´iv©e
 
	gLi¡
<
	gSŒšg
> 
	g´İ”tyCŞumnNames
;

82 
boŞ—n
 
	gisBiDœeùiÚ®
;

84 
´iv©e
 
EdgeRuË
() {

95 
EdgeRuË
(
SŒšg
 
¤cCŞumnName
, SŒšg 
d¡CŞumnName
, 
boŞ—n
 
biDœeùiÚ®
) {

96 
	gthis
.
	g¤cCŞumnName
 = 
¤cCŞumnName
;

97 
	gthis
.
	gd¡CŞumnName
 = 
d¡CŞumnName
;

98 
	gthis
.
	g´İ”tyCŞumnNames
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>();

99 
	gthis
.
	gisBiDœeùiÚ®
 = 
biDœeùiÚ®
;

102 
SŒšg
 
g‘SrcCŞumnName
() {

103  
	gthis
.
	g¤cCŞumnName
;

106 
SŒšg
 
g‘D¡CŞumnName
() {

107  
	gthis
.
	gd¡CŞumnName
;

110 
boŞ—n
 
isBiDœeùiÚ®
() {

111  
	gthis
.
	gisBiDœeùiÚ®
;

114 
addPrİ”tyCŞumnName
(
SŒšg
 
cŞumnName
) {

115 
	g´İ”tyCŞumnNames
.
add
(
cŞumnName
);

118 
	gLi¡
<
	gSŒšg
> 
g‘Prİ”tyCŞumnNames
() {

119  
	g´İ”tyCŞumnNames
;

131 
public
 
	$HBa£Tok’iz”
() {

133 
v”‹xPrİCŞM­
 = 
Ãw
 
HashM­
<
SŒšg
, String[]>();

134 
v”‹xIdCŞumnLi¡
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>();

135 
v”‹xLi¡
 = 
Ãw
 
A¼ayLi¡
<
V”‹x
<
SŒšgTy³
>>();

137 
edgeLab–ToEdgeRuËs
 = 
Ãw
 
HashM­
<
SŒšg
, 
EdgeRuË
>();

138 
edgeLab–Li¡
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>();

139 
edgeLi¡
 = 
Ãw
 
A¼ayLi¡
<
Edge
<
SŒšgTy³
>>();

140 
	}
}

150 @
Ov”ride


151 
public
 
	$cÚfigu»
(
CÚfigu¿tiÚ
 
cÚf
) {

153 
this
.
æ©‹nLi¡s
 = 
cÚf
.
	`g‘BoŞ—n
("HBASE_TOKENIZER_FLATTEN_LISTS",
çl£
);

158 
SŒšg
[] 
v”‹xRuËs
 = 
HBa£G¿phBudšgRuË
.
	`uÅackV”‹xRuËsFromCÚfigu¿tiÚ
(
cÚf
);

160 
SŒšg
 
v”‹xIdCŞumnName
 = 
nuÎ
;

162 
SŒšg
 
v”‹xRuË
 : 
v”‹xRuËs
) {

164 
v”‹xIdCŞumnName
 = 
HBa£G¿phBudšgRuË
.
	`g‘VidCŞNameFromV”‹xRuË
(
v”‹xRuË
);

165 
v”‹xIdCŞumnLi¡
.
	`add
(
v”‹xIdCŞumnName
);

167 
SŒšg
[] 
v”‹xPrİ”t›sCŞumnNames
 =

168 
HBa£G¿phBudšgRuË
.
	`g‘V”‹xPrİ”tyCŞumnsFromV”‹xRuË
(
v”‹xRuË
);

170 
v”‹xPrİCŞM­
.
	`put
(
v”‹xIdCŞumnName
, 
v”‹xPrİ”t›sCŞumnNames
);

173 
LOG
.
	`šfo
("INFO: Numb” oàv”tiû„uË tØb»ad from HBa£ = " + 
v”‹xIdCŞumnLi¡
.
	`size
());

176 
SŒšg
[] 
¿wEdgeRuËs
 = 
HBa£G¿phBudšgRuË
.
	`uÅackEdgeRuËsFromCÚfigu¿tiÚ
(
cÚf
);

177 
SŒšg
[] 
¿wDœeùedEdgeRuËs
 = 
HBa£G¿phBudšgRuË
.
	`uÅackDœeùedEdgeRuËsFromCÚfigu¿tiÚ
(
cÚf
);

179 
fš®
 
boŞ—n
 
BIDIRECTIONAL
 = 
Œue
;

180 
fš®
 
boŞ—n
 
DIRECTED
 = 
çl£
;

182 
SŒšg
 
¿wEdgeRuË
 : 
¿wEdgeRuËs
) {

184 
SŒšg
 
¤cV”‹xCŞName
 = 
HBa£G¿phBudšgRuË
.
	`g‘SrcCŞNameFromEdgeRuË
(
¿wEdgeRuË
);

185 
SŒšg
 
tgtV”‹xCŞName
 = 
HBa£G¿phBudšgRuË
.
	`g‘D¡CŞNameFromEdgeRuË
(
¿wEdgeRuË
);

186 
SŒšg
 
Ïb–
 = 
HBa£G¿phBudšgRuË
.
	`g‘Lab–FromEdgeRuË
(
¿wEdgeRuË
);

187 
Li¡
<
SŒšg
> 
edgePrİ”tyCŞs
 =

188 
HBa£G¿phBudšgRuË
.
	`g‘EdgePrİ”tyCŞumnNamesFromEdgeRuË
(
¿wEdgeRuË
);

190 
EdgeRuË
 
edgeRuË
 = 
Ãw
 
	`EdgeRuË
(
¤cV”‹xCŞName
, 
tgtV”‹xCŞName
, 
BIDIRECTIONAL
);

192 
SŒšg
 
edgePrİ”tyCŞumn
 : 
edgePrİ”tyCŞs
) {

193 
edgeRuË
.
	`addPrİ”tyCŞumnName
(
edgePrİ”tyCŞumn
);

195 
edgeLab–ToEdgeRuËs
.
	`put
(
Ïb–
, 
edgeRuË
);

196 
edgeLab–Li¡
.
	`add
(
Ïb–
);

199 
SŒšg
 
¿wDœeùedEdgeRuË
 : 
¿wDœeùedEdgeRuËs
) {

201 
SŒšg
 
¤cV”‹xCŞName
 = 
HBa£G¿phBudšgRuË
.
	`g‘SrcCŞNameFromEdgeRuË
(
¿wDœeùedEdgeRuË
);

202 
SŒšg
 
tgtV”‹xCŞName
 = 
HBa£G¿phBudšgRuË
.
	`g‘D¡CŞNameFromEdgeRuË
(
¿wDœeùedEdgeRuË
);

203 
SŒšg
 
Ïb–
 = 
HBa£G¿phBudšgRuË
.
	`g‘Lab–FromEdgeRuË
(
¿wDœeùedEdgeRuË
);

204 
Li¡
<
SŒšg
> 
edgePrİ”tyCŞs
 =

205 
HBa£G¿phBudšgRuË
.
	`g‘EdgePrİ”tyCŞumnNamesFromEdgeRuË
(
¿wDœeùedEdgeRuË
);

207 
EdgeRuË
 
edgeRuË
 = 
Ãw
 
	`EdgeRuË
(
¤cV”‹xCŞName
, 
tgtV”‹xCŞName
, 
DIRECTED
);

209 
SŒšg
 
edgePrİ”tyCŞumn
 : 
edgePrİ”tyCŞs
) {

210 
edgeRuË
.
	`addPrİ”tyCŞumnName
(
edgePrİ”tyCŞumn
);

213 
edgeLab–ToEdgeRuËs
.
	`put
(
Ïb–
, 
edgeRuË
);

214 
edgeLab–Li¡
.
	`add
(
Ïb–
);

218 
	}
}

228 
´iv©e
 
SŒšg
 
	$g‘CŞumnD©a
(
ResuÉ
 
cŞumns
, 
SŒšg
 
fuÎCŞumnName
, 
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

230 
SŒšg
 
v®ue
 = 
By‹s
.
	`toSŒšg
(
HBa£Uts
.
	`g‘CŞumnD©a
(
cŞumns
, 
fuÎCŞumnName
));

232 ià(
nuÎ
 !ğ
v®ue
) {

233 
cÚ‹xt
.
	`g‘CouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_COLS_READ
).
	`šüem’t
(1);

235 ià(
v®ue
.
	`isEm±y
()) {

236 
cÚ‹xt
.
	`g‘CouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_COLS_IGNORED
).
	`šüem’t
(1l);

237 
v®ue
 = 
nuÎ
;

240 
cÚ‹xt
.
	`g‘CouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_COL_READ_ERROR
).
	`šüem’t
(1l);

243  
v®ue
;

244 
	}
}

246 
´iv©e
 
	gSŒšg
[] 
	$ex·ndSŒšg
(
SŒšg
 
¡ršg
) {

248 
SŒšg
[] 
outA¼ay
 = 
nuÎ
;

250 
šL’gth
 = 
¡ršg
.
	`Ëngth
();

252 ià(
this
.
æ©‹nLi¡s
 && 
¡ršg
.
	`¡¬tsW™h
("{"è&& sŒšg.
	`’dsW™h
("}")) {

254 
SŒšg
 
b¿ûsSŒ³dSŒšg
 = 
¡ršg
.
	`sub¡ršg
(1,
šL’gth
-1);

255 
SŒšg
 
·»Áhe£sDrİ³dSŒšg
 = 
b¿ûsSŒ³dSŒšg
.
	`»¶aû
("(","").replace(")","");

256 
SŒšg
[] 
ex·ndedSŒšg
 = 
·»Áhe£sDrİ³dSŒšg
.
	`¥l™
("\\,");

257 
outA¼ay
 = 
ex·ndedSŒšg
;

260 
outA¼ay
 = 
Ãw
 
SŒšg
[1];

261 
outA¼ay
[0] = 
¡ršg
;

264  
outA¼ay
;

265 
	}
}

276 
public
 
	$·r£
(
RecÜdTy³HBa£Row
 
»cÜd
, 
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

278 
ImmubËBy‹sWr™abË
 
row
 = 
»cÜd
.
	`g‘Row
();

279 
ResuÉ
 
cŞumns
 = 
»cÜd
.
	`g‘CŞumns
();

281 
v”‹xLi¡
.
	`ş—r
();

282 
edgeLi¡
.
	`ş—r
();

286 
SŒšg
 
cŞumnName
 : 
v”‹xIdCŞumnLi¡
) {

288 
SŒšg
 
vidC–l
 = 
	`g‘CŞumnD©a
(
cŞumns
, 
cŞumnName
, 
cÚ‹xt
);

290 
SŒšg
 
v”‹xId
 : 
	`ex·ndSŒšg
(
vidC–l
)) {

292 ià(
nuÎ
 !ğ
v”‹xId
) {

296 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
(
v”‹xId
));

300 
SŒšg
[] 
vpCŞNames
 = 
v”‹xPrİCŞM­
.
	`g‘
(
cŞumnName
);

302 ià(
nuÎ
 !ğ
vpCŞNames
) {

304 
SŒšg
 
v®ue
 = 
nuÎ
;

306 ià(
vpCŞNames
.
Ëngth
 > 0) {

307 
SŒšg
 
v”‹xPrİ”tyCŞumnName
 : 
vpCŞNames
) {

308 
v®ue
 = 
	`g‘CŞumnD©a
(
cŞumns
, 
v”‹xPrİ”tyCŞumnName
, 
cÚ‹xt
);

309 ià(
v®ue
 !ğ
nuÎ
) {

310 
v”‹x
.
	`£tPrİ”ty
(
v”‹xPrİ”tyCŞumnName
, 
Ãw
 
	`SŒšgTy³
(
v®ue
));

316 
v”‹xLi¡
.
	`add
(
v”‹x
);

319 
LOG
.
	`w¬n
("WARN: NuÎ v”‹x iÀ" + 
cŞumnName
 + ",„ow " + 
row
.
	`toSŒšg
());

320 
cÚ‹xt
.
	`g‘CouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_COLS_IGNORED
).
	`šüem’t
(1l);

327 
SŒšg
 
´İ”tyV®ue
;

328 
SŒšg
 
´İ”ty
;

329 
SŒšg
 
¤cV”‹xCŞName
;

330 
SŒšg
 
tgtV”‹xCŞName
;

332 
SŒšg
 
eLab–
 : 
edgeLab–Li¡
) {

334 
couÁEdgeA‰r
 = 0;

335 
EdgeRuË
 
edgeRuË
 = 
edgeLab–ToEdgeRuËs
.
	`g‘
(
eLab–
);

336 
Li¡
<
SŒšg
> 
edgeA‰ribu‹Li¡
 = 
edgeRuË
.
	`g‘Prİ”tyCŞumnNames
();

337 
SŒšg
[] 
edgeA‰ribu‹s
 = 
edgeA‰ribu‹Li¡
.
	`toA¼ay
(
Ãw
 SŒšg[edgeA‰ribu‹Li¡.
	`size
()]);

340 
¤cV”‹xCŞName
 = 
edgeRuË
.
	`g‘SrcCŞumnName
();

341 
tgtV”‹xCŞName
 = 
edgeRuË
.
	`g‘D¡CŞumnName
();

343 
SŒšg
 
¤cV”‹xC–lSŒšg
 = 
	`g‘CŞumnD©a
(
cŞumns
, 
¤cV”‹xCŞName
, 
cÚ‹xt
);

344 
SŒšg
 
tgtV”‹xC–lSŒšg
 = 
	`g‘CŞumnD©a
(
cŞumns
, 
tgtV”‹xCŞName
, 
cÚ‹xt
);

347 
SŒšg
 
¤cV”‹xName
 : 
	`ex·ndSŒšg
(
¤cV”‹xC–lSŒšg
)) {

348 
SŒšg
 
tgtV”‹xName
: 
	`ex·ndSŒšg
(
tgtV”‹xC–lSŒšg
)) {

350 ià(
¤cV”‹xCŞName
 !ğ
nuÎ
 && 
tgtV”‹xCŞName
 !ğnuÎ && 
eLab–
 !=‚ull) {

352 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
(
¤cV”‹xName
),

353 
Ãw
 
	`SŒšgTy³
(
tgtV”‹xName
),‚ew SŒšgTy³(
eLab–
));

355 
couÁEdgeA‰r
 = 0; couÁEdgeA‰¸< 
edgeA‰ribu‹s
.
Ëngth
; countEdgeAttr++) {

356 
´İ”tyV®ue
 = 
	`g‘CŞumnD©a
(
cŞumns
, 
edgeA‰ribu‹s
[
couÁEdgeA‰r
], 
cÚ‹xt
);

358 
´İ”ty
 = 
edgeA‰ribu‹s
[
couÁEdgeA‰r
].
	`»¶aûAÎ
(

359 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("HBASE_COLUMN_SEPARATOR"),

360 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("GRAPH_PROPERTY_SEPARATOR"));

362 ià(
´İ”ty
 !ğ
nuÎ
) {

363 
edge
.
	`£tPrİ”ty
(
´İ”ty
, 
Ãw
 
	`SŒšgTy³
(
´İ”tyV®ue
));

367 
edgeLi¡
.
	`add
(
edge
);

371 
V”‹x
<
SŒšgTy³
> 
¤cV”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
(
¤cV”‹xName
));

372 
V”‹x
<
SŒšgTy³
> 
tgtV”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
(
tgtV”‹xName
));

373 
v”‹xLi¡
.
	`add
(
¤cV”‹x
);

374 
v”‹xLi¡
.
	`add
(
tgtV”‹x
);

376 ià(
edgeRuË
.
	`isBiDœeùiÚ®
()) {

377 
Edge
<
SŒšgTy³
> 
İposšgEdge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
(
tgtV”‹xName
),

378 
Ãw
 
	`SŒšgTy³
(
¤cV”‹xName
),

379 
Ãw
 
	`SŒšgTy³
(
eLab–
));

383 
couÁEdgeA‰r
 = 0; couÁEdgeA‰¸< 
edgeA‰ribu‹s
.
Ëngth
; countEdgeAttr++) {

384 
´İ”tyV®ue
 = 
	`g‘CŞumnD©a
(
cŞumns
, 
edgeA‰ribu‹s
[
couÁEdgeA‰r
], 
cÚ‹xt
);

387 
´İ”ty
 = 
edgeA‰ribu‹s
[
couÁEdgeA‰r
].
	`»¶aûAÎ
(

388 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("HBASE_COLUMN_SEPARATOR"),

389 
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("GRAPH_PROPERTY_SEPARATOR"));

391 ià(
´İ”ty
 !ğ
nuÎ
) {

392 
İposšgEdge
.
	`£tPrİ”ty
(
´İ”ty
, 
Ãw
 
	`SŒšgTy³
(
´İ”tyV®ue
));

395 
edgeLi¡
.
	`add
(
İposšgEdge
);

401 
	}
}

408 
public
 
	gI‹¿tÜ
<
	gV”‹x
<
	gSŒšgTy³
>> 
	$g‘V”tiûs
() {

409  
v”‹xLi¡
.
	`™”©Ü
();

410 
	}
}

416 @
Ov”ride


417 
public
 
	gI‹¿tÜ
<
	gEdge
<
	gSŒšgTy³
>> 
	$g‘Edges
() {

418  
edgeLi¡
.
	`™”©Ü
();

419 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/linkgraph/LinkGraphBuildingRule.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	glškg¿ph
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gEdgeSchema
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tyG¿phSchema
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gV”‹xSchema
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

47 
public
 cÏs 
	cLškG¿phBudšgRuË
 
im¶em’ts
 
	mG¿phBudšgRuË
 {

49 
´iv©e
 
Prİ”tyG¿phSchema
 
	mg¿phSchema
;

50 
´iv©e
 
CÏss
 
	mvidCÏss
 = 
SŒšgTy³
.
şass
;

51 
´iv©e
 
	mCÏss
<? 
ex‹nds
 
	mG¿phTok’iz”
> 
	mtok’iz”CÏss
 = 
LškG¿phTok’iz”
.
şass
;

62 
public
 
	$LškG¿phBudšgRuË
() {

63 
g¿phSchema
 = 
Ãw
 
	`Prİ”tyG¿phSchema
();

65 
V”‹xSchema
 
v”‹xSchema
 = 
Ãw
 
	`V”‹xSchema
();

66 
g¿phSchema
.
	`addV”‹xSchema
(
v”‹xSchema
);

68 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
(
LškG¿phTok’iz”
.
LINKSTO
);

69 
g¿phSchema
.
	`addEdgeSchema
(
edgeSchema
);

76 
public
 
Prİ”tyG¿phSchema
 
	$g‘G¿phSchema
() {

77  
g¿phSchema
;

78 
	}
}

85 
public
 
	$upd©eCÚfigu¿tiÚFÜTok’iz”
(
CÚfigu¿tiÚ
 
cÚf
, 
CommªdLše
 
cmd
) {

86 
	}
}

93 
public
 
	gCÏss
<? 
ex‹nds
 
	gG¿phTok’iz”
> 
	$g‘G¿phTok’iz”CÏss
() {

94  
tok’iz”CÏss
;

95 
	}
}

102 
public
 
CÏss
 
	$vidCÏss
() {

103  
vidCÏss
;

104 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/linkgraph/LinkGraphTokenizer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	glškg¿ph
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gSŒšgR—d”
;

24 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

26 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

27 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gM©ch”
;

28 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

30 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gDocum’tBud”
;

31 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gDocum’tBud”FaùÜy
;

32 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gP¬£rCÚfigu¿tiÚExû±iÚ
;

33 
impÜt
 
	gjavax
.
	gxml
.
	gx·th
.
	gXP©h
;

34 
impÜt
 
	gjavax
.
	gxml
.
	gx·th
.
	gXP©hEx´essiÚExû±iÚ
;

35 
impÜt
 
	gjavax
.
	gxml
.
	gx·th
.
	gXP©hFaùÜy
;

37 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

38 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

39 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gcŞËùiÚs
.
	g™”©Üs
.
	gEm±yI‹¿tÜ
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

44 
impÜt
 
	gÜg
.
	gw3c
.
	gdom
.
	gDocum’t
;

45 
impÜt
 
	gÜg
.
	gxml
.
	g§x
.
	gIÅutSourû
;

46 
impÜt
 
	gÜg
.
	gxml
.
	g§x
.
	gSAXExû±iÚ
;

48 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

49 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

50 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

67 
public
 
şass
 
LškG¿phTok’iz”
 
im¶em’ts
 
	gG¿phTok’iz”
<
	gSŒšg
, 
	gSŒšgTy³
> {

69 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
LškG¿phTok’iz”
.
şass
);

71 
public
 
fš®
 
SŒšg
 
	gLINKSTO
 = "linksTo";

73 
´iv©e
 
SŒšg
 
	gt™Ë
;

74 
´iv©e
 
	gLi¡
<
	gSŒšg
> 
	glšks
;

75 
´iv©e
 
	gA¼ayLi¡
<
	gV”‹x
<
	gSŒšgTy³
>> 
	gv”‹xLi¡
;

76 
´iv©e
 
	gA¼ayLi¡
<
	gEdge
<
	gSŒšgTy³
>> 
	gedgeLi¡
;

80 
´iv©e
 
Docum’tBud”FaùÜy
 
	gçùÜy
;

81 
´iv©e
 
Docum’tBud”
 
	gbud”
;

82 
´iv©e
 
XP©h
 
	gx·th
;

88 
public
 
LškG¿phTok’iz”
() {

90 
	gçùÜy
 = 
Docum’tBud”FaùÜy
.
ÃwIn¡ªû
();

91 
	gçùÜy
.
£tName¥aûAw¬e
(
Œue
);

93 
	gŒy
 {

94 
	gbud”
 = 
çùÜy
.
ÃwDocum’tBud”
();

95 } 
ÿtch
 (
P¬£rCÚfigu¿tiÚExû±iÚ
 
e
) {

96 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

97 "CªnÙ cÚfigu» XML…¬£¸fÜ Lšk G¿phok’iz©iÚ", 
LOG
, 
e
);

100 
XP©hFaùÜy
 
	gxP©hFaùÜy
 = XP©hFaùÜy.
ÃwIn¡ªû
();

101 
	gx·th
 = 
xP©hFaùÜy
.
ÃwXP©h
();

103 
	gv”‹xLi¡
 = 
Ãw
 
A¼ayLi¡
<
V”‹x
<
SŒšgTy³
>>();

104 
	gedgeLi¡
 = 
Ãw
 
A¼ayLi¡
<
Edge
<
SŒšgTy³
>>();

105 
	glšks
 = 
Ãw
 
A¼ayLi¡
<
SŒšg
>();

112 @
Ov”ride


113 
public
 
cÚfigu»
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
) {

121 
public
 
·r£
(
SŒšg
 
¡ršg
, 
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

123 
	gŒy
 {

125 
Docum’t
 
	gdoc
 = 
bud”
.
·r£
(
Ãw
 
IÅutSourû
Òew 
SŒšgR—d”
(
¡ršg
)));

127 
	gt™Ë
 = 
x·th
.
ev®u©e
("//·ge/t™Ë/‹xt()", 
doc
);

128 
	gt™Ë
 = 
t™Ë
.
»¶aûAÎ
("\\s", "_");

130 
SŒšg
 
	g‹xt
 = 
x·th
.
ev®u©e
("//·ge/»visiÚ/‹xt/‹xt()", 
doc
);

131 
·r£Lšks
(
‹xt
);

133 } 
ÿtch
 (
SAXExû±iÚ
 
e
) {

134 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

135 "Could‚Ù…¬£ docum’t", 
LOG
, 
e
);

136 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

137 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

138 "IOƒxû±iÚ wh·rsšg docum’t", 
LOG
, 
e
);

139 } 
ÿtch
 (
XP©hEx´essiÚExû±iÚ
 
e
) {

140 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

141 "Could‚Ù…¬£ docum’t", 
LOG
, 
e
);

149 
public
 
	gI‹¿tÜ
<
	gV”‹x
<
	gSŒšgTy³
>> 
g‘V”tiûs
() {

151 
	gv”‹xLi¡
.
ş—r
();

152 
	gv”‹xLi¡
.
add
(
Ãw
 
V”‹x
<
SŒšgTy³
>Òew SŒšgTy³(
t™Ë
)));

154 
SŒšg
 
	glšk
 : 
lšks
) {

155 
v”‹xLi¡
.
add
(
Ãw
 
V”‹x
<
SŒšgTy³
>Òew SŒšgTy³(
lšk
)));

158  
	gv”‹xLi¡
.
™”©Ü
();

166 @
Ov”ride


167 
public
 
	gI‹¿tÜ
<
	gEdge
<
	gSŒšgTy³
>> 
g‘Edges
() {

169 ià(
	glšks
.
isEm±y
()) {

170  
	gEm±yI‹¿tÜ
.
	gINSTANCE
;

173 
	gedgeLi¡
.
ş—r
();

174 
	gI‹¿tÜ
<
	gSŒšg
> 
	g™”©Ü
 = 
lšks
.
™”©Ü
();

175 
fš®
 
SŒšgTy³
 
	gLINKSTO_STYPE
 = 
Ãw
 SŒšgTy³(
LINKSTO
);

177 
	g™”©Ü
.
hasNext
()) {

178 
	gedgeLi¡
.
add
(
Ãw
 
Edge
<
SŒšgTy³
>Òew SŒšgTy³(
t™Ë
),

179 
Ãw
 
SŒšgTy³
(
™”©Ü
.
Ãxt
()), 
LINKSTO_STYPE
));

182  
	gedgeLi¡
.
™”©Ü
();

189 
´iv©e
 
·r£Lšks
(
SŒšg
 
‹xt
) {

191 
	glšks
.
ş—r
();

193 
P©‹º
 
	gÿtP©‹º
 = P©‹º.
compe
("\\[\\[(.*?)\\]\\]", P©‹º.
MULTILINE
);

194 
M©ch”
 
	gm©ch”
 = 
ÿtP©‹º
.
m©ch”
(
‹xt
);

196 
	gm©ch”
.
fšd
()) {

198 
	gSŒšg
[] 
	gpÙ’tŸlLšk
 = 
m©ch”
.
group
(1).
¥l™
("\\|");

200 ià(
	gpÙ’tŸlLšk
 !ğ
nuÎ
 && 
pÙ’tŸlLšk
.
Ëngth
 > 0) {

202 
SŒšg
 
lšk
 = 
pÙ’tŸlLšk
[0];

204 ià(!
	glšk
.
»¶aûAÎ
("\\s", "").
isEm±y
(è&& !lšk.
cÚšs
(":")) {

205 
	glšks
.
add
(
lšk
.
»¶aûAÎ
("\\s", "_"));

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/wordcountgraph/WordCountGraphBuildingRule.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gwÜdcouÁg¿ph
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gEdgeSchema
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tyG¿phSchema
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tySchema
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gV”‹xSchema
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phBudšgRuË
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

48 
public
 cÏs 
	cWÜdCouÁG¿phBudšgRuË
 
im¶em’ts
 
	mG¿phBudšgRuË
 {

49 
´iv©e
 
Prİ”tyG¿phSchema
 
	mg¿phSchema
;

51 
´iv©e
 
CÏss
 
	mvidCÏss
 = 
SŒšgTy³
.
şass
;

52 
´iv©e
 
	mCÏss
<? 
ex‹nds
 
	mG¿phTok’iz”
> 
	mtok’iz”CÏss
 = 
WÜdCouÁG¿phTok’iz”
.
şass
;

60 
public
 
	$WÜdCouÁG¿phBudšgRuË
() {

61 
g¿phSchema
 = 
Ãw
 
	`Prİ”tyG¿phSchema
();

63 
V”‹xSchema
 
v”‹xSchema
 = 
Ãw
 
	`V”‹xSchema
();

64 
g¿phSchema
.
	`addV”‹xSchema
(
v”‹xSchema
);

66 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
(
WÜdCouÁG¿phTok’iz”
.
CONTAINS
);

67 
Prİ”tySchema
 
´İ”tySchema
 = 
Ãw
 
	`Prİ”tySchema
(
WÜdCouÁG¿phTok’iz”
.
WORDCOUNT
, 
IÁeg”
.
şass
);

68 
edgeSchema
.
	`g‘Prİ”tySchem©a
().
	`add
(
´İ”tySchema
);

69 
g¿phSchema
.
	`addEdgeSchema
(
edgeSchema
);

76 
public
 
Prİ”tyG¿phSchema
 
	$g‘G¿phSchema
() {

77  
g¿phSchema
;

78 
	}
}

85 
public
 
	$upd©eCÚfigu¿tiÚFÜTok’iz”
(
CÚfigu¿tiÚ
 
cÚf
, 
CommªdLše
 
cmd
) {

86 
	}
}

93 
public
 
	gCÏss
<? 
ex‹nds
 
	gG¿phTok’iz”
> 
	$g‘G¿phTok’iz”CÏss
() {

94  
tok’iz”CÏss
;

95 
	}
}

101 
public
 
CÏss
 
	$vidCÏss
() {

102  
vidCÏss
;

103 
	}
}

	@src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/wordcountgraph/WordCountGraphTokenizer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gwÜdcouÁg¿ph
;

22 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

23 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

25 
impÜt
 
	gjava
.
	gio
.
	gSŒšgR—d”
;

26 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

27 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

29 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

31 
impÜt
 
	gjava
.
	gut
.
	gSÿÂ”
;

33 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gDocum’tBud”
;

34 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gDocum’tBud”FaùÜy
;

35 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gP¬£rCÚfigu¿tiÚExû±iÚ
;

36 
impÜt
 
	gjavax
.
	gxml
.
	gx·th
.
	gXP©h
;

37 
impÜt
 
	gjavax
.
	gxml
.
	gx·th
.
	gXP©hEx´essiÚExû±iÚ
;

38 
impÜt
 
	gjavax
.
	gxml
.
	gx·th
.
	gXP©hFaùÜy
;

40 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
.
	gPrİ”tyG¿phSchema
;

41 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gG¿phTok’iz”
;

42 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gIÁTy³
;

43 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gG¿phBud”Ex™
;

44 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gStusCode
;

46 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gcŞËùiÚs
.
	g™”©Üs
.
	gEm±yI‹¿tÜ
;

47 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

48 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gFeStus
;

49 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gFeSy¡em
;

50 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gfs
.
	gP©h
;

51 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

52 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

53 
impÜt
 
	gÜg
.
	g­ache
.
	gluûÃ
.
	gª®ysis
.
	gAÇlyz”
;

54 
impÜt
 
	gÜg
.
	g­ache
.
	gluûÃ
.
	gª®ysis
.
	gTok’SŒ—m
;

55 
impÜt
 
	gÜg
.
	g­ache
.
	gluûÃ
.
	gª®ysis
.
	g¡ªd¬d
.
	gSnd¬dAÇlyz”
;

56 
impÜt
 
	gÜg
.
	g­ache
.
	gluûÃ
.
	gª®ysis
.
	gtok’©Œibu‹s
.
	gT”mA‰ribu‹
;

57 
impÜt
 
	gÜg
.
	g­ache
.
	gluûÃ
.
	gut
.
	gV”siÚ
;

58 
impÜt
 
	gÜg
.
	gw3c
.
	gdom
.
	gDocum’t
;

59 
impÜt
 
	gÜg
.
	gxml
.
	g§x
.
	gIÅutSourû
;

60 
impÜt
 
	gÜg
.
	gxml
.
	g§x
.
	gSAXExû±iÚ
;

62 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

63 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

65 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

84 
public
 
şass
 
WÜdCouÁG¿phTok’iz”
 
im¶em’ts
 
	gG¿phTok’iz”
<
	gSŒšg
, 
	gSŒšgTy³
> {

86 
´iv©e
 
fš®
 
Logg”
 
	gLOG
 = Logg”.
g‘Logg”
(
WÜdCouÁG¿phTok’iz”
.
şass
);

88 
´iv©e
 
SŒšg
 
	g·geT™Ë
;

89 
´iv©e
 
	gHashM­
<
	gSŒšg
, 
	gIÁeg”
> 
	gwÜdCouÁM­
;

90 
´iv©e
 
FeSy¡em
 
	gfeSy¡em
;

91 
´iv©e
 
	gHashS‘
<
	gSŒšg
> 
	gdiùiÚ¬y
;

92 
´iv©e
 
	gHashS‘
<
	gSŒšg
> 
	g¡İWÜdsLi¡
;

94 
´iv©e
 
Prİ”tyG¿phSchema
 
	gg¿phSchema
;

96 
public
 
fš®
 
SŒšg
 
	gCONTAINS
 = "contains";

97 
public
 
fš®
 
SŒšg
 
	gWORDCOUNT
 = "wordCount";

104 
´iv©e
 
fš®
 
	gDOCUMENT_TAG
 = '0';

105 
´iv©e
 
fš®
 
	gWORD_TAG
 = '1';

113 @
Ov”ride


114 
public
 
cÚfigu»
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
) {

116 
	gŒy
 {

117 
	gfeSy¡em
 = 
FeSy¡em
.
g‘
(
cÚfigu¿tiÚ
);

118 } 
ÿtch
 (
IOExû±iÚ
 
e1
) {

119 
	ge1
.
´štSckT¿û
();

122 
SŒšg
 
	gdiùP©h
 = 
cÚfigu¿tiÚ
.
g‘
("Dictionary");

124 ià(
	gdiùP©h
 !ğ
nuÎ
 && 
diùP©h
 != "") {

125 
Œy
 {

126 
lßdDiùiÚ¬y
(
diùP©h
);

127 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

128 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_LOAD_INPUT_FILE
,

129 "Could‚Ù†ßd diùiÚ¬y fe,…©h=" + 
diùP©h
, 
LOG
, 
e
);

133 
SŒšg
 
	g¡İWÜdsP©h
 = 
cÚfigu¿tiÚ
.
g‘
("StopWords");

135 ià(
	g¡İWÜdsP©h
 !ğ
nuÎ
 && 
¡İWÜdsP©h
 != "") {

136 
Œy
 {

137 
lßdStİWÜds
(
¡İWÜdsP©h
);

138 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

139 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNABLE_TO_LOAD_INPUT_FILE
,

140 "Could‚Ù†ßd stİwÜd fe,…©h=" + 
¡İWÜdsP©h
, 
LOG
, 
e
);

156 
public
 
·r£
(
SŒšg
 
šputSŒšg
, 
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

158 
Docum’tBud”FaùÜy
 
	gçùÜy
 = Docum’tBud”FaùÜy.
ÃwIn¡ªû
();

159 
	gçùÜy
.
£tName¥aûAw¬e
(
Œue
);

161 
	gwÜdCouÁM­
 = 
Ãw
 
HashM­
<
SŒšg
, 
	gIÁeg”
>();

163 
	gŒy
 {

164 
Docum’tBud”
 
	gbud”
;

165 
	gbud”
 = 
çùÜy
.
ÃwDocum’tBud”
();

167 
Docum’t
 
	gdoc
 = 
bud”
.
·r£
(
Ãw
 
IÅutSourû
Òew 
SŒšgR—d”
(
šputSŒšg
)));

169 
XP©hFaùÜy
 
	gxP©hFaùÜy
 = XP©hFaùÜy.
ÃwIn¡ªû
();

170 
XP©h
 
	gx·th
 = 
xP©hFaùÜy
.
ÃwXP©h
();

172 
SŒšg
 
	gšput_t™Ë
 = 
x·th
.
ev®u©e
("//·ge/t™Ë/‹xt()", 
doc
);

174 
	gšput_t™Ë
 = 
šput_t™Ë
.
»¶aûAÎ
("\\s", "_");

176 ià(!(
	gšput_t™Ë
.
¡¬tsW™h
("Wikipedia:") ||

177 
	gšput_t™Ë
.
¡¬tsW™h
("Help:") ||

178 
	gšput_t™Ë
.
¡¬tsW™h
("Category:") ||

179 
	gšput_t™Ë
.
¡¬tsW™h
("Template:") ||

180 
	gšput_t™Ë
.
¡¬tsW™h
("MediaWiki:") ||

181 
	gšput_t™Ë
.
¡¬tsW™h
("Book:") ||

182 
	gšput_t™Ë
.
¡¬tsW™h
("Portal:") ||

183 
	gšput_t™Ë
.
¡¬tsW™h
("File:") ||

184 
	gšput_t™Ë
.
¡¬tsW™h
("List_of_")) ||

185 
	gšput_t™Ë
.
¡¬tsW™h
("List_of_Intel_")) {

187 
	g·geT™Ë
 = 
šput_t™Ë
;

188 
SŒšg
 
	g‹xt
 = 
x·th
.
ev®u©e
("//·ge/»visiÚ/‹xt/‹xt()", 
doc
);

190 ià(!
	g‹xt
.
isEm±y
()) {

192 
AÇlyz”
 
	gª®yz”
 = 
Ãw
 
Snd¬dAÇlyz”
(
V”siÚ
.
LUCENE_30
);

193 
Tok’SŒ—m
 
	g¡»am
 = 
ª®yz”
.
tok’SŒ—m
(
nuÎ
, 
Ãw
 
SŒšgR—d”
(
‹xt
));

195 
	g¡»am
.
šüem’tTok’
()) {

197 
SŒšg
 
	gtok’
 = 
¡»am
.
g‘A‰ribu‹
(
T”mA‰ribu‹
.
şass
).
‹rm
().
toLow”Ca£
();

199 ià(
	gdiùiÚ¬y
 !ğ
nuÎ
 && !
diùiÚ¬y
.
cÚšs
(
tok’
)) {

203 ià(
	g¡İWÜdsLi¡
 !ğ
nuÎ
 && 
¡İWÜdsLi¡
.
cÚšs
(
tok’
)) {

207 ià(
	gwÜdCouÁM­
.
cÚšsKey
(
tok’
)) {

208 
	gwÜdCouÁM­
.
put
(
tok’
, 
wÜdCouÁM­
.
g‘
(token) + 1);

210 
	gwÜdCouÁM­
.
put
(
tok’
, 1);

215 } 
ÿtch
 (
P¬£rCÚfigu¿tiÚExû±iÚ
 
e
) {

216 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

217 "P¬£¸cÚfigu¿tiÚƒ¼Ü.", 
LOG
, 
e
);

218 } 
ÿtch
 (
SAXExû±iÚ
 
e
) {

219 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

220 "SAXExû±iÚ", 
LOG
, 
e
);

221 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

222 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

223 "IO Exû±iÚ", 
LOG
, 
e
);

224 } 
ÿtch
 (
XP©hEx´essiÚExû±iÚ
 
e
) {

225 
	gG¿phBud”Ex™
.
g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
INTERNAL_PARSER_ERROR
,

226 "XP©hEx´essiÚExû±iÚ", 
LOG
, 
e
);

234 @
Ov”ride


235 
public
 
	gI‹¿tÜ
<
	gV”‹x
<
	gSŒšgTy³
>> 
g‘V”tiûs
() {

237 ià(
	gwÜdCouÁM­
.
isEm±y
()) {

238  
	gEm±yI‹¿tÜ
.
	gINSTANCE
;

241 
	gA¼ayLi¡
<
	gV”‹x
<
	gSŒšgTy³
>> 
	gv”‹xLi¡
 = 
Ãw
 
A¼ayLi¡
<
V”‹x
<
SŒšgTy³
>>(
wÜdCouÁM­
.
size
() + 1);

243 
	gv”‹xLi¡
.
add
(
Ãw
 
V”‹x
<
SŒšgTy³
>Òew SŒšgTy³(
DOCUMENT_TAG
 + 
·geT™Ë
)));

245 
	gI‹¿tÜ
<
	gSŒšg
> 
	gkeyI‹¿tÜ
 = 
wÜdCouÁM­
.
keyS‘
().
™”©Ü
();

247 
	gkeyI‹¿tÜ
.
hasNext
()) {

248 
	gv”‹xLi¡
.
add
(
Ãw
 
V”‹x
<
SŒšgTy³
>Òew SŒšgTy³(
WORD_TAG
 + 
keyI‹¿tÜ
.
Ãxt
())));

251  
	gv”‹xLi¡
.
™”©Ü
();

258 @
Ov”ride


259 
public
 
	gI‹¿tÜ
<
	gEdge
<
	gSŒšgTy³
>> 
g‘Edges
() {

261 ià(
	gwÜdCouÁM­
.
isEm±y
()) {

262  
	gEm±yI‹¿tÜ
.
	gINSTANCE
;

265 
	gA¼ayLi¡
<
	gEdge
<
	gSŒšgTy³
>> 
	gedgeLi¡
 = 
Ãw
 
A¼ayLi¡
<
Edge
<
SŒšgTy³
>>(
wÜdCouÁM­
.
size
());

266 
	gI‹¿tÜ
<
	gEÁry
<
	gSŒšg
, 
	gIÁeg”
>> 
	g’ŒyI‹¿tÜ
 = 
wÜdCouÁM­
.
’ŒyS‘
().
™”©Ü
();

267 
fš®
 
SŒšgTy³
 
	gCONTAINS_STYPE
 = 
Ãw
 SŒšgTy³(
CONTAINS
);

269 
	g’ŒyI‹¿tÜ
.
hasNext
()) {

271 
	gEÁry
<
	gSŒšg
, 
	gIÁeg”
> 
	g’Œy
 = 
’ŒyI‹¿tÜ
.
Ãxt
();

272 
Edge
 
	gedge
 = 
Ãw
 Edge<
SŒšgTy³
>Òew SŒšgTy³(
DOCUMENT_TAG
 + 
·geT™Ë
),

273 
Ãw
 
SŒšgTy³
(
WORD_TAG
 + 
’Œy
.
g‘Key
()),

274 
	gCONTAINS_STYPE
);

276 
	gedge
.
£tPrİ”ty
("wÜdCouÁ", 
Ãw
 
IÁTy³
(
’Œy
.
g‘V®ue
()));

278 
	gedgeLi¡
.
add
(
edge
);

281  
	gedgeLi¡
.
™”©Ü
();

284 
´iv©e
 
lßdDiùiÚ¬y
(
SŒšg
 
diùiÚ¬yP©h
è
throws
 
	gIOExû±iÚ
 {

286 
	gFeStus
[] 
	g¡©s
 = 
feSy¡em
.
li¡Stus
(
Ãw
 
P©h
(
diùiÚ¬yP©h
));

287 
	gdiùiÚ¬y
 = 
Ãw
 
HashS‘
<
SŒšg
>();

289 
FeStus
 
	g¡©
 : 
¡©s
) {

291 
LOG
.
debug
(("Lßd diùiÚ¬y: " + 
¡©
.
g‘P©h
().
g‘Name
()));

292 
SÿÂ”
 
	gsÿÂ”
 = 
nuÎ
;

293 
	gŒy
 {

294 
	gsÿÂ”
 = 
Ãw
 
SÿÂ”
Òew 
Bufã»dR—d”
Òew 
IÅutSŒ—mR—d”
(
feSy¡em
.
İ’
(
¡©
.
g‘P©h
()))));

296 
	gsÿÂ”
.
hasNextLše
()) {

297 
SŒšg
 
	glše
 = 
sÿÂ”
.
ÃxtLše
();

298 
	gdiùiÚ¬y
.
add
(
lše
);

300 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

301 
throw
 
	ge
;

302 } 
	gfš®ly
 {

303 ià(
	gsÿÂ”
 !ğ
nuÎ
) {

304 
sÿÂ”
.
şo£
();

310 
´iv©e
 
lßdStİWÜds
(
SŒšg
 
¡İWÜdsP©h
è
throws
 
	gIOExû±iÚ
 {

312 
	gFeStus
[] 
	g¡©s
 = 
feSy¡em
.
li¡Stus
(
Ãw
 
P©h
(
¡İWÜdsP©h
));

313 
	g¡İWÜdsLi¡
 = 
Ãw
 
HashS‘
<
SŒšg
>();

315 
FeStus
 
	g¡©
 : 
¡©s
) {

316 
LOG
.
debug
(("Lßd stİ wÜds: " + 
¡©
.
g‘P©h
().
g‘Name
()));

318 
SÿÂ”
 
	gsÿÂ”
 = 
nuÎ
;

319 
	gŒy
 {

320 
	gsÿÂ”
 = 
Ãw
 
SÿÂ”
Òew 
Bufã»dR—d”
Òew 
IÅutSŒ—mR—d”
(
feSy¡em
.
İ’
(
¡©
.
g‘P©h
()))));

322 
	gsÿÂ”
.
hasNextLše
()) {

323 
SŒšg
 
	glše
 = 
sÿÂ”
.
ÃxtLše
();

324 
	g¡İWÜdsLi¡
.
add
(
lše
);

326 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

327 
throw
 
	ge
;

328 } 
	gfš®ly
 {

329 ià(
	gsÿÂ”
 !ğ
nuÎ
) {

330 
sÿÂ”
.
şo£
();

	@src/com/intel/hadoop/graphbuilder/types/DoubleType.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONAw¬e
;

27 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONV®ue
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

34 
public
 
şass
 
DoubËTy³
 
im¶em’ts
 
	gWr™abËCom·¿bË
<
	gDoubËTy³
>, 
	gM”g—bË
<DoubËTy³>, 
	gJSONAw¬e
,

35 
	gEnÿpsuÏ‹dObjeù
 {

36 
public
 
fš®
 
DoubËTy³
 
	gZERO
 = 
Ãw
 DoubleType(0);

37 
public
 
fš®
 
DoubËTy³
 
	gONE
 = 
Ãw
 DoubleType(1);

39 
public
 
DoubËTy³
() {

40 
	gv®
 = 0;

43 
public
 
DoubËTy³
(
i
) {

44 
	gv®
 = 
i
;

47 
public
 
g‘
() {

48  
	gv®
;

51 
public
 
Objeù
 
g‘Ba£Objeù
() {

52  
	gv®
;

55 
public
 
£t
(
i
) {

56 
	gv®
 = 
i
;

59 @
Ov”ride


60 
public
 
»adF›lds
(
D©aIÅut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

61 
	gv®
 = 
¬g0
.
»adDoubË
();

64 @
Ov”ride


65 
public
 
wr™e
(
D©aOuut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

66 
	g¬g0
.
wr™eDoubË
(
v®
);

69 @
Ov”ride


70 
public
 
SŒšg
 
toSŒšg
() {

71  
	gSŒšg
.
v®ueOf
(
v®
);

74 @
Ov”ride


75 
public
 
com·»To
(
DoubËTy³
 
¬g0
) {

76  ((
	gDoubË
è
	gv®
).
com·»To
(
¬g0
.
v®
);

79 @
Ov”ride


80 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

81 ià(
obj
 
š¡ªûof
 
	gDoubËTy³
) {

82  ((
	gDoubËTy³
è
	gobj
).
	gv®
 =ğ
v®
;

84  
	gçl£
;

88 @
Ov”ride


89 
public
 
hashCode
() {

90  ((
	gDoubË
è
	gv®
).
hashCode
();

93 @
Ov”ride


94 
public
 
add
(
DoubËTy³
 
Ùh”
) {

95 
	gv®
 +ğ
Ùh”
.
v®
;

98 
´iv©e
 
	gv®
;

100 @
Ov”ride


101 
public
 
SŒšg
 
toJSONSŒšg
() {

102  
	gJSONV®ue
.
toJSONSŒšg
(
v®
);

	@src/com/intel/hadoop/graphbuilder/types/EmptyType.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

31 
public
 
şass
 
Em±yTy³
 
im¶em’ts
 
	gWr™abË
, 
	gM”g—bË
<
	gEm±yTy³
>, 
	gEnÿpsuÏ‹dObjeù
 {

33 
public
 
fš®
 
Em±yTy³
 
	gINSTANCE
 = 
Ãw
 EmptyType();

35 @
Ov”ride


36 
public
 
»adF›lds
(
D©aIÅut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

39 @
Ov”ride


40 
public
 
wr™e
(
D©aOuut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

43 @
Ov”ride


44 
public
 
SŒšg
 
toSŒšg
() {

48 @
Ov”ride


49 
public
 
add
(
Em±yTy³
 
Ùh”
) {

52 
public
 
Objeù
 
g‘Ba£Objeù
() {

53  
	gINSTANCE
;

	@src/com/intel/hadoop/graphbuilder/types/EncapsulatedObject.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
public
 
š‹rçû
 
	gEnÿpsuÏ‹dObjeù
 {

23 
public
 
Objeù
 
g‘Ba£Objeù
();

	@src/com/intel/hadoop/graphbuilder/types/FloatType.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONAw¬e
;

27 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONV®ue
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

34 
public
 
şass
 
FlßtTy³
 
im¶em’ts
 
	gWr™abËCom·¿bË
<
	gFlßtTy³
>, 
	gM”g—bË
<FlßtTy³>, 
	gJSONAw¬e
, 
	gEnÿpsuÏ‹dObjeù
 {

36 
public
 
fš®
 
FlßtTy³
 
	gZERO
 = 
Ãw
 FloatType(0);

37 
public
 
fš®
 
FlßtTy³
 
	gONE
 = 
Ãw
 FloatType(1);

39 
public
 
FlßtTy³
() {

40 
	gv®
 = 0;

43 
public
 
FlßtTy³
(
i
) {

44 
	gv®
 = 
i
;

47 
public
 
g‘
() {

48  
	gv®
;

51 
public
 
Objeù
 
g‘Ba£Objeù
() {

52  
	gv®
;

55 
public
 
£t
(
i
) {

56 
	gv®
 = 
i
;

59 @
Ov”ride


60 
public
 
»adF›lds
(
D©aIÅut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

61 
	gv®
 = 
¬g0
.
»adFlßt
();

64 @
Ov”ride


65 
public
 
wr™e
(
D©aOuut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

66 
	g¬g0
.
wr™eFlßt
(
v®
);

69 @
Ov”ride


70 
public
 
SŒšg
 
toSŒšg
() {

71  
	gSŒšg
.
v®ueOf
(
v®
);

74 @
Ov”ride


75 
public
 
com·»To
(
FlßtTy³
 
¬g0
) {

76  ((
	gFlßt
è
	gv®
).
com·»To
(
¬g0
.
v®
);

79 @
Ov”ride


80 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

81 ià(
obj
 
š¡ªûof
 
	gFlßtTy³
) {

82  ((
	gFlßtTy³
è
	gobj
).
	gv®
 =ğ
v®
;

84  
	gçl£
;

88 @
Ov”ride


89 
public
 
hashCode
() {

90  ((
	gFlßt
è
	gv®
).
hashCode
();

93 @
Ov”ride


94 
public
 
add
(
FlßtTy³
 
Ùh”
) {

95 
	gv®
 +ğ
Ùh”
.
v®
;

98 
´iv©e
 
	gv®
;

100 @
Ov”ride


101 
public
 
SŒšg
 
toJSONSŒšg
() {

102  
	gJSONV®ue
.
toJSONSŒšg
(
v®
);

	@src/com/intel/hadoop/graphbuilder/types/IntType.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONAw¬e
;

27 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONV®ue
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

34 
public
 
şass
 
IÁTy³
 
im¶em’ts
 
	gWr™abËCom·¿bË
<
	gIÁTy³
>, 
	gM”g—bË
<IÁTy³>, 
	gJSONAw¬e
, 
	gEnÿpsuÏ‹dObjeù
 {

36 
public
 
fš®
 
IÁTy³
 
	gZERO
 = 
Ãw
 IntType(0);

37 
public
 
fš®
 
IÁTy³
 
	gONE
 = 
Ãw
 IntType(1);

39 
public
 
IÁTy³
() {

40 
	gv®
 = 0;

43 
public
 
IÁTy³
(
i
) {

44 
	gv®
 = 
i
;

47 @
Ov”ride


48 
public
 
»adF›lds
(
D©aIÅut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

49 
	gv®
 = 
¬g0
.
»adIÁ
();

52 @
Ov”ride


53 
public
 
wr™e
(
D©aOuut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

54 
	g¬g0
.
wr™eIÁ
(
v®
);

57 @
Ov”ride


58 
public
 
SŒšg
 
toSŒšg
() {

59  
	gSŒšg
.
v®ueOf
(
v®
);

62 @
Ov”ride


63 
public
 
com·»To
(
IÁTy³
 
¬g0
) {

64  ((
	gIÁeg”
è
	gv®
).
com·»To
(
¬g0
.
v®
);

67 @
Ov”ride


68 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

69 ià(
obj
 
š¡ªûof
 
	gIÁTy³
) {

70  ((
	gIÁTy³
è
	gobj
).
	gv®
 =ğ
v®
;

72  
	gçl£
;

76 @
Ov”ride


77 
public
 
hashCode
() {

78  
	gv®
;

81 
public
 
Objeù
 
g‘Ba£Objeù
() {

82  
	gv®
;

85 
public
 
g‘
() {

86  
	gv®
;

89 
public
 
£t
(
i
) {

90 
	gv®
 = 
i
;

93 
´iv©e
 
	gv®
;

95 @
Ov”ride


96 
public
 
add
(
IÁTy³
 
Ùh”
) {

97 
	gv®
 +ğ
Ùh”
.
v®
;

100 @
Ov”ride


101 
public
 
SŒšg
 
toJSONSŒšg
() {

102  
	gJSONV®ue
.
toJSONSŒšg
(
v®
);

	@src/com/intel/hadoop/graphbuilder/types/LongType.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONAw¬e
;

27 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONV®ue
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

34 
public
 
şass
 
LÚgTy³
 
im¶em’ts
 
	gWr™abËCom·¿bË
<
	gLÚgTy³
>, 
	gM”g—bË
<LÚgTy³>, 
	gJSONAw¬e
, 
	gEnÿpsuÏ‹dObjeù
 {

36 
public
 
LÚgTy³
() {

37 
	gthis
.
	gv®
 = 0;

40 
public
 
LÚgTy³
(
i
) {

41 
	gthis
.
	gv®
 = 
i
;

44 @
Ov”ride


45 
public
 
»adF›lds
(
D©aIÅut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

46 
	gv®
 = 
¬g0
.
»adLÚg
();

49 @
Ov”ride


50 
public
 
wr™e
(
D©aOuut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

51 
	g¬g0
.
wr™eLÚg
(
v®
);

54 @
Ov”ride


55 
public
 
com·»To
(
LÚgTy³
 
o
) {

56  ((
	gLÚg
è
	gv®
).
com·»To
(
o
.
v®
);

59 @
Ov”ride


60 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

62 ià(
obj
 
š¡ªûof
 
	gLÚgTy³
) {

63  ((
	gLÚgTy³
è
	gobj
).
	gv®
 =ğ
v®
;

65  
	gçl£
;

69 @
Ov”ride


70 
public
 
hashCode
() {

71  ((
	gLÚg
è
	gv®
).
hashCode
();

74 @
Ov”ride


75 
public
 
SŒšg
 
toSŒšg
() {

76  
	gSŒšg
.
v®ueOf
(
v®
);

79 
public
 
g‘
() {

80  
	gv®
;

83 
public
 
Objeù
 
g‘Ba£Objeù
() {

84  
	gv®
;

87 
public
 
£t
(
i
) {

88 
	gv®
 = 
i
;

91 
´iv©e
 
	gv®
;

93 @
Ov”ride


94 
public
 
add
(
LÚgTy³
 
Ùh”
) {

95 
	gv®
 +ğ
Ùh”
.
v®
;

98 @
Ov”ride


99 
public
 
SŒšg
 
toJSONSŒšg
() {

100  
	gJSONV®ue
.
toJSONSŒšg
(
v®
);

	@src/com/intel/hadoop/graphbuilder/types/Mergeable.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
public
 
š‹rçû
 
	gM”g—bË
<
	gT
> {

23 
add
(
T
 
Ùh”
);

	@src/com/intel/hadoop/graphbuilder/types/PropertyMap.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gM­Wr™abË
;

36 
public
 cÏs 
	cPrİ”tyM­
 
im¶em’ts
 
	mWr™abË


38 
´iv©e
 
M­Wr™abË
 
	m´İ”t›s
 = 
nuÎ
;

40 
public
 
	$Prİ”tyM­
() {

41 
this
.
´İ”t›s
 = 
Ãw
 
	`M­Wr™abË
();

44 
public
 
	$£tPrİ”ty
(
fš®
 
SŒšg
 
key
, fš® 
Wr™abË
 
v®ue
) {

45 
SŒšgTy³
 
keySŒ
 = 
Ãw
 
	`SŒšgTy³
(
key
);

46 
this
.
´İ”t›s
.
	`put
(
keySŒ
, 
v®ue
);

47 
	}
}

49 
public
 
Wr™abË
 
	$»movePrİ”ty
(
fš®
 
SŒšg
 
key
) {

50 
SŒšgTy³
 
keySŒ
 = 
Ãw
 
	`SŒšgTy³
(
key
);

51  
´İ”t›s
.
	`»move
(
keySŒ
);

52 
	}
}

54 
public
 
Wr™abË
 
	$g‘Prİ”ty
(
fš®
 
SŒšg
 
key
) {

55 
SŒšgTy³
 
keySŒ
 = 
Ãw
 
	`SŒšgTy³
(
key
);

56  
this
.
´İ”t›s
.
	`g‘
(
keySŒ
);

57 
	}
}

59 
public
 
	gS‘
<
	gWr™abË
> 
	$g‘Prİ”tyKeys
() {

60  
this
.
´İ”t›s
.
	`keyS‘
();

61 
	}
}

63 
public
 
	$m”gePrİ”t›s
(
Prİ”tyM­
 
´İ”tyM­
) {

64 
Wr™abË
 
key
 : 
´İ”tyM­
.
	`g‘Prİ”tyKeys
()) {

65 
this
.
	`£tPrİ”ty
(
key
.
	`toSŒšg
(), 
´İ”tyM­
.
	`g‘Prİ”ty
(key.toString()));

67 
	}
}

69 @
Ov”ride


70 
public
 
	$»adF›lds
(
D©aIÅut
 
š
è
throws
 
IOExû±iÚ
 {

71 
this
.
´İ”t›s
.
	`»adF›lds
(
š
);

72 
	}
}

74 @
Ov”ride


75 
public
 
	$wr™e
(
D©aOuut
 
out
è
throws
 
IOExû±iÚ
 {

76 
this
.
´İ”t›s
.
	`wr™e
(
out
);

77 
	}
}

80 @
Ov”ride


81 
public
 
	$hashCode
() {

82  
´İ”t›s
.
	`hashCode
();

83 
	}
}

85 @
Ov”ride


86 
public
 
SŒšg
 
	$toSŒšg
() {

88 
SŒšg
 
s
 = 
Ãw
 
	`SŒšg
("");

90 ià(!
´İ”t›s
.
	`isEm±y
())

92 
s
.
	`cÚÿt
("[" + "\t");

94 
M­
.
EÁry
<
Wr™abË
, Wr™abË> 
’Œy
 : 
´İ”t›s
.
	`’ŒyS‘
())

96 
s
 +ğ(
’Œy
.
	`g‘Key
(è+ ":" +ƒÁry.
	`g‘V®ue
()) + "\t";

99 
s
.
	`cÚÿt
("\t" + "]");

102  
s
;

103 
	}
}

	@src/com/intel/hadoop/graphbuilder/types/StringType.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gjava
.
	gio
.
	gD©aIÅut
;

23 
impÜt
 
	gjava
.
	gio
.
	gD©aOuut
;

24 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

26 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONAw¬e
;

27 
impÜt
 
	gÃt
.
	gmšidev
.
	gjsÚ
.
	gJSONV®ue
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abËCom·¿bË
;

35 
public
 
şass
 
SŒšgTy³
 
im¶em’ts
 
	gWr™abËCom·¿bË
<
	gSŒšgTy³
>, 
	gEnÿpsuÏ‹dObjeù
, 
	gJSONAw¬e
 {

37 
´iv©e
 
SŒšg
 
	g¡r
;

39 
public
 
SŒšgTy³
() {

40 
	gthis
.
	g¡r
 = "";

43 
public
 
SŒšgTy³
(
SŒšg
 
¡r
) {

44 
	gthis
.
	g¡r
 = 
¡r
;

47 @
Ov”ride


48 
public
 
»adF›lds
(
D©aIÅut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

49 
Text
 
	g‹xt
 = 
Ãw
 Text();

50 
	g‹xt
.
»adF›lds
(
¬g0
);

51 
	gthis
.
	g¡r
 = 
‹xt
.
toSŒšg
();

54 @
Ov”ride


55 
public
 
wr™e
(
D©aOuut
 
¬g0
è
throws
 
	gIOExû±iÚ
 {

56 
Ãw
 
Text
(
¡r
).
wr™e
(
¬g0
);

59 @
Ov”ride


60 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

61  (
obj
 
š¡ªûof
 
	gSŒšgTy³
è&& ((SŒšgTy³è
	gobj
).
	g¡r
.
equ®s
(
¡r
);

64 @
Ov”ride


65 
public
 
hashCode
() {

66  
	g¡r
.
hashCode
();

69 @
Ov”ride


70 
public
 
SŒšg
 
toSŒšg
() {

71  
	gthis
.
	g¡r
;

74 
public
 
SŒšg
 
g‘
() {

75  
	gthis
.
	g¡r
;

78 
public
 
Objeù
 
g‘Ba£Objeù
() {

79  
	gthis
.
	g¡r
;

82 
public
 
£t
(
SŒšg
 
s
) {

83 
	gthis
.
	g¡r
 = 
s
;

86 
public
 
boŞ—n
 
isEm±y
() {

87  (
	gthis
.
	g¡r
.
Ëngth
() == 0);

90 @
Ov”ride


91 
public
 
com·»To
(
SŒšgTy³
 
¬g0
) {

92  
	g¡r
.
com·»To
(
¬g0
.
¡r
);

95 @
Ov”ride


96 
public
 
SŒšg
 
toJSONSŒšg
() {

97  
	gJSONV®ue
.
toJSONSŒšg
(
¡r
);

	@src/com/intel/hadoop/graphbuilder/util/CommandLineInterface.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.*;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gut
.
	gG’”icO±iÚsP¬£r
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

26 
impÜt
 
	gjava
.
	gio
.
	gFe
;

27 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

28 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

29 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

38 
public
 cÏs 
	cCommªdLšeIÁ”çû
 {

40 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
CommªdLšeIÁ”çû
.
şass
);

41 
´iv©e
 
fš®
 
SŒšg
 
	mGENERIC_ERROR
 = "Error…arsing options";

42 
´iv©e
 
O±iÚs
 
	mİtiÚs
 = 
Ãw
 Options();

43 
´iv©e
 
CommªdLše
 
	mcmd
 = 
nuÎ
;

44 
´iv©e
 
RuÁimeCÚfig
 
	mruÁimeCÚfig
 = RuÁimeCÚfig.
g‘In¡ªû
();

45 
´iv©e
 
G’”icO±iÚsP¬£r
 
	mg’”icO±iÚsP¬£r
;

52 
public
 
boŞ—n
 
	$hasO±iÚ
(
SŒšg
 
İtiÚ
) {

53  
cmd
.
	`hasO±iÚ
(
İtiÚ
);

61 
public
 
SŒšg
 
	$g‘O±iÚV®ue
(
SŒšg
 
İtiÚ
) {

62  
cmd
.
	`g‘O±iÚV®ue
(
İtiÚ
);

63 
	}
}

70 
public
 
CommªdLše
 
	$·r£Args
(
SŒšg
[] 
¬gs
) {

72 
i
 = 0; i < 
¬gs
.
Ëngth
;i++) {

73 ià(
¬gs
[
i
].
	`equ®s
("-conf")) {

74 ià(
i
 + 1 =ğ
¬gs
.
Ëngth
) {

75 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

76 "-cÚà¬gum’ˆgiv’ buˆnØf·th s³cif›d!", 
LOG
);

77 } ià(!
Ãw
 
	`Fe
(
¬gs
[
i
+1]).
	`exi¡s
()) {

78 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
CANNOT_FIND_CONFIG_FILE
,

79 "CÚfigu¿tiÚ f" + 
¬gs
[
i
+1] + " cªnÙ bfound.", 
LOG
);

86 
Œy
 {

87 
g’”icO±iÚsP¬£r
 = 
Ãw
 
	`G’”icO±iÚsP¬£r
(
¬gs
);

88 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

90 
	`showH–p
("Error…arsing hadoop generic options.");

95 
ruÁimeCÚfig
.
	`lßdCÚfig
(
g’”icO±iÚsP¬£r
.
	`g‘CÚfigu¿tiÚ
());

99 
CommªdLšeP¬£r
 
·r£r
 = 
Ãw
 
	`PosixP¬£r
();

101 
Œy
 {

103 
cmd
 = 
·r£r
.
	`·r£
(
İtiÚs
, 
g’”icO±iÚsP¬£r
.
	`g‘RemaššgArgs
());

105 
	`ÿtch
 (
P¬£Exû±iÚ
 
e
){

106 if(
e
 
š¡ªûof
 
UÄecognizedO±iÚExû±iÚ
){

107 
	`showH–pMissšgO±iÚ
(
	`g‘UÄecognizedO±iÚFromExû±iÚ
(
e
));

109 }if(
e
 
š¡ªûof
 
MissšgO±iÚExû±iÚ
){

110 
	`showH–pO±iÚ
(
	`g‘Fœ¡MissšgO±iÚFromExû±iÚ
(
e
));

111 }if(
e
 
š¡ªûof
 
MissšgArgum’tExû±iÚ
){

112 
	`showH–pMissšgArgum’t
(
	`g‘MissšgArgum’tFromExû±iÚ
(
e
));

114 
	`showH–p
("Error…arsing option string.");

117  
cmd
;

118 
	}
}

124 
public
 
	$checkCli
(
SŒšg
[] 
¬gs
) {

125 
	`·r£Args
(
¬gs
);

126 
İtiÚs
.
	`g‘RequœedO±iÚs
().
	`™”©Ü
();

127 
Li¡
<
SŒšg
> 
İts
 = 
İtiÚs
.
	`g‘RequœedO±iÚs
();

128  
SŒšg
 
İtiÚ
: 
İts
){

129 ià(!
cmd
.
	`hasO±iÚ
(
İtiÚ
)) {

130 
	`showH–pO±iÚ
(
İtiÚ
);

133 
	`showO±iÚP¬£d
(
İtiÚ
);

136 
	}
}

142 
public
 
G’”icO±iÚsP¬£r
 
	$g‘G’”icO±iÚsP¬£r
() {

143  
g’”icO±iÚsP¬£r
;

144 
	}
}

150 
public
 
	$showO±iÚP¬£d
(
SŒšg
 
İtiÚ
){

151 
LOG
.
	`šfo
(
SŒšg
.
	`fÜm©
("%s: %s", 
İtiÚs
.
	`g‘O±iÚ
(
İtiÚ
).
	`g‘LÚgO±
(), 
cmd
.
	`g‘O±iÚV®ue
(option) ));

152 
	}
}

157 
public
 
	$showO±iÚsP¬£d
(){

158 
I‹¿tÜ
 
İtiÚss
 = 
İtiÚs
.
	`g‘O±iÚs
().
	`™”©Ü
();

159  
İtiÚss
.
	`hasNext
()){

160 
O±iÚ
 
toPršt
 = (O±iÚè
İtiÚss
.
	`Ãxt
();

161 ià(
cmd
.
	`hasO±iÚ
(
toPršt
.
	`g‘O±
())) {

162 
	`showO±iÚP¬£d
(
toPršt
.
	`g‘O±
());

165 
	}
}

171 
public
 
	$showH–p
(
SŒšg
 
mes§ge
){

172 
	`_showH–p
(
mes§ge
);

173 
	}
}

175 
´iv©e
 
	$showH–pMissšgArgum’t
(
SŒšg
 
İtiÚ
){

176 
SŒšg
 
”rÜ
 = 
GENERIC_ERROR
;

177 ifĞ
İtiÚ
 !ğ
nuÎ
){

178 
”rÜ
 = 
SŒšg
.
	`fÜm©
("O±iÚ -% --% % i missšg it' ¬gum’t", 
İtiÚs
.
	`g‘O±iÚ
(
İtiÚ
).
	`g‘O±
(),

179 
İtiÚs
.
	`g‘O±iÚ
(
İtiÚ
).
	`g‘LÚgO±
(), o±iÚs.g‘O±iÚ(İtiÚ).
	`g‘DesütiÚ
());

181 
	`_showH–p
(
”rÜ
);

182 
	}
}

184 
´iv©e
 
	$showH–pMissšgO±iÚ
(
SŒšg
 
İtiÚ
){

185 
SŒšg
 
”rÜ
 = 
GENERIC_ERROR
;

186 ifĞ
İtiÚ
 !ğ
nuÎ
){

187 
”rÜ
 = 
SŒšg
.
	`fÜm©
("O±iÚ -% nÙ„ecognized", 
İtiÚ
);

189 
	`_showH–p
(
”rÜ
);

190 
	}
}

192 
´iv©e
 
	$showH–pO±iÚ
(
SŒšg
 
İtiÚ
) {

193 
SŒšg
 
”rÜ
 = 
GENERIC_ERROR
;

194 ifĞ
İtiÚ
 !ğ
nuÎ
){

195 
”rÜ
 = 
SŒšg
.
	`fÜm©
("O±iÚ -% --% % i missšg", 
İtiÚs
.
	`g‘O±iÚ
(
İtiÚ
).
	`g‘O±
(),

196 
İtiÚs
.
	`g‘O±iÚ
(
İtiÚ
).
	`g‘LÚgO±
(), o±iÚs.g‘O±iÚ(İtiÚ).
	`g‘DesütiÚ
());

198 
	`_showH–p
(
”rÜ
);

199 
	}
}

201 
´iv©e
 
	$_showH–p
(
SŒšg
 
”rÜ
){

202 if(
”rÜ
.
	`Œim
().
	`Ëngth
() > 0){

203 
LOG
.
	`çl
(
”rÜ
);

205 
H–pFÜm©‹r
 
h
 = 
Ãw
 
	`H–pFÜm©‹r
();

206 
h
.
	`´štH–p
(
”rÜ
, 
İtiÚs
);

207 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
BAD_COMMAND_LINE
,

208 "UÇbËØ´oûs commªd†še.", 
LOG
);

209 
	}
}

211 
public
 
	$£tO±iÚs
(
O±iÚs
 
İtiÚs
) {

212 
this
.
İtiÚs
 = options;

213 
	}
}

215 
public
 
	$£tO±iÚ
(
O±iÚ
 
İtiÚ
) {

216 
this
.
İtiÚs
.
	`addO±iÚ
(
İtiÚ
);

217 
	}
}

220 
public
 
RuÁimeCÚfig
 
	$g‘RuÁimeCÚfig
() {

221  
ruÁimeCÚfig
;

222 
	}
}

224 
public
 
O±iÚs
 
	$g‘O±iÚs
() {

225  
İtiÚs
;

226 
	}
}

228 
public
 
CommªdLše
 
	$g‘Cmd
() {

229  
cmd
;

230 
	}
}

238 
public
 
boŞ—n
 
	$lookFÜO±iÚExû±iÚ
(
P¬£Exû±iÚ
 
e
, 
SŒšg
 
İtiÚ
) {

239 
MissšgO±iÚExû±iÚ
 
missšgO±iÚs
 = (MissšgO±iÚExû±iÚè
e
;

241 
šdex
 = 0; index < 
missšgO±iÚs
.
	`g‘MissšgO±iÚs
().
	`size
(); index++) {

243 
SŒšg
 
checkO±iÚ
 = (SŒšgè
missšgO±iÚs
.
	`g‘MissšgO±iÚs
().
	`g‘
(
šdex
);

245 ià(
checkO±iÚ
.
	`equ®s
(
İtiÚ
)è 
Œue
;

247  
çl£
;

248 
	}
}

254 
public
 
SŒšg
 
	$g‘MissšgArgum’tFromExû±iÚ
(
P¬£Exû±iÚ
 
ex
){

255 
MissšgArgum’tExû±iÚ
 
missšgArgum’tExû±iÚ
;

257 
Œy
{

258 
missšgArgum’tExû±iÚ
 = (
MissšgArgum’tExû±iÚ
è
ex
;

259 } 
	`ÿtch
 (
CÏssCa¡Exû±iÚ
 
e
){

260  
nuÎ
;

263 if(
missšgArgum’tExû±iÚ
.
	`g‘O±iÚ
(è!ğ
nuÎ
 ){

264  
missšgArgum’tExû±iÚ
.
	`g‘O±iÚ
().
	`g‘O±
();

266  
nuÎ
;

268 
	}
}

276 
public
 
SŒšg
 
	$g‘UÄecognizedO±iÚFromExû±iÚ
(
P¬£Exû±iÚ
 
ex
){

277 
UÄecognizedO±iÚExû±iÚ
 
uÄecognizedO±iÚ
;

279 
Œy
{

280 
uÄecognizedO±iÚ
 = (
UÄecognizedO±iÚExû±iÚ
è
ex
;

281 } 
	`ÿtch
 (
CÏssCa¡Exû±iÚ
 
e
){

282  
nuÎ
;

285 if(
uÄecognizedO±iÚ
.
	`g‘O±iÚ
(è!ğ
nuÎ
 ){

286  
uÄecognizedO±iÚ
.
	`g‘O±iÚ
();

288  
nuÎ
;

290 
	}
}

297 
public
 
SŒšg
 
	$g‘Fœ¡MissšgO±iÚFromExû±iÚ
(
P¬£Exû±iÚ
 
ex
){

298 
MissšgO±iÚExû±iÚ
 
missšgO±iÚs
;

300 
Œy
{

301 
missšgO±iÚs
 = (
MissšgO±iÚExû±iÚ
è
ex
;

302 } 
	`ÿtch
 (
CÏssCa¡Exû±iÚ
 
e
){

303  
nuÎ
;

306 if(
missšgO±iÚs
.
	`g‘MissšgO±iÚs
().
	`size
() > 0 ){

307  (
SŒšg
è
missšgO±iÚs
.
	`g‘MissšgO±iÚs
().
	`g‘
(0);

310  
nuÎ
;

313 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/Filter.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

27 
public
 
ab¡¿ù
 cÏs 
	cF‹r
 {

28 
ab¡¿ù
 
SŒšg
 
´oûss
(SŒšg 
s
);

30 
F‹r
 
	$­³nd
(
fš®
 
F‹r
 
f
) {

31  
Ãw
 
	`F‹r
() {

32 @
Ov”ride


33 
SŒšg
 
	`´oûss
(SŒšg 
s
) {

34  
	`´oûss
(
f
.´oûss(
s
));

38 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/Functional.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

33 
public
 
š‹rçû
 
	gFunùiÚ®
<
	gT1
, 
T2
 
ex‹nds
 
	gWr™abË
> {

35 
public
 cÏs 
	cFunùiÚ®CÚfigu¿tiÚE¼Ü
 
ex‹nds
 
	gRuÁimeExû±iÚ
 {

36 
public
 
FunùiÚ®CÚfigu¿tiÚE¼Ü
() {}

38 
public
 
FunùiÚ®CÚfigu¿tiÚE¼Ü
(
SŒšg
 
mes§ge
)

40 
su³r
(
mes§ge
);

43 
	$cÚfigu»
(
CÚfigu¿tiÚ
 
cÚfigu¿tiÚ
è
throws
 
FunùiÚ®CÚfigu¿tiÚE¼Ü
;

45 
T2
 
	`»duû
(
T1
 
a
, T2 
b
);

47 
CÏss
<
T1
> 
	`g‘InTy³
();

49 
CÏss
<
T2
> 
	`g‘OutTy³
();

51 
T2
 
	`id’t™yV®ue
();

52 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/GraphBuilderExit.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

24 
public
 cÏs 
	cG¿phBud”Ex™
 {

26 
public
 
	$g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
 
¡©usCode
, 
SŒšg
 
mes§ge
, 
Logg”
 
log
, 
Exû±iÚ
 
e
) {

27 
log
.
	`çl
(
mes§ge
);

28 
Sy¡em
.
”r
.
	`´šn
(
mes§ge
);

29 
Sy¡em
.
”r
.
	`´šn
(
¡©usCode
.
	`g‘Mes§ge
());

30 
Sy¡em
.
”r
.
	`´šn
(
e
.
	`g‘Mes§ge
());

31 
e
.
	`´štSckT¿û
(
Sy¡em
.
”r
);

32 
Sy¡em
.
	`ex™
(
¡©usCode
.
	`g‘Stus
());

35 
public
 
	$g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
 
¡©usCode
, 
SŒšg
 
mes§ge
, 
Logg”
 
log
) {

36 
log
.
	`çl
(
mes§ge
);

37 
Sy¡em
.
”r
.
	`´šn
(
mes§ge
);

38 
Sy¡em
.
”r
.
	`´šn
(
¡©usCode
.
	`g‘Mes§ge
());

39 
Sy¡em
.
	`ex™
(
¡©usCode
.
	`g‘Stus
());

40 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/GraphDatabaseConnector.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gouut
.
	gt™ª
.
	gT™ªCÚfig
;

23 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªFaùÜy
;

24 
impÜt
 
	gcom
.
	gthškau»lius
.
	gt™ª
.
	gcÜe
.
	gT™ªG¿ph
;

25 
impÜt
 
	gcom
.
	gtšk”pİ
.
	gblu•ršts
.
	gG¿ph
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gcÚfigu¿tiÚ
.
	gBa£CÚfigu¿tiÚ
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

33 
public
 cÏs 
	cG¿phD©aba£CÚÃùÜ
 {

35 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
G¿phD©aba£CÚÃùÜ
.
şass
);

36 
´iv©e
 
RuÁimeCÚfig
 
	mruÁimeCÚfig
 = RuÁimeCÚfig.
g‘In¡ªû
();

46 
public
 
T™ªG¿ph
 
	$İ’
(
SŒšg
 
g¿phDB
, 
Üg
.
­ache
.
commÚs
.
cÚfigu¿tiÚ
.
CÚfigu¿tiÚ
 configuration,

47 
Üg
.
­ache
.
hadoİ
.
cÚf
.
CÚfigu¿tiÚ
 
hadoİCÚfig
)

48 
throws
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
, 
NuÎPoš‹rExû±iÚ
 {

50 
ruÁimeCÚfig
.
	`lßdCÚfig
(
hadoİCÚfig
);

52 ià("t™ª".
	`equ®s
(
g¿phDB
)) {

54 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("¡Üage.back’d", 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_BACKEND"));

55 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("¡Üage.ho¡Çme", 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_HOSTNAME"));

56 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("¡Üage.bËÇme", 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_TABLENAME"));

57 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("¡Üage.pÜt", 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_PORT"));

59 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("storage.connection-timeout",

60 
T™ªCÚfig
.
cÚfig
.
	`g‘Prİ”ty
("TITAN_STORAGE_CONNECTION_TIMEOUT"));

62 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("ids.block-size", "50000");

63 
cÚfigu¿tiÚ
.
	`£tPrİ”ty
("storage.batch-loading", "true");

65  
T™ªFaùÜy
.
	`İ’
(
cÚfigu¿tiÚ
);

67 } ià("®Ëgrog¿ph".
	`equ®s
(
g¿phDB
)) {

68 
LOG
.
	`çl
("GRAPHBUILDER ERROR: Allegrograph‚ot supported yet");

69 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

70 } ià("Ão4j".
	`equ®s
(
g¿phDB
)) {

71 
LOG
.
	`çl
("GRAPHBUILDER ERROR:‚eo4j‚ot supported yet");

72 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

73 }ià(
nuÎ
 =ğ
g¿phDB
) {

74 
LOG
.
	`çl
("GRAPHBUILDER ERROR: Cannot create‡‚ull graph. Please specifyitan |‡llegrograph |‚eo4j");

75 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
();

77  
nuÎ
;

80 
public
 
	$checkT™ªIn¡®ÏtiÚ
() {

81 
Ba£CÚfigu¿tiÚ
 
c
 = 
Ãw
 
	`Ba£CÚfigu¿tiÚ
();

82 
G¿ph
 
g
 = 
nuÎ
;

84 
Œy
 {

85 
g
 = 
G¿phD©aba£CÚÃùÜ
.
	`İ’
("t™ª", 
c
, 
nuÎ
);

86 ià(
g
 =ğ
nuÎ
) {

87 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
TITAN_ERROR
,

88 "UÇbËØcÚÃùØT™ª", 
LOG
);

90 } 
	`ÿtch
 (
UnsuµÜ‹dO³¿tiÚExû±iÚ
 
e
) {

91 
LOG
.
	`çl
("GRAPHBUILDER ERROR: Unableo open graph database");

92 } 
	`ÿtch
 (
NuÎPoš‹rExû±iÚ
 
e
) {

93 
LOG
.
	`çl
("GRAPHBUILDER ERROR:‡ttempto open graph database using‚ull…arameter string");

95 
fš®ly
 {

96 
g
.
	`shutdown
();

98 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/HBaseUtils.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gGBHTabËCÚfigu¿tiÚ
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.*;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.*;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gText
;

28 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gReduûr
;

29 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

31 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

38 
public
 cÏs 
	cHBa£Uts
 {

40 
´iv©e
 
HBa£Uts
 
	muniqueIn¡ªûOfHBa£Uts
 = 
nuÎ
;

42 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
HBa£Uts
.
şass
);

44 
´iv©e
 
CÚfigu¿tiÚ
 
	mcÚfigu¿tiÚ
;

45 
´iv©e
 
HBa£Admš
 
	madmš
;

46 
´iv©e
 
SŒšg
 
	mhTabËName
;

47 
´iv©e
 
HTabË
 
	mhTabË
;

54 
´iv©e
 
	$HBa£Uts
(è
throws
 
IOExû±iÚ
 {

55 
this
.
cÚfigu¿tiÚ
 = 
HBa£CÚfigu¿tiÚ
.
	`ü—‹
();

56 
this
.
admš
 = 
Ãw
 
	`HBa£Admš
(
cÚfigu¿tiÚ
);

64 
´iv©e
 
	$HBa£Uts
(
SŒšg
 
bËName
è
throws
 
IOExû±iÚ
 {

65 
this
.
cÚfigu¿tiÚ
 = 
HBa£CÚfigu¿tiÚ
.
	`ü—‹
();

66 
this
.
hTabËName
 = 
bËName
;

67 
this
.
hTabË
 = 
Ãw
 
	`HTabË
(
cÚfigu¿tiÚ
, 
hTabËName
);

68 
	}
}

77 
public
 
synchrÚized
 
HBa£Uts
 
	$g‘In¡ªû
(è
throws
 
IOExû±iÚ
 {

79 ià(
uniqueIn¡ªûOfHBa£Uts
 =ğ
nuÎ
) {

80 
uniqueIn¡ªûOfHBa£Uts
 = 
Ãw
 
	`HBa£Uts
();

83  
uniqueIn¡ªûOfHBa£Uts
;

84 
	}
}

89 
public
 
CÚfigu¿tiÚ
 
	$g‘NewCÚfigu¿tiÚ
() {

90  
HBa£CÚfigu¿tiÚ
.
	`ü—‹
();

91 
	}
}

99 
public
 
	gby‹
[][] 
	$·r£CŞumnName
(
SŒšg
 
cŞumnName
) {

100  
KeyV®ue
.
	`·r£CŞumn
(
By‹s
.
	`toBy‹s
(
cŞumnName
));

101 
	}
}

110 
public
 
	gby‹
[] 
	$g‘CŞumnD©a
(
ResuÉ
 
cŞumns
, 
SŒšg
 
fuÎCŞumnName
) {

111 
by‹
[][] 
cŞumnKey
 = 
HBa£Uts
.
	`·r£CŞumnName
(
fuÎCŞumnName
);

113 ià(
cŞumnKey
.
Ëngth
 < 2) {

114  
nuÎ
;

119  
cŞumns
.
	`g‘V®ue
(
cŞumnKey
[0], columnKey[1]);

120 
	}
}

131 
public
 
	gby‹
[] 
	$g‘CŞumnD©a
(
SŒšg
 
Key
, SŒšg 
cŞFamyName
, SŒšg 
cŞName
)

132 
throws
 
IOExû±iÚ
, 
Numb”FÜm©Exû±iÚ
 {

134 
by‹
[] 
rowKey
 = 
By‹s
.
	`toBy‹s
(
Key
);

135 
G‘
 
g‘RowD©a
 = 
Ãw
 
	`G‘
(
rowKey
);

136 
ResuÉ
 
»s
 = 
hTabË
.
	`g‘
(
g‘RowD©a
);

138  
»s
.
	`g‘V®ue
(
By‹s
.
	`toBy‹s
(
cŞFamyName
), By‹s.toBy‹s(
cŞName
));

139 
	}
}

151 
public
 
	gby‹
[] 
	$putV®ue
(
by‹
[] 
key
,

152 
by‹
[] 
cŞumnFamy
,

153 
by‹
[] 
cŞumnQu®if›r
,

154 
by‹
[] 
v®ue
,

155 
Reduûr
.
CÚ‹xt
 
cÚ‹xt
è
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

156 
Put
 
put
 = 
Ãw
 
	`Put
(
key
);

157 
put
.
	`add
(
cŞumnFamy
, 
cŞumnQu®if›r
, 
v®ue
);

158 
cÚ‹xt
.
	`wr™e
(
Ãw
 
	`Text
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”ty
("NULLKEY")), 
put
);

159  
v®ue
;

160 
	}
}

168 
public
 
boŞ—n
 
	$bËExi¡s
(
SŒšg
 
hTabËName
è
throws
 
IOExû±iÚ
 {

169  
admš
.
	`bËExi¡s
(
hTabËName
);

170 
	}
}

179 
public
 
boŞ—n
 
	$bËCÚšsCŞumnFamy
(
SŒšg
 
hTabËName
, SŒšg 
cŞumnFamyName
è
throws
 
IOExû±iÚ
 {

180 
HTabËDesütÜ
 
htd
 = 
admš
.
	`g‘TabËDesütÜ
(
hTabËName
.
	`g‘By‹s
());

181  
htd
.
	`hasFamy
(
cŞumnFamyName
.
	`g‘By‹s
());

182 
	}
}

191 
public
 
boŞ—n
 
	$cŞumnHasV®idFamy
Ğ
SŒšg
 
fuÎCŞumnName
, SŒšg 
bËName
) {

193 
boŞ—n
 
»tuºV®ue
 = 
çl£
;

195 ià(
fuÎCŞumnName
.
	`cÚšs
(":")) {

196 
SŒšg
 
cŞumnFamyName
 = 
fuÎCŞumnName
.
	`¥l™
(":")[0];

197 
Œy
 {

198 
»tuºV®ue
 = 
	`bËCÚšsCŞumnFamy
(
bËName
, 
cŞumnFamyName
);

199 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

200 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™Exû±iÚ
(
StusCode
.
UNHANDLED_IO_EXCEPTION
,

201 "GRAPHBUILDER FAILURE: unhªdËd IOƒxû±iÚ whv®id©šg cŞumÀçmy w™h hba£.", 
LOG
, 
e
);

205  
»tuºV®ue
;

206 
	}
}

212 
public
 
CÚfigu¿tiÚ
 
	$g‘CÚfigu¿tiÚ
() {

213  
this
.
cÚfigu¿tiÚ
;

214 
	}
}

223 
public
 
Sÿn
 
	$ü—‹TabË
(
SŒšg
 
hTabËName
, SŒšg[] 
hTabËCŞumnFam›s
è
throws
 
IOExû±iÚ
 {

225 
Sÿn
 
sÿn
 = 
	`g‘TabËSÿÂ”
(
hTabËName
);

229 ià(
admš
.
	`bËExi¡s
(
this
.
hTabËName
)) {

231 
admš
.
	`di§bËTabË
(
this
.
hTabËName
);

233 ià(
admš
.
	`isTabËDi§bËd
(
this
.
hTabËName
)) {

234 
admš
.
	`d–‘eTabË
(
this
.
hTabËName
);

236 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
HBASE_ERROR
,

237 "GRAPHBUILDER ERROR: UÇbËØd–‘exi¡šgabË " + 
this
.
hTabËName
 + ". Please delete it",

238 
LOG
);

242 
HTabËDesütÜ
 
htd
 = 
Ãw
 
	`HTabËDesütÜ
(
this
.
hTabËName
);

244 
SŒšg
 
cŞDesc
 : 
hTabËCŞumnFam›s
) {

245 
HCŞumnDesütÜ
 
hcd
 = 
Ãw
 
	`HCŞumnDesütÜ
(
cŞDesc
);

246 
htd
.
	`addFamy
(
hcd
);

249 
admš
.
	`ü—‹TabË
(
htd
);

250 
LOG
.
	`šfo
("GRAPHBUILDER_INFO: " + 
this
.
hTabËName
 + "able created");

252 ià(!
admš
.
	`bËExi¡s
(
this
.
hTabËName
)) {

253 
throw
 
Ãw
 
	`IOExû±iÚ
("GRAPHBUILDER_ERROR: FaedØü—‹abË " + 
this
.
hTabËName
);

256  
sÿn
;

257 
	}
}

266 
public
 
Sÿn
 
	$ü—‹TabË
(
SŒšg
 
hTabËName
, SŒšg 
hTabËCŞumnFamy
è
throws
 
IOExû±iÚ
 {

268 
Sÿn
 
sÿn
 = 
	`g‘TabËSÿÂ”
(
hTabËName
);

272 ià(
admš
.
	`bËExi¡s
(
this
.
hTabËName
)) {

274 
admš
.
	`di§bËTabË
(
this
.
hTabËName
);

276 ià(
admš
.
	`isTabËDi§bËd
(
this
.
hTabËName
)) {

277 
admš
.
	`d–‘eTabË
(
this
.
hTabËName
);

279 
G¿phBud”Ex™
.
	`g¿phbud”F©®Ex™NoExû±iÚ
(
StusCode
.
HBASE_ERROR
,

280 "GRAPHBUILDER ERROR: UÇbËØd–‘exi¡šgabË " + 
this
.
hTabËName
 + ". Please delete it",

281 
LOG
);

285 
HTabËDesütÜ
 
htd
 = 
Ãw
 
	`HTabËDesütÜ
(
this
.
hTabËName
);

286 
HCŞumnDesütÜ
 
hcd
 = 
Ãw
 
	`HCŞumnDesütÜ
(
hTabËCŞumnFamy
);

288 
htd
.
	`addFamy
(
hcd
);

290 
admš
.
	`ü—‹TabË
(
htd
);

292 
LOG
.
	`šfo
("GRAPHBUILDER_INFO: " + 
this
.
hTabËName
 + "able created");

294 ià(!
admš
.
	`bËExi¡s
(
this
.
hTabËName
)) {

295 
throw
 
Ãw
 
	`IOExû±iÚ
("GRAPHBUILDER ERROR: FaedØü—‹abË " + 
this
.
hTabËName
);

298  
sÿn
;

299 
	}
}

306 
public
 
Sÿn
 
	$g‘TabËSÿÂ”
(
SŒšg
 
bËName
) {

307 
this
.
hTabËName
 = 
bËName
;

308 
Sÿn
 
sÿn
 = 
Ãw
 
	`Sÿn
();

310 
sÿn
.
	`£tCachšg
(
GBHTabËCÚfigu¿tiÚ
.
cÚfig
.
	`g‘Prİ”tyIÁ
("HBASE_CACHE_SIZE"));

311 
sÿn
.
	`£tCacheBlocks
(
çl£
);

313  
sÿn
;

314 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/HashUtil.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

27 
public
 cÏs 
	cHashUt
 {

34 
public
 
	$hashPaœ
(
Objeù
 
o1
, Objeù 
o2
) {

35  
	`combše
(combše(0, 
o1
), 
o2
);

38 
public
 
	$hashTrË
(
Objeù
 
o1
, Objeù 
o2
, Objeù 
o3
) {

39  
	`combše
(combše(combše(0, 
o1
), 
o2
),
o3
);

40 
	}
}

42 
´iv©e
 
	$combše
(
£ed
, 
Objeù
 
v®
) {

43  (è(
v®
.
	`hashCode
(è+ 0x9e3779b9 + (
£ed
 << 6) + (seed >> 2));

44 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/Pair.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

29 
public
 
şass
 
	gPaœ
<
	gL
, 
	gR
> {

37 
public
 
Paœ
(
L
 
l
, 
R
 
r
) {

38 
	gthis
.
	gl
 = 
l
;

39 
	gthis
.
	gr
 = 
r
;

45 
public
 
L
 
g‘L
() {

46  
	gl
;

52 
public
 
R
 
g‘R
() {

53  
	gr
;

60 
public
 
£tL
(
L
 
l
) {

61 
	gthis
.
	gl
 = 
l
;

68 
public
 
£tR
(
R
 
r
) {

69 
	gthis
.
	gr
 = 
r
;

75 
public
 
	gPaœ
<
	gR
, 
	gL
> 
»v”£
() {

76  
Ãw
 
	gPaœ
<
	gR
, 
	gL
>(
	gr
, 
	gl
);

79 @
Ov”ride


80 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

81 ià(
obj
 
š¡ªûof
 
	gPaœ
) {

82  ((
	gPaœ
è
	gobj
).
	gl
.
equ®s
(
l
è&& ((Paœèobj).
	gr
.equ®s(
r
);

84  
	gçl£
;

87 @
Ov”ride


88 
public
 
hashCode
() {

89  
	gHashUt
.
hashPaœ
(
l
, 
r
);

92 @
Ov”ride


93 
public
 
SŒšg
 
toSŒšg
() {

94  "(" + 
	gl
 + "," + 
	gr
 + ")";

97 
´iv©e
 
L
 
	gl
;

98 
´iv©e
 
R
 
	gr
;

	@src/com/intel/hadoop/graphbuilder/util/PassThruMapperIntegerKey.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

25 
public
 
şass
 
	gPassThruM­³rIÁeg”Key
<
	gVALUEIN
, 
	gKEYOUT
, 
	gVALUEOUT
>

26 
ex‹nds
 
	gM­³r
<
	gIÁWr™abË
, 
	gVALUEIN
, 
	gKEYOUT
, 
	gVALUEOUT
> {

	@src/com/intel/hadoop/graphbuilder/util/RuntimeConfig.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gG¿phCÚ¡ruùiÚP–še
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

26 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gReduûr
;

27 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

29 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

30 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

34 
public
 cÏs 
	cRuÁimeCÚfig
 {

35 
´iv©e
 
fš®
 
Logg”
 
	mLOG
 = Logg”.
g‘Logg”
(
RuÁimeCÚfig
.
şass
);

36 
´iv©e
 
RuÁimeCÚfig
 
	muniqueIn¡ªûOfRuÁimeCÚfig
 = 
nuÎ
;

37 
´iv©e
 
	mHashM­
<
	mSŒšg
, SŒšg> 
	mcÚfig
;

38 
´iv©e
 
CÚfigu¿tiÚ
 
	mhadoİCÚf
;

39 
´iv©e
 
Prİ”t›s
 
	m´İ”t›s
;

41 
public
 
synchrÚized
 
RuÁimeCÚfig
 
	$g‘In¡ªû
() {

42 
	`ü—‹In¡ªû
(
nuÎ
);

43  
uniqueIn¡ªûOfRuÁimeCÚfig
;

46 
public
 
synchrÚized
 
RuÁimeCÚfig
 
	$g‘In¡ªû
(
CÏss
 
kÏss
) {

47 
	`ü—‹In¡ªû
(
kÏss
);

48  
uniqueIn¡ªûOfRuÁimeCÚfig
;

49 
	}
}

51 
public
 
synchrÚized
 
	$ü—‹In¡ªû
(
CÏss
 
kÏss
){

52 ià(
uniqueIn¡ªûOfRuÁimeCÚfig
 =ğ
nuÎ
) {

53 if(
kÏss
 !ğ
nuÎ
){

54 
uniqueIn¡ªûOfRuÁimeCÚfig
 = 
Ãw
 
	`RuÁimeCÚfig
(
kÏss
);

56 
uniqueIn¡ªûOfRuÁimeCÚfig
 = 
Ãw
 
	`RuÁimeCÚfig
();

59 if(
kÏss
 !ğ
nuÎ
){

60 
uniqueIn¡ªûOfRuÁimeCÚfig
.
	`»æeùS‘CÚfigHash
(
kÏss
);

63 
	}
}

65 
´iv©e
 
	$š™Prİ”t›s
() {

66 ià(
´İ”t›s
 =ğ
nuÎ
) {

67 
´İ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

69 
	}
}

71 
´iv©e
 
	$š™CÚfig
() {

72 ià(
cÚfig
 =ğ
nuÎ
) {

73 
cÚfig
 = 
Ãw
 
HashM­
<
SŒšg
, String>();

74 
hadoİCÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

76 
	}
}

78 
´iv©e
 
	$RuÁimeCÚfig
() {

79 
	`š™Prİ”t›s
();

80 
	`š™CÚfig
();

81 
	}
}

83 
´iv©e
 
	$RuÁimeCÚfig
(
CÏss
 
kÏss
) {

84 
	`š™Prİ”t›s
();

85 
	`š™CÚfig
();

86 
	`»æeùS‘CÚfigHash
(
kÏss
);

87 
	}
}

89 
´iv©e
 
SŒšg
 
	$¥l™Key
(
SŒšg
 
key
) {

90 
SŒšg
[] 
ÇmeS·ûdKey
 = 
key
.
	`¥l™
("\\.");

91 ià(
ÇmeS·ûdKey
.
Ëngth
 > 0) {

92 
SŒšg
 
combšedKey
 = 
ÇmeS·ûdKey
[1].
	`toUµ”Ca£
();

93 
i
 = 2; i < 
ÇmeS·ûdKey
.
Ëngth
; i++) {

94 
combšedKey
 +ğ"_" + 
ÇmeS·ûdKey
[
i
].
	`toUµ”Ca£
();

96  
combšedKey
;

98  
nuÎ
;

100 
	}
}

102 
public
 
CÚfigu¿tiÚ
 
	$g‘HadoİCÚf
() {

103  
hadoİCÚf
;

104 
	}
}

106 
public
 
G¿phCÚ¡ruùiÚP–še
 
	$addCÚfig
(
G¿phCÚ¡ruùiÚP–še
 
cÚf
){

107 
M­
.
EÁry
<
SŒšg
, SŒšg> 
İtiÚ
 : 
hadoİCÚf
.
	`g‘V®ByRegex
("^g¿phbud”.").
	`’ŒyS‘
()){

108 
SŒšg
 
key
 = 
İtiÚ
.
	`g‘Key
();

109 
SŒšg
 
v®ue
 = 
İtiÚ
.
	`g‘V®ue
();

110 
cÚf
.
	`addU£rO±
(
key
, 
v®ue
);

112  
cÚf
;

113 
	}
}

115 
public
 
	$lßdCÚfig
(
Reduûr
.
CÚ‹xt
 
cÚ‹xt
){

116 
	`lßdCÚfig
(
cÚ‹xt
.
	`g‘CÚfigu¿tiÚ
());

117 
	}
}

118 
public
 
	$lßdCÚfig
(
M­³r
.
CÚ‹xt
 
cÚ‹xt
) {

119 
	`lßdCÚfig
(
cÚ‹xt
.
	`g‘CÚfigu¿tiÚ
());

120 
	}
}

122 
public
 
	$lßdCÚfig
(
CÚfigu¿tiÚ
 
cÚf
) {

123 ifĞ
cÚf
 !ğ
nuÎ
){

124 
M­
.
EÁry
<
SŒšg
, SŒšg> 
İtiÚ
 : 
cÚf
.
	`g‘V®ByRegex
("^g¿phbud”.").
	`’ŒyS‘
()) {

125 
SŒšg
 
key
 = 
İtiÚ
.
	`g‘Key
();

126 
SŒšg
 
v®ue
 = 
İtiÚ
.
	`g‘V®ue
();

127 
hadoİCÚf
.
	`£t
(
key
, 
v®ue
);

128 
cÚfig
.
	`put
(
	`¥l™Key
(
key
), 
v®ue
);

131 
	}
}

133 
public
 
IÁeg”
 
	$g‘Prİ”tyIÁ
(
SŒšg
 
´İ”ty
) {

134  
IÁeg”
.
	`·r£IÁ
(
´İ”t›s
.
	`g‘Prİ”ty
(
´İ”ty
, 
cÚfig
.
	`g‘
(property)));

135 
	}
}

137 
public
 
SŒšg
 
	$g‘Prİ”tySŒšg
(
SŒšg
 
´İ”ty
) {

138  
´İ”t›s
.
	`g‘Prİ”ty
(
´İ”ty
, 
cÚfig
.
	`g‘
(property));

139 
	}
}

141 
public
 
SŒšg
 
	$g‘Prİ”ty
(
SŒšg
 
´İ”ty
) {

142  
	`g‘Prİ”tySŒšg
(
´İ”ty
);

143 
	}
}

145 
´iv©e
 
	$»æeùS‘CÚfigHash
(
CÏss
 
kÏss
) {

146 
F›ld
 
f›ld
 : 
kÏss
.
	`g‘Deş¬edF›lds
()) {

147 
f›ld
.
	`£tAcûssibË
(
Œue
);

148 ià(
java
.
Ïng
.
»æeù
.
Modif›r
.
	`isStic
(
f›ld
.
	`g‘Modif›rs
())) {

149 
Objeù
 
v®ue
;

150 
Œy
 {

151 
v®ue
 = 
f›ld
.
	`g‘
(f›ld.
	`g‘Ty³
());

152 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

153 
v®ue
 = 
nuÎ
;

155 ià(
v®ue
 !ğ
nuÎ
 && !
cÚfig
.
	`cÚšsKey
(
f›ld
.
	`g‘Name
())) {

156 
cÚfig
.
	`put
(
f›ld
.
	`g‘Name
(), 
v®ue
.
	`toSŒšg
());

160 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/StatusCode.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
public
 
	eStusCode
 {

23 
SUCCESS
(0, "GRAPHBUILDER: success"),

24 
BAD_COMMAND_LINE
(1, "GRAPHBUILDER: bad command†ine"),

25 
UNABLE_TO_LOAD_INPUT_FILE
(2, "GRAPHBUILDER: unableo†oad input file"),

26 
UNHANDLED_IO_EXCEPTION
(3, "GRAPHBUILDER: unhandled IOƒxception"),

27 
MISSING_HBASE_TABLE
(4, "GRAPHBUILDER: missing hbaseable"),

28 
HADOOP_REPORTED_ERROR
(5, "GRAPHBUILDER: hadoop„eportedƒxception"),

29 
INTERNAL_PARSER_ERROR
(6, "GRAPHBUILDER: internal…arserƒrror"),

30 
UNABLE_TO_CONNECT_TO_HBASE
(7, "GRAPHBUILDER: unableo connecto hbase"),

31 
CLASS_INSTANTIATION_ERROR
(8, "GRAPHBUILDER: class instantiationƒrror"),

32 
INDESCRIBABLE_FAILURE
(9, "GRAPHBUILDER: failure"),

33 
HBASE_ERROR
(10, "GRAPHBUILDER: hbaseƒrror"),

34 
TITAN_ERROR
(11, "GRAPHBUILDER: Titanƒrror"),

35 
CANNOT_FIND_CONFIG_FILE
(12, "GRAPHBUILDER: cannot†ocate config file");

37 
´iv©e
 
fš®
 
	m¡©us
;

38 
´iv©e
 
fš®
 
SŒšg
 
	mmes§ge
;

40 
StusCode
(
¡©us
, 
SŒšg
 
mes§ge
) {

41 
	mthis
.
	m¡©us
 = 
¡©us
;

42 
	mthis
.
	mmes§ge
 = 
mes§ge
;

45 
public
 
g‘Stus
(){

46  
	m¡©us
;

49 
public
 
SŒšg
 
g‘Mes§ge
() {

50  
	mmes§ge
;

	@src/com/intel/hadoop/graphbuilder/util/Timer.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

27 
public
 cÏs 
	cTim”
 {

28 
´iv©e
 
	m¡¬t
;

29 
´iv©e
 
	mcu¼’t
;

34 
public
 
	$Tim”
() {

35 
¡¬t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

41 
public
 
	$¡¬t
() {

42 
cu¼’t
 = 
¡¬t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

43 
	}
}

48 
public
 
	$cu¼’t_time
() {

49 
cu¼’t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

50  (
cu¼’t
 - 
¡¬t
) / 1000;

51 
	}
}

56 
public
 
	$cu¼’t_time_mlis
() {

57 
cu¼’t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

58  
cu¼’t
 - 
¡¬t
;

59 
	}
}

64 
public
 
	$time_sšû_Ï¡
() {

65 
»t
 = (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
cu¼’t
) / 1000;

66 
cu¼’t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

67  
»t
;

68 
	}
}

73 
public
 
	$time_sšû_Ï¡_mlis
() {

74 
»t
 = (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
cu¼’t
);

75 
cu¼’t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

76  
»t
;

77 
	}
}

	@src/com/intel/hadoop/graphbuilder/util/Triple.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

32 
public
 
şass
 
	gTrË
<
	gA
, 
	gB
, 
	gC
> {

41 
public
 
TrË
(
A
 
a
, 
B
 
b
, 
C
 
c
) {

42 
	gthis
.
	ga
 = 
a
;

43 
	gthis
.
	gb
 = 
b
;

44 
	gthis
.
	gc
 = 
c
;

50 
public
 
A
 
g‘A
() {

51  
	gthis
.
	ga
;

57 
public
 
B
 
g‘B
() {

58  
	gthis
.
	gb
;

64 
public
 
C
 
g‘C
() {

65  
	gthis
.
	gc
;

72 
public
 
£tA
(
A
 
v®
) {

73 
	gthis
.
	ga
 = 
v®
;

80 
public
 
£tB
(
B
 
v®
) {

81 
	gthis
.
	gb
 = 
v®
;

88 
public
 
£tC
(
C
 
v®
) {

89 
	gthis
.
	gc
 = 
v®
;

95 
public
 
	gTrË
<
	gB
, 
	gA
, 
	gC
> 
sw­AB
() {

96  
Ãw
 
	gTrË
<
	gB
, 
	gA
, 
	gC
>(
	gb
, 
	ga
, 
	gc
);

99 @
Ov”ride


100 
public
 
boŞ—n
 
equ®s
(
Objeù
 
obj
) {

101 ià(
obj
 
š¡ªûof
 
	gTrË
) {

102 
TrË
 
	gt
 = (TrËè
obj
;

103  
	gObjeùs
.
equ®s
(
t
.
a
,a)

104 && 
	gObjeùs
.
equ®s
(
t
.
b
,b)

105 && 
	gObjeùs
.
equ®s
(
t
.
c
,c);

107  
	gçl£
;

110 @
Ov”ride


111 
public
 
hashCode
() {

112  
	gHashUt
.
hashTrË
(
a
, 
b
, 
c
);

115 @
Ov”ride


116 
public
 
SŒšg
 
toSŒšg
() {

117  "(" + 
	ga
 + ", " + 
	gb
 + ", " + 
	gc
 + ")";

120 
´iv©e
 
A
 
	ga
;

121 
´iv©e
 
B
 
	gb
;

122 
´iv©e
 
C
 
	gc
;

	@test/com/intel/hadoop/graphbuilder/graphelements/EdgeIDTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
.
	gTrË
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

25 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

26 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹F®£
;

27 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

28 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Same
;

30 
public
 cÏs 
	cEdgeIDTe¡
 {

31 @
Te¡


32 
public
 
fš®
 
	$‹¡G‘A
(è
throws
 
Exû±iÚ
 {

33 
TrË
<
IÁeg”
, IÁeg”, IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

35 
a
 = 
t
.
	`g‘A
();

36 
	`as£¹Equ®s
(
a
, 7);

39 @
Te¡


40 
public
 
fš®
 
	$‹¡CÚ¡ruùÜG‘
() {

41 
Objeù
 
¤c
 = 
Ãw
 
	`SŒšg
("src");

42 
Objeù
 
d¡
 = 
Ãw
 
	`SŒšg
("dst");

43 
Objeù
 
Ïb–
 = 
Ãw
 
	`SŒšg
("label");

45 
EdgeID
 
edgeID
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

47 
	`as£¹NÙNuÎ
(
edgeID
);

48 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
¤c
);

49 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
d¡
);

50 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

51 
	}
}

53 @
Te¡


54 
public
 
fš®
 
	$‹¡CÚ¡ruùÜG‘S‘
() {

55 
Objeù
 
¤c
 = 
Ãw
 
	`SŒšg
("src");

56 
Objeù
 
d¡
 = 
Ãw
 
	`SŒšg
("dst");

57 
Objeù
 
Ïb–
 = 
Ãw
 
	`SŒšg
("label");

59 
Objeù
 
Úe
 = 
Ãw
 
	`IÁeg”
(0);

60 
Objeù
 
two
 = 
Ãw
 
	`IÁeg”
(1);

61 
Objeù
 
th»e
 = 
Ãw
 
	`IÁeg”
(2);

63 
EdgeID
 
edgeID
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

65 
	`as£¹NÙNuÎ
(
edgeID
);

66 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
¤c
);

67 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
d¡
);

68 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

70 
edgeID
.
	`£tSrc
(
Úe
);

72 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
Úe
);

73 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
d¡
);

74 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

76 
edgeID
.
	`£tD¡
(
two
);

78 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
Úe
);

79 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
two
);

80 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

82 
edgeID
.
	`£tLab–
(
th»e
);

84 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
Úe
);

85 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
two
);

86 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
th»e
);

88 
edgeID
.
	`£tLab–
(
Ïb–
);

90 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
Úe
);

91 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
two
);

92 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

94 
edgeID
.
	`£tD¡
(
d¡
);

96 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
Úe
);

97 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
d¡
);

98 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

100 
edgeID
.
	`£tSrc
(
¤c
);

102 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
¤c
);

103 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
d¡
);

104 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

105 
	}
}

107 @
Te¡


108 
public
 
fš®
 
	$‹¡Rev”£Edge
() {

109 
Objeù
 
¤c
 = 
Ãw
 
	`SŒšg
("src");

110 
Objeù
 
d¡
 = 
Ãw
 
	`SŒšg
("dst");

111 
Objeù
 
Ïb–
 = 
Ãw
 
	`SŒšg
("label");

113 
EdgeID
 
edgeID
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

115 
	`as£¹NÙNuÎ
(
edgeID
);

116 
	`as£¹Same
(
edgeID
.
	`g‘Src
(), 
¤c
);

117 
	`as£¹Same
(
edgeID
.
	`g‘D¡
(), 
d¡
);

118 
	`as£¹Same
(
edgeID
.
	`g‘Lab–
(), 
Ïb–
);

120 
EdgeID
 
»v”£EdgeID
 = 
edgeID
.
	`»v”£Edge
();

121 
	`as£¹Same
(
»v”£EdgeID
.
	`g‘Src
(), 
d¡
);

122 
	`as£¹Same
(
»v”£EdgeID
.
	`g‘D¡
(), 
¤c
);

123 
	`as£¹Same
(
»v”£EdgeID
.
	`g‘Lab–
(), 
Ïb–
);

125 
EdgeID
 
»v”£Rev”£EdgeID
 = 
edgeID
.
	`»v”£Edge
().reverseEdge();

126 
	`as£¹Same
(
»v”£Rev”£EdgeID
.
	`g‘Src
(), 
¤c
);

127 
	`as£¹Same
(
»v”£Rev”£EdgeID
.
	`g‘D¡
(), 
d¡
);

128 
	`as£¹Same
(
»v”£Rev”£EdgeID
.
	`g‘Lab–
(), 
Ïb–
);

129 
	}
}

131 @
Te¡


132 
public
 
fš®
 
	$‹¡Equ®s
() {

133 
Objeù
 
¤c
 = 
Ãw
 
	`SŒšg
("src");

134 
Objeù
 
badSrc
 = 
Ãw
 
	`SŒšg
("badSrc");

135 
Objeù
 
d¡
 = 
Ãw
 
	`SŒšg
("dst");

136 
Objeù
 
badD¡
 = 
Ãw
 
	`SŒšg
("badDst");

137 
Objeù
 
Ïb–
 = 
Ãw
 
	`SŒšg
("label");

138 
Objeù
 
badLab–
 = 
Ãw
 
	`SŒšg
("I hate†abels");

140 
EdgeID
 
edgeID
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

141 
EdgeID
 
edgeIDSame
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

142 
EdgeID
 
edgeIDD–1
 = 
Ãw
 
	`EdgeID
(
badSrc
, 
d¡
, 
Ïb–
);

143 
EdgeID
 
edgeIDD–2
 = 
Ãw
 
	`EdgeID
(
¤c
, 
badD¡
, 
Ïb–
);

144 
EdgeID
 
edgeIDD–3
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
badLab–
);

146 
	`as£¹
 (
edgeID
.
	`equ®s
(
edgeIDSame
));

147 
	`as£¹F®£
(
edgeID
.
	`equ®s
(
edgeIDD–1
));

148 
	`as£¹F®£
(
edgeID
.
	`equ®s
(
edgeIDD–2
));

149 
	`as£¹F®£
(
edgeID
.
	`equ®s
(
edgeIDD–3
));

152 
	`as£¹F®£
(
edgeID
.
	`equ®s
(
nuÎ
));

153 
	}
}

155 @
Te¡


156 
public
 
fš®
 
	$‹¡HashCode
() {

157 
Objeù
 
¤c
 = 
Ãw
 
	`SŒšg
("src");

158 
Objeù
 
d¡
 = 
Ãw
 
	`SŒšg
("dst");

159 
Objeù
 
Ïb–
 = 
Ãw
 
	`SŒšg
("label");

161 
EdgeID
 
edgeID
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

163 
hash
 = 
edgeID
.
	`hashCode
();

165 
	`as£¹NÙNuÎ
(
hash
);

166 
	}
}

168 @
Te¡


169 
public
 
fš®
 
	$‹¡ToSŒšg
() {

170 
Objeù
 
¤c
 = 
Ãw
 
	`SŒšg
("src");

171 
Objeù
 
d¡
 = 
Ãw
 
	`SŒšg
("dst");

172 
Objeù
 
Ïb–
 = 
Ãw
 
	`SŒšg
("label");

174 
Objeù
 
¤c2
 = 
Ãw
 
	`SŒšg
("src");

175 
Objeù
 
d¡2
 = 
Ãw
 
	`SŒšg
("dst");

176 
Objeù
 
Ïb–2
 = 
Ãw
 
	`SŒšg
("label");

178 
EdgeID
 
edgeID1
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
Ïb–
);

179 
EdgeID
 
edgeID2
 = 
Ãw
 
	`EdgeID
(
¤c2
, 
d¡2
, 
Ïb–2
);

181 
SŒšg
 
toSŒšg1
 = 
edgeID1
.
	`toSŒšg
();

182 
SŒšg
 
toSŒšg2
 = 
edgeID2
.
	`toSŒšg
();

184 
	`as£¹NÙNuÎ
(
toSŒšg1
);

185 
	`as£¹F®£
(
toSŒšg1
.
	`com·»To
("") == 0);

187 
	`as£¹
 (
toSŒšg2
.
	`com·»To
(
toSŒšg1
) == 0);

191 
Objeù
 
badSrc
 = 
Ãw
 
	`SŒšg
("badSrc");

192 
Objeù
 
badD¡
 = 
Ãw
 
	`SŒšg
("badDst");

193 
Objeù
 
badLab–
 = 
Ãw
 
	`SŒšg
("badLabel");

195 
EdgeID
 
edgeIDD–1
 = 
Ãw
 
	`EdgeID
(
badSrc
, 
d¡
, 
Ïb–
);

196 
EdgeID
 
edgeIDD–2
 = 
Ãw
 
	`EdgeID
(
¤c
, 
badD¡
, 
Ïb–
);

197 
EdgeID
 
edgeIDD–3
 = 
Ãw
 
	`EdgeID
(
¤c
, 
d¡
, 
badLab–
);

199 
	`as£¹F®£
(
toSŒšg1
.
	`com·»To
(
edgeIDD–1
.
	`toSŒšg
()) == 0);

200 
	`as£¹F®£
(
toSŒšg1
.
	`com·»To
(
edgeIDD–2
.
	`toSŒšg
()) == 0);

201 
	`as£¹F®£
(
toSŒšg1
.
	`com·»To
(
edgeIDD–3
.
	`toSŒšg
()) == 0);

202 
	}
}

	@test/com/intel/hadoop/graphbuilder/graphelements/EdgeTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gIÁTy³
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

25 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

28 
impÜt
 
	gjava
.
	gio
.*;

30 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹F®£
;

31 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

32 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

33 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NuÎ
;

34 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Same
;

36 
public
 cÏs 
	cEdgeTe¡
 {

38 @
Te¡


39 
public
 
fš®
 
	$‹¡CÚ¡ruùÜW™houtArgs
() {

40 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<StringType>();

42 
	`as£¹NÙNuÎ
(
edge
);

43 
	`as£¹NuÎ
(
edge
.
	`g‘Src
());

44 
	`as£¹NuÎ
(
edge
.
	`g‘D¡
());

45 
	`as£¹NuÎ
(
edge
.
	`g‘EdgeLab–
());

46 
	`as£¹NÙNuÎ
(
edge
.
	`g‘EdgeID
());

47 
	`as£¹NÙNuÎ
(
edge
.
	`g‘Prİ”t›s
());

50 @
Te¡


51 
public
 
fš®
 
	$‹¡CÚ¡ruùÜW™hArgs
() {

52 
SŒšgTy³
 
¤c
 = 
Ãw
 
	`SŒšgTy³
("src");

53 
SŒšgTy³
 
d¡
 = 
Ãw
 
	`SŒšgTy³
("dst");

54 
SŒšgTy³
 
Ïb–
 = 
Ãw
 
	`SŒšgTy³
("label");

56 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<SŒšgTy³>(
¤c
, 
d¡
, 
Ïb–
);

58 
	`as£¹Same
(
¤c
, 
edge
.
	`g‘Src
());

59 
	`as£¹Same
(
d¡
, 
edge
.
	`g‘D¡
());

60 
	`as£¹Same
(
Ïb–
, 
edge
.
	`g‘EdgeLab–
());

61 
	`as£¹NÙNuÎ
(
edge
.
	`g‘EdgeID
());

62 
	`as£¹NÙNuÎ
(
edge
.
	`g‘Prİ”t›s
());

63 
	}
}

65 @
Te¡


66 
public
 
fš®
 
	$‹¡CÚfigu»
() {

67 
SŒšgTy³
 
¤c
 = 
Ãw
 
	`SŒšgTy³
("src");

68 
SŒšgTy³
 
d¡
 = 
Ãw
 
	`SŒšgTy³
("dst");

69 
SŒšgTy³
 
Ïb–
 = 
Ãw
 
	`SŒšgTy³
("label");

70 
Prİ”tyM­
 
pm
 = 
Ãw
 
	`Prİ”tyM­
();

72 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<StringType>();

74 
edge
.
	`cÚfigu»
(
¤c
, 
d¡
, 
Ïb–
, 
pm
);

76 
	`as£¹Same
(
¤c
, 
edge
.
	`g‘Src
());

77 
	`as£¹Same
(
d¡
, 
edge
.
	`g‘D¡
());

78 
	`as£¹Same
(
Ïb–
, 
edge
.
	`g‘EdgeLab–
());

79 
	`as£¹Same
(
pm
, 
edge
.
	`g‘Prİ”t›s
());

83 
SŒšgTy³
 
¤c2
 = 
Ãw
 
	`SŒšgTy³
("src2");

84 
SŒšgTy³
 
d¡2
 = 
Ãw
 
	`SŒšgTy³
("dst2");

85 
SŒšgTy³
 
Ïb–2
 = 
Ãw
 
	`SŒšgTy³
("label2");

87 
Edge
<
SŒšgTy³
> 
edge2
 = 
Ãw
 Edge<SŒšgTy³>(
¤c2
, 
d¡2
, 
Ïb–2
);

89 
edge2
.
	`cÚfigu»
(
¤c
, 
d¡
, 
Ïb–
, 
pm
);

91 
	`as£¹Same
(
¤c
, 
edge2
.
	`g‘Src
());

92 
	`as£¹Same
(
d¡
, 
edge2
.
	`g‘D¡
());

93 
	`as£¹Same
(
Ïb–
, 
edge2
.
	`g‘EdgeLab–
());

94 
	`as£¹Same
(
pm
, 
edge2
.
	`g‘Prİ”t›s
());

95 
	}
}

97 @
Te¡


98 
public
 
fš®
 
	$‹¡Prİ”t›s
() {

99 
SŒšgTy³
 
¤c
 = 
Ãw
 
	`SŒšgTy³
("src");

100 
SŒšgTy³
 
d¡
 = 
Ãw
 
	`SŒšgTy³
("dst");

101 
SŒšgTy³
 
Ïb–
 = 
Ãw
 
	`SŒšgTy³
("label");

103 
SŒšg
 
key1
 = 
Ãw
 
	`SŒšg
("key");

104 
SŒšg
 
key2
 = 
Ãw
 
	`SŒšg
("Ce‚'est…as une clÃ©");

106 
SŒšgTy³
 
v®ue1
 = 
Ãw
 
	`SŒšgTy³
("Outstanding Value");

107 
SŒšgTy³
 
v®ue2
 = 
Ãw
 
	`SŒšgTy³
("Little Value");

109 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<SŒšgTy³>(
¤c
, 
d¡
, 
Ïb–
);

111 
	`as£¹
 (
edge
.
	`g‘Prİ”t›s
().
	`g‘Prİ”tyKeys
().
	`isEm±y
());

113 
edge
.
	`£tPrİ”ty
(
key1
, 
v®ue1
);

114 
edge
.
	`£tPrİ”ty
(
key2
, 
v®ue2
);

116 
	`as£¹Same
(
v®ue1
, 
edge
.
	`g‘Prİ”ty
(
key1
));

117 
	`as£¹Same
(
v®ue1
, 
edge
.
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
key1
));

119 
	`as£¹Same
(
v®ue2
, 
edge
.
	`g‘Prİ”ty
(
key2
));

120 
	`as£¹Same
(
v®ue2
, 
edge
.
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
key2
));

122 
edge
.
	`£tPrİ”ty
(
key1
, 
v®ue2
);

123 
edge
.
	`£tPrİ”ty
(
key2
, 
v®ue1
);

125 
	`as£¹Same
(
v®ue2
, 
edge
.
	`g‘Prİ”ty
(
key1
));

126 
	`as£¹Same
(
v®ue2
, 
edge
.
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
key1
));

128 
	`as£¹Same
(
v®ue1
, 
edge
.
	`g‘Prİ”ty
(
key2
));

129 
	`as£¹Same
(
v®ue1
, 
edge
.
	`g‘Prİ”t›s
().
	`g‘Prİ”ty
(
key2
));

131 
	`as£¹
 (
edge
.
	`g‘Prİ”t›s
().
	`g‘Prİ”tyKeys
().
	`size
() == 2);

132 
	}
}

134 @
Te¡


135 
public
 
fš®
 
	$‹¡G‘EdgeID
() {

136 
SŒšgTy³
 
¤c1
 = 
Ãw
 
	`SŒšgTy³
("src1");

137 
SŒšgTy³
 
d¡1
 = 
Ãw
 
	`SŒšgTy³
("dst1");

138 
SŒšgTy³
 
Ïb–1
 = 
Ãw
 
	`SŒšgTy³
("label1");

140 
SŒšgTy³
 
¤c2
 = 
Ãw
 
	`SŒšgTy³
("src2");

141 
SŒšgTy³
 
d¡2
 = 
Ãw
 
	`SŒšgTy³
("dst2");

142 
SŒšgTy³
 
Ïb–2
 = 
Ãw
 
	`SŒšgTy³
("label2");

144 
Edge
<
SŒšgTy³
> 
edge1
 = 
Ãw
 Edge<>(
¤c1
, 
d¡1
, 
Ïb–1
);

145 
Edge
<
SŒšgTy³
> 
edge2
 = 
Ãw
 Edge<>(
¤c2
, 
d¡2
, 
Ïb–2
);

146 
Edge
<
SŒšgTy³
> 
edge3
 = 
Ãw
 Edge<>(
¤c1
, 
d¡1
, 
Ïb–1
);

148 
	`as£¹NÙNuÎ
(
edge1
.
	`g‘EdgeID
());

149 
	`as£¹NÙNuÎ
(
edge2
.
	`g‘EdgeID
());

150 
	`as£¹NÙNuÎ
(
edge3
.
	`g‘EdgeID
());

152 
	`as£¹F®£
(
edge1
.
	`g‘EdgeID
().
	`equ®s
(
edge2
.getEdgeID()));

153 
	`as£¹
 (
edge1
.
	`g‘EdgeID
().
	`equ®s
(
edge3
.getEdgeID()));

155 
SŒšg
 
key
 = 
Ãw
 
	`SŒšg
("key");

156 
SŒšgTy³
 
v®ue
 = 
Ãw
 
	`SŒšgTy³
("bank");

158 
edge1
.
	`£tPrİ”ty
(
key
, 
v®ue
);

159 
	`as£¹F®£
(
edge1
.
	`g‘EdgeID
().
	`equ®s
(
edge2
.getEdgeID()));

160 
	`as£¹
 (
edge1
.
	`g‘EdgeID
().
	`equ®s
(
edge3
.getEdgeID()));

161 
	}
}

163 @
Te¡


164 
public
 
fš®
 
	$‹¡ToSŒšg
() {

165 
SŒšgTy³
 
¤c1
 = 
Ãw
 
	`SŒšgTy³
("src1");

166 
SŒšgTy³
 
d¡1
 = 
Ãw
 
	`SŒšgTy³
("dst1");

167 
SŒšgTy³
 
Ïb–1
 = 
Ãw
 
	`SŒšgTy³
("label1");

169 
SŒšgTy³
 
¤c2
 = 
Ãw
 
	`SŒšgTy³
("src2");

170 
SŒšgTy³
 
d¡2
 = 
Ãw
 
	`SŒšgTy³
("dst2");

171 
SŒšgTy³
 
Ïb–2
 = 
Ãw
 
	`SŒšgTy³
("label2");

173 
Edge
<
SŒšgTy³
> 
edge1
 = 
Ãw
 Edge<>(
¤c1
, 
d¡1
, 
Ïb–1
);

174 
Edge
<
SŒšgTy³
> 
edge2
 = 
Ãw
 Edge<>(
¤c2
, 
d¡2
, 
Ïb–2
);

175 
Edge
<
SŒšgTy³
> 
edge3
 = 
Ãw
 Edge<>(
¤c1
, 
d¡1
, 
Ïb–1
);

177 
	`as£¹NÙNuÎ
(
edge1
.
	`toSŒšg
());

178 
	`as£¹NÙNuÎ
(
edge2
.
	`toSŒšg
());

179 
	`as£¹NÙNuÎ
(
edge3
.
	`toSŒšg
());

181 
	`as£¹F®£
(
edge1
.
	`toSŒšg
().
	`equ®s
(
edge2
.toString()));

182 
	`as£¹
 (
edge1
.
	`toSŒšg
().
	`equ®s
(
edge3
.toString()));

184 
SŒšg
 
key
 = 
Ãw
 
	`SŒšg
("key");

185 
SŒšgTy³
 
v®ue
 = 
Ãw
 
	`SŒšgTy³
("bank");

187 
edge1
.
	`£tPrİ”ty
(
key
, 
v®ue
);

188 
	`as£¹F®£
(
edge1
.
	`toSŒšg
().
	`equ®s
(
edge2
.toString()));

189 
	`as£¹F®£
(
edge1
.
	`toSŒšg
().
	`equ®s
(
edge3
.toString()));

190 
	}
}

192 @
Te¡


193 
public
 
fš®
 
	$‹¡S–fEdge
() {

194 
SŒšgTy³
 
¤c
 = 
Ãw
 
	`SŒšgTy³
("src");

195 
SŒšgTy³
 
d¡
 = 
Ãw
 
	`SŒšgTy³
("dst");

196 
SŒšgTy³
 
Ïb–
 = 
Ãw
 
	`SŒšgTy³
("label");

198 
Edge
<
SŒšgTy³
> 
nÚLoİ
 = 
Ãw
 Edge<SŒšgTy³>(
¤c
, 
d¡
, 
Ïb–
);

199 
Edge
<
SŒšgTy³
> 
loİ
 = 
Ãw
 Edge<SŒšgTy³>(
¤c
, src, 
Ïb–
);

201 
	`as£¹F®£
(
nÚLoİ
.
	`isS–fEdge
());

202 
	`as£¹
 (
loİ
.
	`isS–fEdge
());

203 
	}
}

205 @
Te¡


206 
public
 
fš®
 
	$‹¡Wr™eR—d
(è
throws
 
IOExû±iÚ


209 
SŒšgTy³
 
¤c
 = 
Ãw
 
	`SŒšgTy³
("src");

210 
SŒšgTy³
 
d¡
 = 
Ãw
 
	`SŒšgTy³
("dst");

211 
SŒšgTy³
 
Ïb–
 = 
Ãw
 
	`SŒšgTy³
("label");

213 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<SŒšgTy³>(
¤c
, 
d¡
, 
Ïb–
);

215 
SŒšgTy³
 
¤c2
 = 
Ãw
 
	`SŒšgTy³
("src2");

216 
SŒšgTy³
 
d¡2
 = 
Ãw
 
	`SŒšgTy³
("dst2");

217 
SŒšgTy³
 
Ïb–2
 = 
Ãw
 
	`SŒšgTy³
("label2");

218 
Edge
<
SŒšgTy³
> 
edgeOnTheOth”End
 = 
Ãw
 Edge<SŒšgTy³>(
¤c2
, 
d¡2
, 
Ïb–2
);

220 
By‹A¼ayOuutSŒ—m
 
baos
 = 
Ãw
 
	`By‹A¼ayOuutSŒ—m
(1024);

221 
D©aOuutSŒ—m
 
d©aOuutSŒ—m
 = 
Ãw
 
	`D©aOuutSŒ—m
(
baos
);

223 
edge
.
	`wr™e
(
d©aOuutSŒ—m
);

224 
d©aOuutSŒ—m
.
	`æush
();

226 
By‹A¼ayIÅutSŒ—m
 
bais
 = 
Ãw
 
	`By‹A¼ayIÅutSŒ—m
(
baos
.
	`toBy‹A¼ay
());

227 
D©aIÅutSŒ—m
 
d©aIÅutSŒ—m
 = 
Ãw
 
	`D©aIÅutSŒ—m
(
bais
);

229 
edgeOnTheOth”End
.
	`»adF›lds
(
d©aIÅutSŒ—m
);

231 
	`as£¹
 (
edgeOnTheOth”End
.
	`g‘EdgeID
().
	`equ®s
(
edge
.getEdgeID()));

232 
	`as£¹
 (
edgeOnTheOth”End
.
	`g‘Prİ”t›s
().
	`toSŒšg
().
	`equ®s
(
edge
.getProperties().toString()));

236 
SŒšg
 
key
 = 
Ãw
 
	`SŒšg
("key");

237 
SŒšgTy³
 
v®ue
 = 
Ãw
 
	`SŒšgTy³
("bank");

239 
edge
.
	`£tPrİ”ty
(
key
, 
v®ue
);

241 
By‹A¼ayOuutSŒ—m
 
baos2
 = 
Ãw
 
	`By‹A¼ayOuutSŒ—m
(1024);

242 
D©aOuutSŒ—m
 
d©aOuutSŒ—m2
 = 
Ãw
 
	`D©aOuutSŒ—m
(
baos2
);

244 
edge
.
	`wr™e
(
d©aOuutSŒ—m2
);

245 
d©aOuutSŒ—m
.
	`æush
();

247 
By‹A¼ayIÅutSŒ—m
 
bais2
 = 
Ãw
 
	`By‹A¼ayIÅutSŒ—m
(
baos2
.
	`toBy‹A¼ay
());

248 
D©aIÅutSŒ—m
 
d©aIÅutSŒ—m2
 = 
Ãw
 
	`D©aIÅutSŒ—m
(
bais2
);

250 
edgeOnTheOth”End
.
	`»adF›lds
(
d©aIÅutSŒ—m2
);

252 
	`as£¹
 (
edgeOnTheOth”End
.
	`g‘EdgeID
().
	`equ®s
(
edge
.getEdgeID()));

253 
	`as£¹
 (
edgeOnTheOth”End
.
	`g‘Prİ”t›s
().
	`toSŒšg
().
	`equ®s
(
edge
.getProperties().toString()));

254 
	}
}

	@test/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementLongTypeVidsTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gLÚgTy³
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

25 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

26 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

29 
public
 cÏs 
	cPrİ”tyG¿phEËm’tLÚgTy³VidsTe¡
 {

31 @
Te¡


32 
public
 
	$‹¡C»©eVid
() {

33 
Prİ”tyG¿phEËm’tLÚgTy³Vids
 
–t
 = 
Ãw
 
	`Prİ”tyG¿phEËm’tLÚgTy³Vids
();

35 
	`as£¹NÙNuÎ
(
–t
);

37 
Objeù
 
vid
 = 
–t
.
	`ü—‹Vid
();

39 
	`as£¹NÙNuÎ
(
vid
);

41 
	`as£¹Equ®s
(
vid
.
	`g‘CÏss
(), 
LÚgTy³
.
şass
);

44 
	}
}

	@test/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementStringTypeVidsTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

25 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

26 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

28 
public
 cÏs 
	cPrİ”tyG¿phEËm’tSŒšgTy³VidsTe¡
 {

29 @
Te¡


30 
public
 
	$‹¡C»©eVid
() {

31 
Prİ”tyG¿phEËm’tSŒšgTy³Vids
 
–t
 = 
Ãw
 
	`Prİ”tyG¿phEËm’tSŒšgTy³Vids
();

33 
	`as£¹NÙNuÎ
(
–t
);

35 
Objeù
 
vid
 = 
–t
.
	`ü—‹Vid
();

37 
	`as£¹NÙNuÎ
(
vid
);

39 
	`as£¹Equ®s
(
vid
.
	`g‘CÏss
(), 
SŒšgTy³
.
şass
);

41 
	}
}

	@test/com/intel/hadoop/graphbuilder/graphelements/VertexTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gIÁTy³
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gPrİ”tyM­
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

27 
impÜt
 
	gjava
.
	gio
.*;

29 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

30 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NuÎ
;

31 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Same
;

32 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹F®£
;

34 
public
 cÏs 
	cV”‹xTe¡
 {

36 @
Te¡


37 
public
 
fš®
 
	$‹¡NoArgCÚ¡ruùÜ
() {

38 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 Vertex<StringType>();

40 
	`as£¹NÙNuÎ
(
v”‹x
);

41 
	`as£¹NuÎ
(
v”‹x
.
	`g‘V”‹xId
());

42 
	`as£¹NÙNuÎ
(
v”‹x
.
	`g‘Prİ”t›s
());

45 @
Te¡


46 
public
 
fš®
 
	$‹¡CÚ¡ruùÜW™hArgs
() {

47 
SŒšgTy³
 
v”‹xId
 = 
Ãw
 
	`SŒšgTy³
("The Greatest Vertex EVER");

48 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>(
v”‹xId
);

50 
	`as£¹NÙNuÎ
(
v”‹x
);

51 
	`as£¹
 (
v”‹x
.
	`g‘V”‹xId
().
	`equ®s
(
v”‹xId
));

52 
	`as£¹NÙNuÎ
(
v”‹x
.
	`g‘Prİ”t›s
());

53 
	}
}

55 @
Te¡


56 
public
 
fš®
 
	$‹¡CÚfigu»W™hG‘‹rs
() {

58 
SŒšgTy³
 
v”‹xId
 = 
Ãw
 
	`SŒšgTy³
("The Greatest Vertex EVER");

59 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>(
v”‹xId
);

61 
	`as£¹NÙNuÎ
(
v”‹x
);

62 
	`as£¹
 (
v”‹x
.
	`g‘V”‹xId
().
	`equ®s
(
v”‹xId
));

63 
	`as£¹NÙNuÎ
(
v”‹x
.
	`g‘Prİ”t›s
());

65 
Prİ”tyM­
 
pm
 = 
v”‹x
.
	`g‘Prİ”t›s
();

66 
Prİ”tyM­
 
pm2
 = 
Ãw
 
	`Prİ”tyM­
();

68 
SŒšgTy³
 
ªÙh”OpšiÚ
 = 
Ãw
 
	`SŒšgTy³
("Nohat vertex sucks");

70 
v”‹x
.
	`cÚfigu»
(
ªÙh”OpšiÚ
, 
pm2
);

71 
	`as£¹
 (
v”‹x
.
	`g‘V”‹xId
().
	`equ®s
(
ªÙh”OpšiÚ
));

72 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”t›s
(), 
pm2
);

74 
v”‹x
.
	`cÚfigu»
(
v”‹xId
, 
pm
);

75 
	`as£¹
 (
v”‹x
.
	`g‘V”‹xId
().
	`equ®s
(
v”‹xId
));

76 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”t›s
(), 
pm
);

77 
	}
}

79 @
Te¡


80 
public
 
fš®
 
	$‹¡G‘S‘Prİ”ty
() {

81 
SŒšgTy³
 
v”‹xId
 = 
Ãw
 
	`SŒšgTy³
("The Greatest Vertex EVER");

82 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>(
v”‹xId
);

84 
SŒšg
 
key1
 = 
Ãw
 
	`SŒšg
("key");

85 
SŒšg
 
key2
 = 
Ãw
 
	`SŒšg
("Ce‚'est…as une clÃ©");

87 
SŒšgTy³
 
v®ue1
 = 
Ãw
 
	`SŒšgTy³
("Outstanding Value");

88 
SŒšgTy³
 
v®ue2
 = 
Ãw
 
	`SŒšgTy³
("Little Value");

90 
	`as£¹
 (
v”‹x
.
	`g‘Prİ”t›s
().
	`g‘Prİ”tyKeys
().
	`isEm±y
());

92 
v”‹x
.
	`£tPrİ”ty
(
key1
, 
v®ue1
);

93 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key1
), 
v®ue1
);

94 
	`as£¹NuÎ
(
v”‹x
.
	`g‘Prİ”ty
(
key2
));

96 
v”‹x
.
	`£tPrİ”ty
(
key2
, 
v®ue2
);

97 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key1
), 
v®ue1
);

98 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key2
), 
v®ue2
);

100 
v”‹x
.
	`£tPrİ”ty
(
key1
, 
v®ue2
);

101 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key1
), 
v®ue2
);

102 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key2
), 
v®ue2
);

104 
v”‹x
.
	`£tPrİ”ty
(
key2
, 
v®ue1
);

105 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key1
), 
v®ue2
);

106 
	`as£¹Same
(
v”‹x
.
	`g‘Prİ”ty
(
key2
), 
v®ue1
);

108 
	`as£¹
 (
v”‹x
.
	`g‘Prİ”t›s
().
	`g‘Prİ”tyKeys
().
	`size
() == 2);

109 
	}
}

111 @
Te¡


112 
public
 
fš®
 
	$‹¡ToSŒšg
() {

113 
SŒšgTy³
 
id1
 = 
Ãw
 
	`SŒšgTy³
("the greatest vertex IDƒver");

114 
SŒšgTy³
 
id2
 = 
Ãw
 
	`SŒšgTy³
("worst vertex IDƒver");

116 
V”‹x
<
SŒšgTy³
> 
v”‹x1
 = 
Ãw
 V”‹x<SŒšgTy³>(
id1
);

117 
V”‹x
<
SŒšgTy³
> 
v”‹x2
 = 
Ãw
 V”‹x<SŒšgTy³>(
id2
);

119 
V”‹x
<
SŒšgTy³
> 
v”‹x3
 = 
Ãw
 V”‹x<SŒšgTy³>(
id1
);

121 
	`as£¹NÙNuÎ
(
v”‹x1
.
	`toSŒšg
());

122 
	`as£¹NÙNuÎ
(
v”‹x2
.
	`toSŒšg
());

123 
	`as£¹NÙNuÎ
(
v”‹x3
.
	`toSŒšg
());

125 
	`as£¹
 (
v”‹x1
.
	`toSŒšg
().
	`com·»To
(
v”‹x2
.toString()) != 0);

126 
	`as£¹
 (
v”‹x1
.
	`toSŒšg
().
	`com·»To
(
v”‹x3
.toString()) == 0);

128 
SŒšg
 
key
 = 
Ãw
 
	`SŒšg
("key");

129 
SŒšgTy³
 
v®ue
 = 
Ãw
 
	`SŒšgTy³
("bank");

131 
v”‹x1
.
	`£tPrİ”ty
(
key
, 
v®ue
);

133 
	`as£¹
 (
v”‹x1
.
	`toSŒšg
().
	`com·»To
(
v”‹x2
.toString()) != 0);

134 
	`as£¹
 (
v”‹x1
.
	`toSŒšg
().
	`com·»To
(
v”‹x3
.toString()) != 0);

135 
	}
}

137 @
Te¡


138 
public
 
fš®
 
	$‹¡Wr™eR—d
(è
throws
 
IOExû±iÚ
 {

139 
SŒšgTy³
 
id
 = 
Ãw
 
	`SŒšgTy³
("the greatest vertex of ALLL TIIIME!!!");

140 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>(
id
);

142 
V”‹x
<
SŒšgTy³
> 
v”‹xOnTheOth”End
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
("maybe‚ot so much"));

144 
By‹A¼ayOuutSŒ—m
 
baos
 = 
Ãw
 
	`By‹A¼ayOuutSŒ—m
(1024);

145 
D©aOuutSŒ—m
 
d©aOuutSŒ—m
 = 
Ãw
 
	`D©aOuutSŒ—m
(
baos
);

147 
v”‹x
.
	`wr™e
(
d©aOuutSŒ—m
);

148 
d©aOuutSŒ—m
.
	`æush
();

150 
By‹A¼ayIÅutSŒ—m
 
bais
 = 
Ãw
 
	`By‹A¼ayIÅutSŒ—m
(
baos
.
	`toBy‹A¼ay
());

151 
D©aIÅutSŒ—m
 
d©aIÅutSŒ—m
 = 
Ãw
 
	`D©aIÅutSŒ—m
(
bais
);

153 
v”‹xOnTheOth”End
.
	`»adF›lds
(
d©aIÅutSŒ—m
);

155 
	`as£¹
 (
v”‹x
.
	`g‘V”‹xId
().
	`equ®s
(
v”‹xOnTheOth”End
.getVertexId()));

156 
	`as£¹
 (
v”‹x
.
	`g‘Prİ”t›s
().
	`toSŒšg
().
	`equ®s
(
v”‹xOnTheOth”End
.getProperties().toString()));

160 
SŒšg
 
key
 = 
Ãw
 
	`SŒšg
("key");

161 
IÁTy³
 
v®ue
 = 
Ãw
 
	`IÁTy³
(666);

163 
v”‹x
.
	`£tPrİ”ty
(
key
, 
v®ue
);

165 
By‹A¼ayOuutSŒ—m
 
baos2
 = 
Ãw
 
	`By‹A¼ayOuutSŒ—m
(1024);

166 
D©aOuutSŒ—m
 
d©aOuutSŒ—m2
 = 
Ãw
 
	`D©aOuutSŒ—m
(
baos2
);

168 
v”‹x
.
	`wr™e
(
d©aOuutSŒ—m2
);

169 
d©aOuutSŒ—m
.
	`æush
();

171 
By‹A¼ayIÅutSŒ—m
 
bais2
 = 
Ãw
 
	`By‹A¼ayIÅutSŒ—m
(
baos2
.
	`toBy‹A¼ay
());

172 
D©aIÅutSŒ—m
 
d©aIÅutSŒ—m2
 = 
Ãw
 
	`D©aIÅutSŒ—m
(
bais2
);

174 
v”‹xOnTheOth”End
.
	`»adF›lds
(
d©aIÅutSŒ—m2
);

176 
	`as£¹
 (
v”‹x
.
	`g‘V”‹xId
().
	`equ®s
(
v”‹xOnTheOth”End
.getVertexId()));

177 
	`as£¹
 (
v”‹x
.
	`g‘Prİ”t›s
().
	`toSŒšg
().
	`equ®s
(
v”‹xOnTheOth”End
.getProperties().toString()));

178 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/input/BaseMapperTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£G¿phBudšgRuË
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£Tok’iz”
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gSourûV”‹xKeyFunùiÚ
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’tSŒšgTy³Vids
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

30 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

31 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

34 
impÜt
 
	gÜg
.
	gjun™
.*;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”
.
	gRunW™h
;

36 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
;

37 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gmock™o
.
	gPow”Mock™o
;

38 
impÜt
 
	gÜg
.
	gpow”mock
.
	gcÜe
.
	gşas¦ßd”
.
	gªnÙ©iÚs
.
	gP»·»FÜTe¡
;

39 
impÜt
 
	gÜg
.
	gpow”mock
.
	gmoduËs
.
	gjun™4
.
	gPow”MockRuÂ”
;

41 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

43 
impÜt
 
	gÜg
.
	gmock™o
.
	gM©ch”s
.
	gªy
;

44 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gv”ify
;

45 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gmock™o
.
	gPow”Mock™o
.*;

46 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gsuµÜt
.
	gmemb”modifiÿtiÚ
.
	gMemb”M©ch”
.
	gm‘hod
;

52 @
RunW™h
(
Pow”MockRuÂ”
.
şass
)

53 @
	$P»·»FÜTe¡
(
Ba£M­³r
.
şass
)

54 
public
 cÏs 
	cBa£M­³rTe¡
 {

55 
CÚfigu¿tiÚ
 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

56 
M­³r
.
CÚ‹xt
 
m­³rCÚ‹xtMock
;

58 
Logg”
 
logg”Mock
;

59 
Ba£M­³r
 
ba£M­³r
;

60 
Ba£M­³r
 
¥›dBa£M­³r
;

61 
Prİ”tyG¿phEËm’t
 
m­V®
;

63 @
BefÜeCÏss


64 
public
 
fš®
 
	$befÜeCÏss
(){

67 
Sy¡em
.
	`£tPrİ”ty
("log4j.ignoreTCL","true");

70 @
BefÜe


71 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

72 
m­V®
 = 
Ãw
 
	`Prİ”tyG¿phEËm’tSŒšgTy³Vids
();

74 
m­³rCÚ‹xtMock
 = 
Pow”Mock™o
.
	`mock
(
M­³r
.
CÚ‹xt
.
şass
);

76 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

78 
cÚf
.
	`£t
("G¿phTok’iz”", 
HBa£Tok’iz”
.
şass
.
	`g‘Name
());

79 
cÚf
.
	`£t
("KeyFunùiÚ", 
SourûV”‹xKeyFunùiÚ
.
şass
.
	`g‘Name
());

83 
SŒšg
[] 
v”‹xRuËs
 = 
Ãw
 String[1];

84 
v”‹xRuËs
[0] = "cf:name=cf:age,cf:dept";

85 
HBa£G¿phBudšgRuË
.
	`·ckV”‹xRuËsIÁoCÚfigu¿tiÚ
(
cÚf
, 
v”‹xRuËs
);

87 
SŒšg
[] 
edgeRuËs
 = 
Ãw
 String[1];

88 
edgeRuËs
[0] = "cf:name,cf:dept,worksAt";

89 
HBa£G¿phBudšgRuË
.
	`·ckEdgeRuËsIÁoCÚfigu¿tiÚ
(
cÚf
, 
edgeRuËs
);

91 
SŒšg
[] 
dœeùedEdgeRuËs
 = 
Ãw
 String[0];

92 
HBa£G¿phBudšgRuË
.
	`·ckDœeùedEdgeRuËsIÁoCÚfigu¿tiÚ
(
cÚf
, 
dœeùedEdgeRuËs
);

95 
CÏss
 
v®CÏss
 = 
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
;

96 
Pow”Mock™o
.
	`wh’
(
m­³rCÚ‹xtMock
.
	`g‘M­OuutV®ueCÏss
()).
	`th’R‘uº
(
v®CÏss
);

99 
logg”Mock
 = 
	`mock
(
Logg”
.
şass
);

102 
ba£M­³r
 = 
Ãw
 
	`Ba£M­³r
(
m­³rCÚ‹xtMock
, 
cÚf
, 
logg”Mock
);

103 
¥›dBa£M­³r
 = 
	`¥y
(
ba£M­³r
);

104 
Pow”Mock™o
.
	`wh’New
(
Ba£M­³r
.
şass
).
	`w™hAnyArgum’ts
().
	`th’R‘uº
(
¥›dBa£M­³r
);

106 
¥›dBa£M­³r
.
	`£tV®CÏss
(
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
);

108 
	`doNÙhšg
().
	`wh’
(
¥›dBa£M­³r
).
	`£tV®CÏss
(
	`ªy
(
CÏss
.
şass
));

110 
¥›dBa£M­³r
.
	`£tM­V®
(
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
.
	`ÃwIn¡ªû
());

112 
	`doNÙhšg
().
	`wh’
(
¥›dBa£M­³r
).
	`£tM­V®
(
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

113 
	}
}

115 @
Aá”


116 
public
 
	$‹¬Down
() {

117 
m­V®
 = 
nuÎ
;

118 
m­³rCÚ‹xtMock
 = 
nuÎ
;

119 
cÚf
 = 
nuÎ
;

120 
logg”Mock
 = 
nuÎ
;

121 
ba£M­³r
 = 
nuÎ
;

122 
¥›dBa£M­³r
 = 
nuÎ
;

123 
	}
}

126 @
Te¡


127 
public
 
fš®
 
	$v”ify_edge_”ro_couÁ”_šüem’t
() {

129 
Edge
<
SŒšgTy³
> 
brok’Edge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
("Aliû"),‚ew SŒšgTy³(
nuÎ
),

130 
Ãw
 
	`SŒšgTy³
("worksAt"));

133 
m­V®
.
	`š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
EDGE
, 
brok’Edge
);

135 
Üg
.
­ache
.
hadoİ
.
m­»duû
.
CouÁ”
 
EDGE
 = 
	`mock
(Üg.­ache.hadoİ.m­»duû.CouÁ”.
şass
);

138 
Pow”Mock™o
.
	`wh’
(
m­³rCÚ‹xtMock
.
	`g‘CouÁ”
(
Ba£M­³r
.
	`g‘EdgeWr™eE¼ÜCouÁ”
()))

139 .
	`th’R‘uº
(
EDGE
);

141 
¥›dBa£M­³r
.
	`šüem’tE¼ÜCouÁ”
(
m­³rCÚ‹xtMock
, 
m­V®
);

144 
Mock™o
.
	`v”ify
(
EDGE
).
	`šüem’t
(1);

145 
	}
}

147 @
Te¡


148 
public
 
fš®
 
	$v”ify_v”‹x_”rÜ_couÁ”_šüem’t
() {

149 
V”‹x
<
SŒšgTy³
> 
brok’V”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
("tese"));

151 
m­V®
.
	`š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
, 
brok’V”‹x
);

153 
Üg
.
­ache
.
hadoİ
.
m­»duû
.
CouÁ”
 
VERTEX
 = 
	`mock
(Üg.­ache.hadoİ.m­»duû.CouÁ”.
şass
);

156 
Pow”Mock™o
.
	`wh’
(
m­³rCÚ‹xtMock
.
	`g‘CouÁ”
(
Ba£M­³r
.
	`g‘V”‹xWr™eE¼ÜCouÁ”
()))

157 .
	`th’R‘uº
(
VERTEX
);

159 
¥›dBa£M­³r
.
	`šüem’tE¼ÜCouÁ”
(
m­³rCÚ‹xtMock
, 
m­V®
);

162 
Mock™o
.
	`v”ify
(
VERTEX
).
	`šüem’t
(1);

163 
	}
}

165 @
Te¡


166 
public
 
fš®
 
	$v”ify_cÚ‹xtWr™e_logs_”rÜ_ªd_šüem’tE¼ÜCouÁ”_Ú_IOExû±iÚ
()

167 
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

169 
Pow”Mock™o
.
	`doThrow
(
Ãw
 
	`IOExû±iÚ
()).

170 
	`wh’
(
m­³rCÚ‹xtMock
).
	`wr™e
(
	`ªy
(
IÁWr™abË
.
şass
),

171 
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

175 
Pow”Mock™o
.
	`doNÙhšg
().
	`wh’
(
¥›dBa£M­³r
).
	`šüem’tE¼ÜCouÁ”
(
	`ªy
(
M­³r
.
CÚ‹xt
.
şass
),

176 
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

179 
V”‹x
<
SŒšgTy³
> 
dummyV”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
("test"));

180 
m­V®
.
	`š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
, 
dummyV”‹x
);

182 
¥›dBa£M­³r
.
	`cÚ‹xtWr™e
(
m­³rCÚ‹xtMock
, 
Ãw
 
	`IÁWr™abË
(1), 
m­V®
);

184 
	`v”ify
(
¥›dBa£M­³r
).
	`šüem’tE¼ÜCouÁ”
(
	`ªy
(
M­³r
.
CÚ‹xt
.
şass
),

185 
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

186 
	`v”ify
(
logg”Mock
).
	`”rÜ
(
	`ªy
(
Objeù
.
şass
),‡ny(
IOExû±iÚ
.class));

187 
	}
}

189 @
Te¡


190 
public
 
fš®
 
	$v”ify_cÚ‹xtWr™e_logs_”rÜ_ªd_šüem’tE¼ÜCouÁ”_Ú_IÁ”ru±edExû±iÚ
()

191 
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

193 
Pow”Mock™o
.
	`doThrow
(
Ãw
 
	`IÁ”ru±edExû±iÚ
()).

194 
	`wh’
(
m­³rCÚ‹xtMock
).
	`wr™e
(
	`ªy
(
IÁWr™abË
.
şass
),

195 
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

197 
Pow”Mock™o
.
	`doNÙhšg
().
	`wh’
(
¥›dBa£M­³r
).
	`šüem’tE¼ÜCouÁ”
(
	`ªy
(
M­³r
.
CÚ‹xt
.
şass
),

198 
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

200 
V”‹x
<
SŒšgTy³
> 
dummyV”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
("test"));

201 
m­V®
.
	`š™
(
Prİ”tyG¿phEËm’t
.
G¿phEËm’tTy³
.
VERTEX
, 
dummyV”‹x
);

203 
¥›dBa£M­³r
.
	`cÚ‹xtWr™e
(
m­³rCÚ‹xtMock
, 
Ãw
 
	`IÁWr™abË
(1), 
m­V®
);

205 
	`v”ify
(
¥›dBa£M­³r
).
	`šüem’tE¼ÜCouÁ”
(
	`ªy
(
M­³r
.
CÚ‹xt
.
şass
),

206 
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

207 
	`v”ify
(
logg”Mock
).
	`”rÜ
(
	`ªy
(
Objeù
.
şass
),‡ny(
IOExû±iÚ
.class));

208 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseInputConfigurationTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
;

22 şas 
	cHBa£IÅutCÚfigu¿tiÚTe¡
 {

	@test/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseReaderMapperTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£G¿phBudšgRuË
;

23 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	ghba£
.
	gHBa£Tok’iz”
;

24 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	gBa£M­³r
;

25 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	gkeyfunùiÚ
.
	gSourûV”‹xKeyFunùiÚ
;

26 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
.
	gRecÜdTy³HBa£Row
;

27 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gEdge
;

28 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’t
;

29 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gPrİ”tyG¿phEËm’tSŒšgTy³Vids
;

30 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gg¿ph–em’ts
.
	gV”‹x
;

31 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
.
	gSŒšgTy³
;

32 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

33 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gHCÚ¡ªts
;

34 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gKeyV®ue
;

35 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

36 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gio
.
	gImmubËBy‹sWr™abË
;

37 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gut
.
	gBy‹s
;

38 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

39 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

40 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gm­»duû
.
	gM­³r
;

41 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gmrun™
.
	gm­»duû
.
	gM­Driv”
;

42 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gmrun™
.
	gty³s
.
	gPaœ
;

43 
impÜt
 
	gÜg
.
	g­ache
.
	glog4j
.
	gLogg”
;

44 
impÜt
 
	gÜg
.
	gjun™
.*;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”
.
	gRunW™h
;

46 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gmock™o
.
	gPow”Mock™o
;

47 
impÜt
 
	gÜg
.
	gpow”mock
.
	gcÜe
.
	gşas¦ßd”
.
	gªnÙ©iÚs
.
	gP»·»FÜTe¡
;

48 
impÜt
 
	gÜg
.
	gpow”mock
.
	gmoduËs
.
	gjun™4
.
	gPow”MockRuÂ”
;

49 
impÜt
 
	gÜg
.
	gpow”mock
.
	g»æeù
.
	gWh™ebox
;

51 
impÜt
 
	gjavax
.
	gxml
.
	g·r£rs
.
	gP¬£rCÚfigu¿tiÚExû±iÚ
;

52 
impÜt
 
	gjava
.
	gio
.
	gUnsuµÜ‹dEncodšgExû±iÚ
;

53 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

54 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

55 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

57 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

58 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹True
;

59 
impÜt
 
	gÜg
.
	gmock™o
.
	gM©ch”s
.
	gªy
;

60 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gv”ify
;

61 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gmock™o
.
	gPow”Mock™o
.*;

62 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gsuµÜt
.
	gmemb”modifiÿtiÚ
.
	gMemb”M©ch”
.
	gm‘hod
;

64 @
RunW™h
(
Pow”MockRuÂ”
.
şass
)

65 @
	$P»·»FÜTe¡
(
HBa£R—d”M­³r
.
şass
)

66 
public
 cÏs 
	cHBa£R—d”M­³rTe¡
 {

67 
´iv©e
 
M­Driv”
<
ImmubËBy‹sWr™abË
, 
ResuÉ
, 
IÁWr™abË
, 
Prİ”tyG¿phEËm’t
> 
m­Driv”
;

68 
´iv©e
 
HBa£R—d”M­³r
 
hBa£R—d”M­³r
;

69 
´iv©e
 
HBa£R—d”M­³r
 
¥›dHBa£R—d”M­³r
;

70 
´iv©e
 
CÚfigu¿tiÚ
 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

71 
´iv©e
 
M­³r
.
CÚ‹xt
 
m­³rCÚ‹xtMock
;

72 
´iv©e
 
Prİ”tyG¿phEËm’tSŒšgTy³Vids
 
v®ueCÏss
;

73 
´iv©e
 
Logg”
 
logg”Mock
;

74 
´iv©e
 
ImmubËBy‹sWr™abË
 
key
;

75 
´iv©e
 
RecÜdTy³HBa£Row
 
»cÜdTy³HBa£Row
;

76 
´iv©e
 
ResuÉ
 
»suÉ
;

78 
Ba£M­³r
 
ba£M­³r
;

79 
Ba£M­³r
 
¥›dBa£M­³r
;

81 @
Aá”


82 
public
 
fš®
 
	$‹¬Down
() {

83 
logg”Mock
 = 
nuÎ
;

84 
v®ueCÏss
 = 
nuÎ
;

85 
m­³rCÚ‹xtMock
 = 
nuÎ
;

86 
cÚf
 = 
nuÎ
;

87 
hBa£R—d”M­³r
 = 
nuÎ
;

88 
¥›dHBa£R—d”M­³r
 = 
nuÎ
;

89 
m­Driv”
 = 
nuÎ
;

91 
ba£M­³r
 = 
nuÎ
;

92 
¥›dBa£M­³r
 = 
nuÎ
;

94 
key
 = 
nuÎ
;

95 
»suÉ
 = 
nuÎ
;

96 
»cÜdTy³HBa£Row
 = 
nuÎ
;

99 @
BefÜeCÏss


100 
public
 
fš®
 
	$befÜeCÏss
(){

103 
Sy¡em
.
	`£tPrİ”ty
("log4j.ignoreTCL","true");

104 
	}
}

106 @
BefÜe


107 
public
 
fš®
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

108 
logg”Mock
 = 
	`mock
(
Logg”
.
şass
);

109 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
HBa£R—d”M­³r
.
şass
, "LOG", 
logg”Mock
);

111 
v®ueCÏss
 = 
	`mock
(
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
);

112 
m­³rCÚ‹xtMock
 = 
	`mock
(
M­³r
.
CÚ‹xt
.
şass
);

114 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

115 
cÚf
.
	`£t
("G¿phTok’iz”", 
HBa£Tok’iz”
.
şass
.
	`g‘Name
());

116 
cÚf
.
	`£t
("KeyFunùiÚ", 
SourûV”‹xKeyFunùiÚ
.
şass
.
	`g‘Name
());

120 
SŒšg
[] 
v”‹xRuËs
 = 
Ãw
 String[1];

121 
v”‹xRuËs
[0] = "cf:name=cf:age,cf:dept";

122 
HBa£G¿phBudšgRuË
.
	`·ckV”‹xRuËsIÁoCÚfigu¿tiÚ
(
cÚf
, 
v”‹xRuËs
);

124 
SŒšg
[] 
edgeRuËs
 = 
Ãw
 String[0];

125 
HBa£G¿phBudšgRuË
.
	`·ckEdgeRuËsIÁoCÚfigu¿tiÚ
(
cÚf
, 
edgeRuËs
);

127 
SŒšg
[] 
dœeùedEdgeRuËs
 = 
Ãw
 String[1];

128 
dœeùedEdgeRuËs
[0] = "cf:name,cf:dept,worksAt";

129 
HBa£G¿phBudšgRuË
.
	`·ckDœeùedEdgeRuËsIÁoCÚfigu¿tiÚ
(
cÚf
, 
dœeùedEdgeRuËs
);

132 
CÏss
 
v®CÏss
 = 
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
;

133 
Pow”Mock™o
.
	`wh’
(
m­³rCÚ‹xtMock
.
	`g‘M­OuutV®ueCÏss
()).
	`th’R‘uº
(
v®CÏss
);

135 
ba£M­³r
 = 
Ãw
 
	`Ba£M­³r
(
m­³rCÚ‹xtMock
, 
cÚf
, 
logg”Mock
);

136 
¥›dBa£M­³r
 = 
	`¥y
(
ba£M­³r
);

137 
Pow”Mock™o
.
	`wh’New
(
Ba£M­³r
.
şass
).
	`w™hAnyArgum’ts
().
	`th’R‘uº
(
¥›dBa£M­³r
);

139 
¥›dBa£M­³r
.
	`£tV®CÏss
(
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
);

140 
	`doNÙhšg
().
	`wh’
(
¥›dBa£M­³r
).
	`£tV®CÏss
(
	`ªy
(
CÏss
.
şass
));

142 
¥›dBa£M­³r
.
	`£tM­V®
(
Prİ”tyG¿phEËm’tSŒšgTy³Vids
.
şass
.
	`ÃwIn¡ªû
());

143 
	`doNÙhšg
().
	`wh’
(
¥›dBa£M­³r
).
	`£tM­V®
(
	`ªy
(
Prİ”tyG¿phEËm’t
.
şass
));

146 
hBa£R—d”M­³r
 = 
Ãw
 
	`HBa£R—d”M­³r
();

147 
¥›dHBa£R—d”M­³r
 = 
	`¥y
(
hBa£R—d”M­³r
);

148 
¥›dHBa£R—d”M­³r
.
	`£tBa£M­³r
(
¥›dBa£M­³r
);

151 
key
 = 
Ãw
 
	`ImmubËBy‹sWr™abË
(
By‹s
.
	`toBy‹s
("row1"));

154 
»suÉ
 = 
	`§m¶eD©a
();

156 
»cÜdTy³HBa£Row
 = 
Ãw
 
	`RecÜdTy³HBa£Row
(
key
, 
»suÉ
);

159 
	}
}

161 @
Te¡


162 
public
 
fš®
 
	$v”ify_wr™es_w™h_good_šput
(è
throws
 
Exû±iÚ
 {

164 
	`wh’
(
¥›dHBa£R—d”M­³r
, 
	`m‘hod
(
HBa£R—d”M­³r
.
şass
, "getRecordTypeHBaseRow",

165 
ImmubËBy‹sWr™abË
.
şass
, 
ResuÉ
.class))

166 .
	`w™hArgum’ts
(
	`ªy
(
ImmubËBy‹sWr™abË
.
şass
),‡ny(
ResuÉ
.class))

167 .
	`th’R‘uº
(
»cÜdTy³HBa£Row
);

170 
m­Driv”
 = 
M­Driv”
.
	`ÃwM­Driv”
(
¥›dHBa£R—d”M­³r
);

173 
m­Driv”
.
	`w™hCÚfigu¿tiÚ
(
cÚf
).
	`w™hIÅut
(
key
, 
»suÉ
);

176 
Li¡
<
Paœ
<
IÁWr™abË
, 
Prİ”tyG¿phEËm’t
>> 
wr™abËs
 = 
m­Driv”
.
	`run
();

179 
	`as£¹True
("check fÜ fou¸wr™es", 
wr™abËs
.
	`size
() == 4);

180 
	`as£¹Equ®s
("verify context column counter", 5,

181 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_COLS_READ
).
	`g‘V®ue
());

182 
	`as£¹Equ®s
("verify context„ow counter", 1,

183 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
GBHTabËCÚfigu¿tiÚ
.
CouÁ”s
.
HTABLE_ROWS_READ
).
	`g‘V®ue
());

186 
	`as£¹Equ®s
("verify contextƒdgeƒrror counter", 0,

187 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
Ba£M­³r
.
	`g‘EdgeWr™eE¼ÜCouÁ”
()).
	`g‘V®ue
());

188 
	`as£¹Equ®s
("verify context vertexƒrror counter", 0,

189 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
Ba£M­³r
.
	`g‘V”‹xWr™eE¼ÜCouÁ”
()).
	`g‘V®ue
());

194 
Edge
<
SŒšgTy³
> 
edge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
("Alice"),‚ew StringType("GAO123"),

195 
Ãw
 
	`SŒšgTy³
("worksAt"));

197 
	`v”ifyPaœSecÚd
(
wr™abËs
.
	`g‘
(0), "EDGE", 
edge
, 
nuÎ
);

200 
V”‹x
<
SŒšgTy³
> 
v”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
("Alice"));

201 
v”‹x
.
	`£tPrİ”ty
("cf:d•t", 
Ãw
 
	`SŒšgTy³
("GAO123"));

202 
v”‹x
.
	`£tPrİ”ty
("cf:age", 
Ãw
 
	`SŒšgTy³
("43"));

205 
	`v”ifyPaœSecÚd
(
wr™abËs
.
	`g‘
(1), "VERTEX", 
nuÎ
, 
v”‹x
);

207 
v”‹x
 = 
Ãw
 
V”‹x
<
SŒšgTy³
>Òew 
	`SŒšgTy³
("Alice"));

208 
	`v”ifyPaœSecÚd
(
wr™abËs
.
	`g‘
(2), "VERTEX", 
nuÎ
, 
v”‹x
);

210 
v”‹x
 = 
Ãw
 
V”‹x
<
SŒšgTy³
>Òew 
	`SŒšgTy³
("GAO123"));

211 
	`v”ifyPaœSecÚd
(
wr™abËs
.
	`g‘
(3), "VERTEX", 
nuÎ
, 
v”‹x
);

212 
	}
}

214 @
Te¡


215 
public
 
fš®
 
	$v”ify_nuÎ_¤c_š_edge_logs_nuÎ_poš‹r_exû±iÚ
(è
throws
 
Exû±iÚ
 {

217 
	`wh’
(
¥›dHBa£R—d”M­³r
, 
	`m‘hod
(
HBa£R—d”M­³r
.
şass
, "getRecordTypeHBaseRow",

218 
ImmubËBy‹sWr™abË
.
şass
, 
ResuÉ
.class))

219 .
	`w™hArgum’ts
(
	`ªy
(
ImmubËBy‹sWr™abË
.
şass
),‡ny(
ResuÉ
.class))

220 .
	`th’R‘uº
(
»cÜdTy³HBa£Row
);

222 
HBa£Tok’iz”
 
¥›dHBa£Tok’iz”
 = 
	`g‘Tok’iz”
();

225 
Edge
<
SŒšgTy³
> 
brok’Edge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
(
nuÎ
),‚ew StringType("GAO123"),

226 
Ãw
 
	`SŒšgTy³
("worksAt"));

227 
A¼ayLi¡
<
Edge
<
SŒšgTy³
>> 
brok’EdgeLi¡
 = 
Ãw
 A¼ayLi¡<Edge<SŒšgTy³>>(
A¼ays
.
	`asLi¡
(
brok’Edge
));

229 
	`wh’
(
¥›dHBa£Tok’iz”
.
	`g‘Edges
()).
	`th’R‘uº
(
brok’EdgeLi¡
.
	`™”©Ü
());

232 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
¥›dBa£M­³r
, "tok’iz”", 
¥›dHBa£Tok’iz”
);

234 
m­Driv”
 = 
M­Driv”
.
	`ÃwM­Driv”
(
¥›dHBa£R—d”M­³r
);

235 
m­Driv”
.
	`w™hCÚfigu¿tiÚ
(
cÚf
).
	`w™hIÅut
(
key
, 
»suÉ
);

236 
m­Driv”
.
	`run
();

239 
	`v”ify
(
logg”Mock
).
	`”rÜ
(
	`ªy
(
SŒšg
.
şass
),‡ny(
NuÎPoš‹rExû±iÚ
.class));

241 
	`as£¹Equ®s
("verifyheƒdgeƒrror counter isƒqualo one", 1,

242 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
Ba£M­³r
.
	`g‘EdgeWr™eE¼ÜCouÁ”
()).
	`g‘V®ue
());

243 
	}
}

245 @
Te¡


246 
public
 
fš®
 
	$v”ify_nuÎ_d¡_š_edge_logs_nuÎ_poš‹r_exû±iÚ
(è
throws
 
Exû±iÚ
 {

248 
	`wh’
(
¥›dHBa£R—d”M­³r
, 
	`m‘hod
(
HBa£R—d”M­³r
.
şass
, "getRecordTypeHBaseRow",

249 
ImmubËBy‹sWr™abË
.
şass
, 
ResuÉ
.class))

250 .
	`w™hArgum’ts
(
	`ªy
(
ImmubËBy‹sWr™abË
.
şass
),‡ny(
ResuÉ
.class))

251 .
	`th’R‘uº
(
»cÜdTy³HBa£Row
);

253 
HBa£Tok’iz”
 
¥›dHBa£Tok’iz”
 = 
	`g‘Tok’iz”
();

256 
Edge
<
SŒšgTy³
> 
brok’Edge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
("Aliû"),‚ew SŒšgTy³(
nuÎ
),

257 
Ãw
 
	`SŒšgTy³
("worksAt"));

258 
A¼ayLi¡
<
Edge
<
SŒšgTy³
>> 
brok’EdgeLi¡
 = 
Ãw
 A¼ayLi¡<Edge<SŒšgTy³>>(
A¼ays
.
	`asLi¡
(
brok’Edge
));

260 
	`wh’
(
¥›dHBa£Tok’iz”
.
	`g‘Edges
()).
	`th’R‘uº
(
brok’EdgeLi¡
.
	`™”©Ü
());

262 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
¥›dBa£M­³r
, "tok’iz”", 
¥›dHBa£Tok’iz”
);

264 
m­Driv”
 = 
M­Driv”
.
	`ÃwM­Driv”
(
¥›dHBa£R—d”M­³r
);

265 
m­Driv”
.
	`w™hCÚfigu¿tiÚ
(
cÚf
).
	`w™hIÅut
(
key
, 
»suÉ
);

266 
m­Driv”
.
	`run
();

268 
	`v”ify
(
logg”Mock
).
	`”rÜ
(
	`ªy
(
SŒšg
.
şass
),‡ny(
NuÎPoš‹rExû±iÚ
.class));

269 
	`as£¹Equ®s
("verifyheƒdgeƒrror counter isƒqualo one", 1,

270 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
Ba£M­³r
.
	`g‘EdgeWr™eE¼ÜCouÁ”
()).
	`g‘V®ue
());

271 
	}
}

274 @
Te¡


275 
public
 
fš®
 
	$‹¡_nuÎ_Ïb–_š_edge_logs_nuÎ_poš‹r_exû±iÚ
(è
throws
 
Exû±iÚ
 {

277 
	`wh’
(
¥›dHBa£R—d”M­³r
, 
	`m‘hod
(
HBa£R—d”M­³r
.
şass
, "getRecordTypeHBaseRow",

278 
ImmubËBy‹sWr™abË
.
şass
, 
ResuÉ
.class))

279 .
	`w™hArgum’ts
(
	`ªy
(
ImmubËBy‹sWr™abË
.
şass
),‡ny(
ResuÉ
.class))

280 .
	`th’R‘uº
(
»cÜdTy³HBa£Row
);

282 
HBa£Tok’iz”
 
¥›dHBa£Tok’iz”
 = 
	`g‘Tok’iz”
();

284 
Edge
<
SŒšgTy³
> 
brok’Edge
 = 
Ãw
 Edge<SŒšgTy³>Òew 
	`SŒšgTy³
("Alice"),‚ew StringType("GAO123"),

285 
Ãw
 
	`SŒšgTy³
(
nuÎ
));

286 
A¼ayLi¡
<
Edge
<
SŒšgTy³
>> 
brok’EdgeLi¡
 = 
Ãw
 A¼ayLi¡<Edge<SŒšgTy³>>(
A¼ays
.
	`asLi¡
(
brok’Edge
));

287 
	`wh’
(
¥›dHBa£Tok’iz”
.
	`g‘Edges
()).
	`th’R‘uº
(
brok’EdgeLi¡
.
	`™”©Ü
());

289 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
¥›dBa£M­³r
, "tok’iz”", 
¥›dHBa£Tok’iz”
);

291 
m­Driv”
 = 
M­Driv”
.
	`ÃwM­Driv”
(
¥›dHBa£R—d”M­³r
);

292 
m­Driv”
.
	`w™hCÚfigu¿tiÚ
(
cÚf
).
	`w™hIÅut
(
key
, 
»suÉ
);

293 
m­Driv”
.
	`run
();

295 
	`v”ify
(
logg”Mock
).
	`”rÜ
(
	`ªy
(
SŒšg
.
şass
),‡ny(
NuÎPoš‹rExû±iÚ
.class));

296 
	`as£¹Equ®s
("verifyheƒdgeƒrror counter isƒqualo one", 1,

297 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
Ba£M­³r
.
	`g‘EdgeWr™eE¼ÜCouÁ”
()).
	`g‘V®ue
());

298 
	}
}

300 @
Te¡


301 
public
 
fš®
 
	$‹¡_nuÎ_v”‹x_id_logs_nuÎ_poš‹r_exû±iÚ
(è
throws
 
Exû±iÚ
 {

303 
	`wh’
(
¥›dHBa£R—d”M­³r
, 
	`m‘hod
(
HBa£R—d”M­³r
.
şass
, "getRecordTypeHBaseRow",

304 
ImmubËBy‹sWr™abË
.
şass
, 
ResuÉ
.class))

305 .
	`w™hArgum’ts
(
	`ªy
(
ImmubËBy‹sWr™abË
.
şass
),‡ny(
ResuÉ
.class))

306 .
	`th’R‘uº
(
»cÜdTy³HBa£Row
);

308 
HBa£Tok’iz”
 
¥›dHBa£Tok’iz”
 = 
	`g‘Tok’iz”
();

310 
V”‹x
<
SŒšgTy³
> 
brok’V”‹x
 = 
Ãw
 V”‹x<SŒšgTy³>Òew 
	`SŒšgTy³
(
nuÎ
));

311 
A¼ayLi¡
<
V”‹x
<
SŒšgTy³
>> 
brok’V”‹xLi¡
 = 
Ãw
 A¼ayLi¡<V”‹x<SŒšgTy³>>(
A¼ays
.
asLi¡


312 (
brok’V”‹x
));

314 
	`wh’
(
¥›dHBa£Tok’iz”
.
	`g‘V”tiûs
()).
	`th’R‘uº
(
brok’V”‹xLi¡
.
	`™”©Ü
());

316 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
¥›dBa£M­³r
, "tok’iz”", 
¥›dHBa£Tok’iz”
);

318 
m­Driv”
 = 
M­Driv”
.
	`ÃwM­Driv”
(
¥›dHBa£R—d”M­³r
);

319 
m­Driv”
.
	`w™hCÚfigu¿tiÚ
(
cÚf
).
	`w™hIÅut
(
key
, 
»suÉ
);

320 
m­Driv”
.
	`run
();

322 
	`v”ify
(
logg”Mock
).
	`”rÜ
(
	`ªy
(
SŒšg
.
şass
),‡ny(
NuÎPoš‹rExû±iÚ
.class));

323 
	`as£¹Equ®s
("verifyhe vertexƒrror counter isƒqualo one", 1,

324 
m­Driv”
.
	`g‘CouÁ”s
().
	`fšdCouÁ”
(
Ba£M­³r
.
	`g‘V”‹xWr™eE¼ÜCouÁ”
()).
	`g‘V®ue
());

325 
	}
}

332 
public
 
fš®
 
ResuÉ
 
	$§m¶eD©a
() {

333 
A¼ayLi¡
<
KeyV®ue
> 
li¡
 = 
Ãw
 ArrayList<KeyValue>();

335 
li¡
.
	`add
(
	`ÃwKeyV®ue
("row1", "cf", "age", "43", "1381447886360"));

336 
li¡
.
	`add
(
	`ÃwKeyV®ue
("row1", "cf", "dept", "GAO123", "1381447886375"));

337 
li¡
.
	`add
(
	`ÃwKeyV®ue
("row1", "cf", "id", "0001", "1381447886305"));

338 
li¡
.
	`add
(
	`ÃwKeyV®ue
("row1", "cf", "manager", "Zed", "1381447886386"));

339 
li¡
.
	`add
(
	`ÃwKeyV®ue
("row1", "cf", "name", "Alice", "1381447886328"));

340 
li¡
.
	`add
(
	`ÃwKeyV®ue
("row1", "cf", "underManager", "5yrs", "1381447886400"));

342  
Ãw
 
	`ResuÉ
(
li¡
);

343 
	}
}

351 
public
 
fš®
 
	$´štSam¶eD©a
(è
throws
 
UnsuµÜ‹dEncodšgExû±iÚ
 {

352 
ResuÉ
 
»suÉ
 = 
	`§m¶eD©a
();

353 
	`´štSam¶eRow
(
»suÉ
, "cf", "age");

354 
	`´štSam¶eRow
(
»suÉ
, "cf", "dept");

355 
	`´štSam¶eRow
(
»suÉ
, "cf", "id");

356 
	`´štSam¶eRow
(
»suÉ
, "cf", "manager");

357 
	`´štSam¶eRow
(
»suÉ
, "cf", "name");

358 
	`´štSam¶eRow
(
»suÉ
, "cf", "group");

359 
	`´štSam¶eRow
(
»suÉ
, "cf", "underManager");

360 
	}
}

362 
public
 
fš®
 
	$´štSam¶eRow
(
ResuÉ
 
»suÉ
, 
SŒšg
 
cf
, SŒšg 
qu®if›r
è
throws
 
UnsuµÜ‹dEncodšgExû±iÚ
 {

363 
Sy¡em
.
out
.
	`´šn
((
cf
 + ":" + 
qu®if›r
 + " value: " +

364 
By‹s
.
	`toSŒšg
(
»suÉ
.
	`g‘V®ue
(
cf
.
	`g‘By‹s
(
HCÚ¡ªts
.
UTF8_ENCODING
),

365 
qu®if›r
.
	`g‘By‹s
(
HCÚ¡ªts
.
UTF8_ENCODING
)))));

366 
	}
}

379 
public
 
fš®
 
KeyV®ue
 
	$ÃwKeyV®ue
(
SŒšg
 
row
, SŒšg 
cf
, SŒšg 
qu®if›r
, SŒšg 
v®ue
, SŒšg 
time
) {

380 
KeyV®ue
 
k1
;

381 
Œy
 {

382 
k1
 = 
Ãw
 
	`KeyV®ue
(
row
.
	`g‘By‹s
(
HCÚ¡ªts
.
UTF8_ENCODING
),

383 
cf
.
	`g‘By‹s
(
HCÚ¡ªts
.
UTF8_ENCODING
),

384 
qu®if›r
.
	`g‘By‹s
(
HCÚ¡ªts
.
UTF8_ENCODING
), 
LÚg
.
	`v®ueOf
(
time
), 
KeyV®ue
.
Ty³
.
Put
,

385 
v®ue
.
	`g‘By‹s
(
HCÚ¡ªts
.
UTF8_ENCODING
));

386 } 
	`ÿtch
 (
UnsuµÜ‹dEncodšgExû±iÚ
 
e
) {

387  
nuÎ
;

389  
k1
;

390 
	}
}

401 
public
 
fš®
 
v”ifyPaœSecÚd
(
Paœ
<
IÁWr™abË
, 
Prİ”tyG¿phEËm’t
> 
·œ
, 
SŒšg
 
g¿phEËm’tTy³
,

402 
Edge
<
SŒšgTy³
> 
edge
, 
V”‹x
<SŒšgTy³> 
v”‹x
) {

404 
as£¹Equ®s
("V”yfiy Ty³", 
g¿phEËm’tTy³
, 
·œ
.
g‘SecÚd
().g¿phEËm’tTy³().
toSŒšg
());

405 ià(
	g·œ
.
g‘SecÚd
().
g¿phEËm’tTy³
().
toSŒšg
().
equ®s
("EDGE")) {

406 
as£¹True
(
·œ
.
g‘SecÚd
().
edge
().
g‘Src
().
equ®s
(edge.getSrc()));

407 
as£¹True
(
·œ
.
g‘SecÚd
().
edge
().
g‘D¡
().
equ®s
(edge.getDst()));

408 
as£¹True
(
·œ
.
g‘SecÚd
().
edge
().
g‘EdgeLab–
().
equ®s
(edge.getEdgeLabel()));

409 
Wr™abË
 
	gwr™abË
 : 
·œ
.
g‘SecÚd
().
edge
().
g‘Prİ”t›s
().
g‘Prİ”tyKeys
()) {

410 
SŒšg
 
key
 = ((
SŒšgTy³
è
wr™abË
).
g‘
();

411 
SŒšg
 
	gv®ue
 = ((
SŒšgTy³
è
·œ
.
g‘SecÚd
().
edge
().
g‘Prİ”ty
(
key
)).
g‘
();

412 
as£¹True
(
SŒšg
.
fÜm©
("Look fÜ %s:% ·œ iÀou¸ba£lšobjeù ", 
key
, 
v®ue
),

413 ((
SŒšgTy³
è
edge
.
g‘Prİ”ty
(
key
)).
g‘
().
equ®s
(
v®ue
));

415 } ià(
	g·œ
.
g‘SecÚd
().
g¿phEËm’tTy³
().
toSŒšg
().
equ®s
("VERTEX")) {

416 
as£¹True
("", 
·œ
.
g‘SecÚd
().
v”‹x
().
g‘V”‹xId
().
equ®s
(vertex.getVertexId()));

417 
Wr™abË
 
	gwr™abË
 : 
·œ
.
g‘SecÚd
().
v”‹x
().
g‘Prİ”t›s
().
g‘Prİ”tyKeys
()) {

418 
SŒšg
 
key
 = ((
SŒšgTy³
è
wr™abË
).
g‘
();

419 
SŒšg
 
	gv®ue
 = ((
SŒšgTy³
è
·œ
.
g‘SecÚd
().
v”‹x
().
g‘Prİ”ty
(
key
)).
g‘
();

420 
as£¹True
(
SŒšg
.
fÜm©
("Look fÜ %s:% ·œ iÀou¸ba£lšobjeù ", 
key
, 
v®ue
),

421 ((
SŒšgTy³
è
v”‹x
.
g‘Prİ”ty
(
key
)).
g‘
().
equ®s
(
v®ue
));

432 
public
 
fš®
 
HBa£Tok’iz”
 
	$g‘Tok’iz”
(è
throws
 
P¬£rCÚfigu¿tiÚExû±iÚ
 {

433 
HBa£Tok’iz”
 HBa£Tok’iz” = 
Ãw
 
	`HBa£Tok’iz”
();

434 
HBa£Tok’iz”
 
¥›dHBa£Tok’iz”
 = 
	`¥y
(HBaseTokenizer);

435 
¥›dHBa£Tok’iz”
.
	`cÚfigu»
(
cÚf
);

436  
¥›dHBa£Tok’iz”
;

437 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/input/text/TextParsingMapperTests.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	g‹xt
;

22 
impÜt
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gšput
.
	ghba£
.
	gHBa£R—d”M­³r
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”
.
	gRunW™h
;

25 
impÜt
 
	gÜg
.
	gpow”mock
.
	gcÜe
.
	gşas¦ßd”
.
	gªnÙ©iÚs
.
	gP»·»FÜTe¡
;

26 
impÜt
 
	gÜg
.
	gpow”mock
.
	gmoduËs
.
	gjun™4
.
	gPow”MockRuÂ”
;

28 @
RunW™h
(
Pow”MockRuÂ”
.
şass
)

29 @
	$P»·»FÜTe¡
(
HBa£R—d”M­³r
.
şass
)

30 
public
 cÏs 
	cTextP¬sšgM­³rTe¡s
 {

32 @
Te¡


33 
public
 
	$‹¡
(){

36 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/EdgeSchemaTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

27 
public
 cÏs 
	cEdgeSchemaTe¡
 {

29 @
Te¡


30 
public
 
	$edgeSchemaCÚ¡ruùÜTe¡
(è
throws
 
Exû±iÚ
 {

32 
fš®
 
SŒšg
 
THE_EDGE
 = "The Edge";

33 
fš®
 
SŒšg
 
BONO
 = "Bono";

35 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
(
THE_EDGE
);

37 
	`as£¹NÙNuÎ
(
edgeSchema
.
	`g‘Prİ”tySchem©a
());

38 
	`as£¹
(
edgeSchema
.
	`g‘Lab–
().
	`com·»To
(
THE_EDGE
) == 0);

41 @
Te¡


42 
public
 
	$edgeSchemaS‘G‘Lab–Te¡
() {

44 
fš®
 
SŒšg
 
THE_EDGE
 = "The Edge";

45 
fš®
 
SŒšg
 
BONO
 = "Bono";

47 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
(
THE_EDGE
);

49 
	`as£¹
(
edgeSchema
.
	`g‘Lab–
().
	`com·»To
(
THE_EDGE
) == 0);

51 
edgeSchema
.
	`£tLab–
(
BONO
);

52 
	`as£¹
(
edgeSchema
.
	`g‘Lab–
().
	`com·»To
(
BONO
) == 0);

54 
edgeSchema
.
	`£tLab–
(
THE_EDGE
);

55 
	`as£¹
(
edgeSchema
.
	`g‘Lab–
().
	`com·»To
(
THE_EDGE
) == 0);

56 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertyGraphSchemaTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

25 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙSame
;

27 
public
 cÏs 
	cPrİ”tyG¿phSchemaTe¡
 {

29 @
Te¡


30 
public
 
	$‹¡Prİ”tyG¿phSchemaCÚ¡ruùÜ
() {

32 
Prİ”tyG¿phSchema
 
g¿phSchema
 = 
Ãw
 
	`Prİ”tyG¿phSchema
();

34 
	`as£¹NÙNuÎ
(
g¿phSchema
.
	`g‘V”‹xSchem©a
());

35 
	`as£¹NÙNuÎ
(
g¿phSchema
.
	`g‘EdgeSchem©a
());

37 
	`as£¹NÙSame
(
g¿phSchema
.
	`g‘EdgeSchem©a
(), g¿phSchema.
	`g‘V”‹xSchem©a
());

40 @
Te¡


41 
public
 
	$‹¡AddV”‹xSchema
() {

43 
Prİ”tyG¿phSchema
 
g¿phSchema
 = 
Ãw
 
	`Prİ”tyG¿phSchema
();

45 
V”‹xSchema
 
v”‹xSchema
 = 
Ãw
 
	`V”‹xSchema
();

47 
g¿phSchema
.
	`addV”‹xSchema
(
v”‹xSchema
);

49 
	`as£¹
(
g¿phSchema
.
	`g‘V”‹xSchem©a
().
	`cÚšs
(
v”‹xSchema
));

50 
	}
}

52 @
Te¡


53 
public
 
	$‹¡AddEdgeSchema
() {

55 
Prİ”tyG¿phSchema
 
g¿phSchema
 = 
Ãw
 
	`Prİ”tyG¿phSchema
();

57 
EdgeSchema
 
edgeSchema
 = 
Ãw
 
	`EdgeSchema
("foo");

59 
g¿phSchema
.
	`addEdgeSchema
(
edgeSchema
);

61 
	`as£¹
(
g¿phSchema
.
	`g‘EdgeSchem©a
().
	`cÚšs
(
edgeSchema
));

62 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertySchemaTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

25 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

27 
public
 cÏs 
	cPrİ”tySchemaTe¡
 {

30 @
Te¡


31 
public
 
	$‹¡Prİ”tySchemaCÚ¡ruùÜG‘‹rs
() {

33 
fš®
 
SŒšg
 
A
 = 
Ãw
 
	`SŒšg
("A");

34 
fš®
 
CÏss
<?> 
d©aTy³
 = 
IÁeg”
.
şass
;

36 
Prİ”tySchema
 
´İ”tySchema
 = 
Ãw
 
	`Prİ”tySchema
(
A
, 
d©aTy³
);

39 
SŒšg
 
‹¡Name
 = 
´İ”tySchema
.
	`g‘Name
();

40 
CÏss
<?> 
‹¡D©aTy³
 = 
´İ”tySchema
.
	`g‘Ty³
();

42 
	`as£¹NÙNuÎ
(
‹¡Name
);

43 
	`as£¹
(
‹¡Name
.
	`com·»To
(
A
) == 0);

44 
	`as£¹Equ®s
(
d©aTy³
,
‹¡D©aTy³
);

47 @
Te¡


48 
public
 
	$‹¡Prİ”tySchemaS‘G‘
() {

49 
fš®
 
SŒšg
 
A
 = 
Ãw
 
	`SŒšg
("A");

50 
fš®
 
CÏss
<?> 
d©aTy³A
 = 
IÁeg”
.
şass
;

52 
fš®
 
SŒšg
 
B
 = 
Ãw
 
	`SŒšg
("A");

53 
fš®
 
CÏss
<?> 
d©aTy³B
 = 
Flßt
.
şass
;

55 
fš®
 
SŒšg
 
C
 = 
Ãw
 
	`SŒšg
("C");

56 
fš®
 
CÏss
<?> 
d©aTy³C
 = 
SŒšg
.
şass
;

58 
Prİ”tySchema
 
´İ”tySchemaA
 = 
Ãw
 
	`Prİ”tySchema
(
A
, 
d©aTy³A
);

59 
Prİ”tySchema
 
´İ”tySchemaB
 = 
Ãw
 
	`Prİ”tySchema
(
B
, 
d©aTy³B
);

61 
´İ”tySchemaA
.
	`£tName
(
C
);

63 
SŒšg
 
‹¡Name1
 = 
´İ”tySchemaA
.
	`g‘Name
();

64 
CÏss
<?> 
‹¡Ty³1
 = 
´İ”tySchemaA
.
	`g‘Ty³
();

65 
	`as£¹
(
‹¡Name1
.
	`com·»To
(
C
) == 0);

66 
	`as£¹Equ®s
(
d©aTy³A
, 
‹¡Ty³1
);

68 
´İ”tySchemaA
.
	`£tTy³
(
d©aTy³C
);

70 
SŒšg
 
‹¡Name2
 = 
´İ”tySchemaA
.
	`g‘Name
();

71 
CÏss
<?> 
‹¡Ty³2
 = 
´İ”tySchemaA
.
	`g‘Ty³
();

72 
	`as£¹
(
‹¡Name2
.
	`com·»To
(
C
) == 0);

73 
	`as£¹Equ®s
(
d©aTy³C
, 
‹¡Ty³2
);

75 
´İ”tySchemaA
.
	`£tName
(
A
);

77 
SŒšg
 
‹¡Name3
 = 
´İ”tySchemaA
.
	`g‘Name
();

78 
CÏss
<?> 
‹¡Ty³3
 = 
´İ”tySchemaA
.
	`g‘Ty³
();

79 
	`as£¹
(
‹¡Name3
.
	`com·»To
(
A
) == 0);

80 
	`as£¹Equ®s
(
d©aTy³C
, 
‹¡Ty³3
);

82 
´İ”tySchemaA
.
	`£tTy³
(
d©aTy³A
);

84 
SŒšg
 
‹¡Name4
 = 
´İ”tySchemaA
.
	`g‘Name
();

85 
CÏss
<?> 
‹¡Ty³4
 = 
´İ”tySchemaA
.
	`g‘Ty³
();

86 
	`as£¹
(
‹¡Name4
.
	`com·»To
(
A
) == 0);

87 
	`as£¹Equ®s
(
d©aTy³A
, 
‹¡Ty³4
);

89 
SŒšg
 
di¡šùName
 = 
´İ”tySchemaB
.
	`g‘Name
();

90 
CÏss
<?> 
di¡šùTy³
 = 
´İ”tySchemaB
.
	`g‘Ty³
();

91 
	`as£¹
(
di¡šùName
.
	`com·»To
(
B
) == 0);

92 
	`as£¹Equ®s
(
d©aTy³B
, 
di¡šùTy³
);

93 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/VertexSchemaTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gp–šem‘ad©a
.
	g´İ”tyg¿phschema
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

27 
public
 cÏs 
	cV”‹xSchemaTe¡
 {

29 @
Te¡


30 
public
 
	$‹¡G‘Prİ”tySchem©a
() {

31 
V”‹xSchema
 
v”‹xSchema
 = 
Ãw
 
	`V”‹xSchema
();

32 
	`as£¹NÙNuÎ
(
v”‹xSchema
.
	`g‘Prİ”tySchem©a
());

34 
	}
}

	@test/com/intel/hadoop/graphbuilder/pipeline/tokenizer/RecordTypeHBaseRowTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gp–še
.
	gtok’iz”
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gş›Á
.
	gResuÉ
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	ghba£
.
	gio
.
	gImmubËBy‹sWr™abË
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

26 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

27 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Same
;

29 
public
 cÏs 
	cRecÜdTy³HBa£RowTe¡
 {

31 @
Te¡


32 
public
 
	$‹¡CÚ¡ruùÜG‘
() {

33 
ImmubËBy‹sWr™abË
 
row
 = 
Ãw
 
	`ImmubËBy‹sWr™abË
();

34 
ResuÉ
 
cŞumns
 = 
Ãw
 
	`ResuÉ
();

35 
RecÜdTy³HBa£Row
 
»cÜd
 = 
Ãw
 
	`RecÜdTy³HBa£Row
(
row
, 
cŞumns
);

37 
	`as£¹NÙNuÎ
(
»cÜd
);

38 
	`as£¹Same
(
row
, 
»cÜd
.
	`g‘Row
());

39 
	`as£¹Same
(
cŞumns
, 
»cÜd
.
	`g‘CŞumns
());

42 @
Te¡


43 
public
 
	$‹¡S‘G‘Row
() {

44 
ImmubËBy‹sWr™abË
 
row1
 = 
Ãw
 
	`ImmubËBy‹sWr™abË
();

45 
ResuÉ
 
cŞumns
 = 
Ãw
 
	`ResuÉ
();

46 
ImmubËBy‹sWr™abË
 
row2
 = 
Ãw
 
	`ImmubËBy‹sWr™abË
();

47 
ImmubËBy‹sWr™abË
 
row3
 = 
Ãw
 
	`ImmubËBy‹sWr™abË
();

49 
RecÜdTy³HBa£Row
 
»cÜd
 = 
Ãw
 
	`RecÜdTy³HBa£Row
(
row1
, 
cŞumns
);

51 
	`as£¹Same
(
row1
, 
»cÜd
.
	`g‘Row
());

52 
	`as£¹Same
(
cŞumns
, 
»cÜd
.
	`g‘CŞumns
());

54 
»cÜd
.
	`£tRow
(
row2
);

55 
	`as£¹Same
(
row2
, 
»cÜd
.
	`g‘Row
());

56 
	`as£¹Same
(
cŞumns
, 
»cÜd
.
	`g‘CŞumns
());

58 
»cÜd
.
	`£tRow
(
row3
);

59 
	`as£¹Same
(
row3
, 
»cÜd
.
	`g‘Row
());

60 
	`as£¹Same
(
cŞumns
, 
»cÜd
.
	`g‘CŞumns
());

62 
	}
}

64 @
Te¡


65 
public
 
	$‹¡S‘G‘CŞumns
() {

66 
ImmubËBy‹sWr™abË
 
row
 = 
Ãw
 
	`ImmubËBy‹sWr™abË
();

67 
ResuÉ
 
cŞumns1
 = 
Ãw
 
	`ResuÉ
();

68 
ResuÉ
 
cŞumns2
 = 
Ãw
 
	`ResuÉ
();

69 
ResuÉ
 
cŞumns3
 = 
Ãw
 
	`ResuÉ
();

71 
RecÜdTy³HBa£Row
 
»cÜd
 = 
Ãw
 
	`RecÜdTy³HBa£Row
(
row
, 
cŞumns1
);

73 
	`as£¹Same
(
row
, 
»cÜd
.
	`g‘Row
());

74 
	`as£¹Same
(
cŞumns1
, 
»cÜd
.
	`g‘CŞumns
());

76 
»cÜd
.
	`£tCŞumns
(
cŞumns2
);

77 
	`as£¹Same
(
row
, 
»cÜd
.
	`g‘Row
());

78 
	`as£¹Same
(
cŞumns2
, 
»cÜd
.
	`g‘CŞumns
());

80 
»cÜd
.
	`£tCŞumns
(
cŞumns3
);

81 
	`as£¹Same
(
row
, 
»cÜd
.
	`g‘Row
());

82 
	`as£¹Same
(
cŞumns3
, 
»cÜd
.
	`g‘CŞumns
());

83 
	}
}

	@test/com/intel/hadoop/graphbuilder/types/PropertyMapTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gty³s
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gDoubËWr™abË
;

23 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gIÁWr™abË
;

24 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gio
.
	gWr™abË
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

27 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

29 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

31 
public
 cÏs 
	cPrİ”tyM­Te¡
 {

32 @
Te¡


33 
public
 
	$‹¡S‘Prİ”ty
(è
throws
 
Exû±iÚ
 {

34 
Prİ”tyM­
 
pm
ğ
Ãw
 
	`Prİ”tyM­
();

36 
IÁWr™abË
 
Úe
 = 
Ãw
 
	`IÁWr™abË
(1);

37 
IÁWr™abË
 
two
 = 
Ãw
 
	`IÁWr™abË
(2);

38 
DoubËWr™abË
 
pi
 = 
Ãw
 
	`DoubËWr™abË
(3.14159);

40 
pm
.
	`£tPrİ”ty
("p1", 
Úe
);

41 
pm
.
	`£tPrİ”ty
("p2", 
pi
);

42 
pm
.
	`£tPrİ”ty
("p1", 
two
);

45 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("p1"), 
two
);

46 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("p2"), 
pi
);

49 @
Te¡


50 
public
 
	$‹¡RemovePrİ”ty
(è
throws
 
Exû±iÚ
 {

51 
Prİ”tyM­
 
pm
ğ
Ãw
 
	`Prİ”tyM­
();

53 
IÁWr™abË
 
Úe
 = 
Ãw
 
	`IÁWr™abË
(1);

54 
DoubËWr™abË
 
pi
 = 
Ãw
 
	`DoubËWr™abË
(3.14159);

56 
pm
.
	`£tPrİ”ty
("p1", 
Úe
);

57 
pm
.
	`£tPrİ”ty
("p2", 
pi
);

59 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("p2"), 
pi
);

61 
pm
.
	`»movePrİ”ty
("p2");

63 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("p1"), 
Úe
);

64 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("p2"), 
nuÎ
);

65 
	}
}

67 @
Te¡


68 
public
 
	$‹¡G‘Prİ”ty
(è
throws
 
Exû±iÚ
 {

69 
Prİ”tyM­
 
pm
ğ
Ãw
 
	`Prİ”tyM­
();

71 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("foo"), 
nuÎ
);

75 
IÁWr™abË
 
Úe
 = 
Ãw
 
	`IÁWr™abË
(1);

76 
IÁWr™abË
 
two
 = 
Ãw
 
	`IÁWr™abË
(2);

77 
DoubËWr™abË
 
pi
 = 
Ãw
 
	`DoubËWr™abË
(3.14159);

79 
pm
.
	`£tPrİ”ty
("foo", 
Úe
);

82 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("foo"), 
Úe
);

83 
	`as£¹Equ®s
(
pm
.
	`g‘Prİ”ty
("foo"), 
Úe
);

84 
	}
}

86 @
Te¡


87 
public
 
	$‹¡G‘Prİ”tyKeys
(è
throws
 
Exû±iÚ
 {

88 
Prİ”tyM­
 
pm
ğ
Ãw
 
	`Prİ”tyM­
();

90 
	`as£¹
(
pm
.
	`g‘Prİ”tyKeys
().
	`isEm±y
());

92 
IÁWr™abË
 
Úe
 = 
Ãw
 
	`IÁWr™abË
(1);

93 
IÁWr™abË
 
two
 = 
Ãw
 
	`IÁWr™abË
(2);

94 
DoubËWr™abË
 
pi
 = 
Ãw
 
	`DoubËWr™abË
(3.14159);

96 
pm
.
	`£tPrİ”ty
("p1", 
Úe
);

97 
pm
.
	`£tPrİ”ty
("p2", 
pi
);

98 
pm
.
	`£tPrİ”ty
("p1", 
two
);

100 
S‘
<
Wr™abË
> 
keyS‘
 = 
pm
.
	`g‘Prİ”tyKeys
();

102 
Wr™abË
 
key
 : 
keyS‘
)

104 
	`as£¹
(
key
.
	`toSŒšg
().
	`com·»To
("p1") == 0 || key.toString().compareTo("p2") == 0);

107 
boŞ—n
 
foundP1
 = 
çl£
;

108 
boŞ—n
 
foundP2
 = 
çl£
;

110 
Wr™abË
 
key
 : 
keyS‘
)

112 
foundP1
 |ğ(
key
.
	`toSŒšg
().
	`com·»To
("p1") == 0);

113 
foundP2
 |ğ(
key
.
	`toSŒšg
().
	`com·»To
("p2") == 0);

116 
	`as£¹
(
foundP1
);

117 
	`as£¹
(
foundP2
);

118 
	}
}

	@test/com/intel/hadoop/graphbuilder/util/RunTimeConfigTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gÜg
.
	g­ache
.
	ghadoİ
.
	gcÚf
.
	gCÚfigu¿tiÚ
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”
.
	gRunW™h
;

27 
impÜt
 
	gÜg
.
	gpow”mock
.
	g­i
.
	gmock™o
.
	gPow”Mock™o
;

28 
impÜt
 
	gÜg
.
	gpow”mock
.
	gcÜe
.
	gşas¦ßd”
.
	gªnÙ©iÚs
.
	gP»·»FÜTe¡
;

29 
impÜt
 
	gÜg
.
	gpow”mock
.
	gmoduËs
.
	gjun™4
.
	gPow”MockRuÂ”
;

30 
impÜt
 
	gÜg
.
	gpow”mock
.
	g»æeù
.
	gWh™ebox
;

32 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

34 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

36 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

39 @
RunW™h
(
Pow”MockRuÂ”
.
şass
)

40 @
	$P»·»FÜTe¡
(
RuÁimeCÚfig
.
şass
)

41 
public
 cÏs 
	cRunTimeCÚfigTe¡
 {

42 
´iv©e
 
fš®
 
SŒšg
 
‹¡LßdšgThroughReæeùiÚ
 = "ahh you found me";

43 
´iv©e
 
fš®
 
HashM­
<
SŒšg
, SŒšg> 
cÚfig
 = 
Ãw
 HashMap<String, String>();

46 
cÚfig
.
	`put
("VIDMAP_HTABLE_NAME", "default…aram");

47 
cÚfig
.
	`put
("HBASE_CACHE_SIZE", "500");

50 
´iv©e
 
fš®
 
SŒšg
 
´İ”t›sFeName
 = "titan-hbase-config";

52 
´iv©e
 
RuÁimeCÚfig
 
ruÁimeCÚfig
;

53 
´iv©e
 
RuÁimeCÚfig
 
mockedRuÁimeCÚfig
;

54 
´iv©e
 
RuÁimeCÚfig
 
¥›dRuÁime
;

56 @
BefÜe


57 
public
 
fš®
 
	$£tUp
() {

58 
mockedRuÁimeCÚfig
 = 
	`mock
(
RuÁimeCÚfig
.
şass
);

59 
ruÁimeCÚfig
 = 
RuÁimeCÚfig
.
	`g‘In¡ªû
();

60 
¥›dRuÁime
 = 
Pow”Mock™o
.
	`¥y
(
ruÁimeCÚfig
);

62 
	}
}

64 @
Aá”


65 
public
 
fš®
 
	$‹¬Down
() {

66 
mockedRuÁimeCÚfig
 = 
nuÎ
;

67 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
RuÁimeCÚfig
.
şass
, "uniqueIn¡ªûOfRuÁimeCÚfig", 
mockedRuÁimeCÚfig
);

68 
ruÁimeCÚfig
 = 
nuÎ
;

69 
¥›dRuÁime
 = 
nuÎ
;

70 
	}
}

72 @
Te¡


73 
public
 
fš®
 
	$v”ify_unique_š¡ªû
() {

75 
RuÁimeCÚfig
 
ruÁimeCÚfig1
 = RuÁimeCÚfig.
	`g‘In¡ªû
();

77 
RuÁimeCÚfig
 
ruÁimeCÚfig2
 = RuÁimeCÚfig.
	`g‘In¡ªû
(
RunTimeCÚfigTe¡
.
şass
);

80 
HashM­
<
SŒšg
, SŒšg> 
cÚfig1
 = 
Wh™ebox
.
	`g‘IÁ”ÇlS‹
(
ruÁimeCÚfig1
, "config");

81 
HashM­
<
SŒšg
, SŒšg> 
cÚfig2
 = 
Wh™ebox
.
	`g‘IÁ”ÇlS‹
(
ruÁimeCÚfig2
, "config");

83 
	`as£¹Equ®s
("maksu»hcÚfig oàbÙh„uÁime i equ®", 
cÚfig1
, 
cÚfig2
);

84 
	}
}

86 @
Te¡


87 
public
 
fš®
 
	$v”ify_unique_š¡ªû_şass_¥ecific_š¡ªtŸtiÚ_fœ¡
() {

88 
mockedRuÁimeCÚfig
 = 
nuÎ
;

89 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
RuÁimeCÚfig
.
şass
, "uniqueIn¡ªûOfRuÁimeCÚfig", 
mockedRuÁimeCÚfig
);

91 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
¥›dRuÁime
, "cÚfig", 
Ãw
 
HashM­
<
SŒšg
, String>());

92 
RuÁimeCÚfig
 
ruÁimeCÚfig1
 = RuÁimeCÚfig.
	`g‘In¡ªû
(
RunTimeCÚfigTe¡
.
şass
);

94 
RuÁimeCÚfig
 
ruÁimeCÚfig2
 = RuÁimeCÚfig.
	`g‘In¡ªû
();

97 
HashM­
<
SŒšg
, SŒšg> 
cÚfig1
 = 
Wh™ebox
.
	`g‘IÁ”ÇlS‹
(
ruÁimeCÚfig1
, "config");

98 
HashM­
<
SŒšg
, SŒšg> 
cÚfig2
 = 
Wh™ebox
.
	`g‘IÁ”ÇlS‹
(
ruÁimeCÚfig2
, "config");

100 
	`as£¹Equ®s
("maksu»hcÚfig oàbÙh„uÁime i equ®", 
cÚfig1
, 
cÚfig2
);

101 
	}
}

103 @
Te¡


104 
public
 
fš®
 
	$v”ify_g¿bbšg_¡©ic_şass_f›lds
() {

105 
mockedRuÁimeCÚfig
 = 
nuÎ
;

106 
Wh™ebox
.
	`£tIÁ”ÇlS‹
(
RuÁimeCÚfig
.
şass
, "uniqueIn¡ªûOfRuÁimeCÚfig", 
mockedRuÁimeCÚfig
);

108 
RuÁimeCÚfig
 
¡©icTe¡
 = RuÁimeCÚfig.
	`g‘In¡ªû
(
RunTimeCÚfigTe¡
.
şass
);

110 
HashM­
<
SŒšg
, SŒšg> 
´iv©eCÚfig
 = 
Wh™ebox
.
	`g‘IÁ”ÇlS‹
(
¡©icTe¡
, "config");

111 
	`as£¹Equ®s
("v”ifyhcÚfig size", 3, 
´iv©eCÚfig
.
	`size
());

112 
	`as£¹Equ®s
("v”ifyhcÚfig v®uequ® ou¸¡©iøv¬ŸbË", 
‹¡LßdšgThroughReæeùiÚ
,

113 
´iv©eCÚfig
.
	`g‘
("testLoadingThroughReflection"));

114 
	`as£¹Equ®s
("v”ifyhcÚfig v®uequ® ou¸¡©iøv¬ŸbË", 
cÚfig
.
	`toSŒšg
(),

115 
´iv©eCÚfig
.
	`g‘
("config"));

116 
	}
}

118 @
Te¡


119 
public
 
fš®
 
	$‹¡_lßdšg_g¿hbbud”_cÚfig_Çme¥aû
() {

120 
CÚfigu¿tiÚ
 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

121 
cÚf
.
	`£t
("graphbuilder.namespace.ValueKeyOne", "one");

122 
cÚf
.
	`£t
("graphbuilder.namespace.ValueKeyTwo", "two");

123 
cÚf
.
	`£t
("graphBuilder.namespace.ValueKeyThree", "three");

125 
¥›dRuÁime
.
	`lßdCÚfig
(
cÚf
);

127 
	`as£¹True
("v”ify v®ukey oÃ", 
¥›dRuÁime
.
	`g‘Prİ”ty
("NAMESPACE_VALUEKEYONE").
	`equ®s
("one"));

128 
	`as£¹True
("v”ify v®ukeywo", 
¥›dRuÁime
.
	`g‘Prİ”ty
("NAMESPACE_VALUEKEYTWO").
	`equ®s
("two"));

129 
	`as£¹True
("verify value keyhree is false‚ame space is incorrect",

130 
¥›dRuÁime
.
	`g‘Prİ”ty
("NAMESPACE_VALUEKEYTHREE"è=ğ
nuÎ
);

131 
Sy¡em
.
out
.
	`´št
(
Œue
);

132 
	}
}

134 @
Te¡


135 
public
 
fš®
 
	$v”ify_g‘Prİ”tyIÁ
() {

136 
CÚfigu¿tiÚ
 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

137 
cÚf
.
	`£t
("graphbuilder.namespace.ValueKeyOne", "1");

139 
¥›dRuÁime
.
	`lßdCÚfig
(
cÚf
);

141 
	`as£¹True
("v”ify v®ukey oÃ", 
¥›dRuÁime
.
	`g‘Prİ”tyIÁ
("NAMESPACE_VALUEKEYONE") == 1);

142 
	}
}

144 @
Te¡


145 
public
 
fš®
 
	$‹¡_lßdšg_cÚfig_key_·rsšg
() {

146 
CÚfigu¿tiÚ
 
cÚf
 = 
Ãw
 
	`CÚfigu¿tiÚ
();

147 
cÚf
.
	`£t
("graphbuilder.namespace.ValueKeyOne", "one");

148 
cÚf
.
	`£t
("graphbuilder.namespace_ValueKeyTwo", "two");

149 
cÚf
.
	`£t
("graphbuilder.name.space.Value.Key.Three", "three");

151 
¥›dRuÁime
.
	`lßdCÚfig
(
cÚf
);

153 
	`as£¹True
("v”ify v®ukey oÃ", 
¥›dRuÁime
.
	`g‘Prİ”ty
("NAMESPACE_VALUEKEYONE").
	`equ®s
("one"));

154 
	`as£¹True
("v”ify v®ukeywo", 
¥›dRuÁime
.
	`g‘Prİ”ty
("NAMESPACE_VALUEKEYTWO").
	`equ®s
("two"));

155 
	`as£¹True
("verify value keyhree",

156 
¥›dRuÁime
.
	`g‘Prİ”ty
("NAME_SPACE_VALUE_KEY_THREE").
	`equ®s
("three"));

157 
	}
}

	@test/com/intel/hadoop/graphbuilder/util/TripleTest.java

20 
·ckage
 
	gcom
.
	gš‹l
.
	ghadoİ
.
	gg¿phbud”
.
	gut
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹Equ®s
;

25 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹F®£
;

26 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

28 
public
 cÏs 
	cTrËTe¡
 {

29 @
Te¡


30 
public
 
	$‹¡G‘A
(è
throws
 
Exû±iÚ
 {

31 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

33 
a
 = 
t
.
	`g‘A
();

34 
	`as£¹Equ®s
(
a
, 7);

37 @
Te¡


38 
public
 
	$‹¡G‘B
(è
throws
 
Exû±iÚ
 {

39 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

41 
b
 = 
t
.
	`g‘B
();

42 
	`as£¹Equ®s
(
b
, 8);

43 
	}
}

45 @
Te¡


46 
public
 
	$‹¡G‘C
(è
throws
 
Exû±iÚ
 {

47 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

49 
c
 = 
t
.
	`g‘C
();

50 
	`as£¹Equ®s
(
c
, 9);

51 
	}
}

53 @
Te¡


54 
public
 
	$‹¡S‘A
(è
throws
 
Exû±iÚ
 {

55 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

57 
t
.
	`£tA
(3);

59 
a
 = 
t
.
	`g‘A
();

60 
b
 = 
t
.
	`g‘B
();

61 
c
 = 
t
.
	`g‘C
();

63 
	`as£¹Equ®s
(
a
, 3);

64 
	`as£¹Equ®s
(
b
, 8);

65 
	`as£¹Equ®s
(
c
, 9);

66 
	}
}

68 @
Te¡


69 
public
 
	$‹¡S‘B
(è
throws
 
Exû±iÚ
 {

70 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

72 
t
.
	`£tB
(3);

74 
a
 = 
t
.
	`g‘A
();

75 
b
 = 
t
.
	`g‘B
();

76 
c
 = 
t
.
	`g‘C
();

78 
	`as£¹Equ®s
(
a
, 7);

79 
	`as£¹Equ®s
(
b
, 3);

80 
	`as£¹Equ®s
(
c
, 9);

81 
	}
}

83 @
Te¡


84 
public
 
	$‹¡S‘C
(è
throws
 
Exû±iÚ
 {

85 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

87 
t
.
	`£tC
(3);

89 
a
 = 
t
.
	`g‘A
();

90 
b
 = 
t
.
	`g‘B
();

91 
c
 = 
t
.
	`g‘C
();

93 
	`as£¹Equ®s
(
a
, 7);

94 
	`as£¹Equ®s
(
b
, 8);

95 
	`as£¹Equ®s
(
c
, 3);

96 
	}
}

98 @
Te¡


99 
public
 
	$‹¡Sw­AB
(è
throws
 
Exû±iÚ
 {

100 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

102 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
tSw­³d
 = 
t
.
	`sw­AB
();

104 
a
 = 
t
.
	`g‘A
();

105 
b
 = 
t
.
	`g‘B
();

106 
c
 = 
t
.
	`g‘C
();

108 
	`as£¹Equ®s
(
a
, 7);

109 
	`as£¹Equ®s
(
b
, 8);

110 
	`as£¹Equ®s
(
c
, 9);

112 
x
 = 
tSw­³d
.
	`g‘A
();

113 
y
 = 
tSw­³d
.
	`g‘B
();

114 
z
 = 
tSw­³d
.
	`g‘C
();

116 
	`as£¹Equ®s
(
x
, 8);

117 
	`as£¹Equ®s
(
y
, 7);

118 
	`as£¹Equ®s
(
z
, 9);

119 
	}
}

121 @
Te¡


122 
public
 
	$‹¡Equ®sAndHash
(è
throws
 
Exû±iÚ
 {

123 
TrË
<
Objeù
, Objeù, Objeù> 
ŒNuÎs1
 = 
Ãw
 
	`TrË
(
nuÎ
,‚ull,‚ull);

124 
TrË
<
Objeù
, Objeù, Objeù> 
ŒNuÎs2
 = 
Ãw
 
	`TrË
(
nuÎ
,‚ull,‚ull);

126 
	`as£¹
(
ŒNuÎs1
.
	`equ®s
(
ŒNuÎs2
));

128 
IÁeg”
 
štObj1
 = 
Ãw
 
	`IÁeg”
(0);

129 
IÁeg”
 
štObj2
 = 
Ãw
 
	`IÁeg”
(0);

130 
IÁeg”
 
štDifã»Á
 = 
Ãw
 
	`IÁeg”
(1);

132 
TrË
<
IÁeg”
, IÁeg”, IÁeg”> 
ŒIÁs0
 = 
Ãw
 
	`TrË
(
štObj1
, intObj1, intObj1);

133 
TrË
<
IÁeg”
, IÁeg”, IÁeg”> 
ŒIÁs0a
 = 
Ãw
 
	`TrË
(
štObj2
, intObj2, intObj2);

134 
TrË
<
IÁeg”
, IÁeg”, IÁeg”> 
ŒIÁs1
 = 
Ãw
 
	`TrË
(
štDifã»Á
, 
štObj1
, intObj1);

135 
TrË
<
IÁeg”
, IÁeg”, IÁeg”> 
ŒIÁs2
 = 
Ãw
 
	`TrË
(
štObj1
, 
štDifã»Á
, intObj1);

136 
TrË
<
IÁeg”
, IÁeg”, IÁeg”> 
ŒIÁs3
 = 
Ãw
 
	`TrË
(
štObj1
, iÁObj1, 
štDifã»Á
);

138 
	`as£¹
(
ŒIÁs0
.
	`equ®s
(
ŒIÁs0a
));

139 
	`as£¹F®£
(
ŒIÁs0
.
	`equ®s
((
ŒIÁs1
)));

140 
	`as£¹F®£
(
ŒIÁs0
.
	`equ®s
((
ŒIÁs2
)));

141 
	`as£¹F®£
(
ŒIÁs0
.
	`equ®s
((
ŒIÁs3
)));

143 
	`as£¹F®£
(
ŒIÁs0
.
	`equ®s
(
nuÎ
));

145 
	`as£¹NÙNuÎ
(
ŒIÁs0
.
	`hashCode
());

146 
	`as£¹
(
ŒIÁs0
.
	`hashCode
(è=ğ
ŒIÁs0a
.hashCode());

147 
	}
}

149 @
Te¡


150 
public
 
	$‹¡ToSŒšg
(è
throws
 
Exû±iÚ
 {

151 
TrË
<
IÁeg”
,IÁeg”,IÁeg”> 
t
 = 
Ãw
 
	`TrË
(7, 8, 9);

152 
TrË
<
Objeù
, Objeù, Objeù> 
tNuÎs
 = 
Ãw
 
	`TrË
(
nuÎ
,‚ull,‚ull);

154 
	`as£¹
(
t
.
	`toSŒšg
().
	`com·»To
(
Ãw
 
	`SŒšg
("(7, 8, 9)")) == 0);

155 
	`as£¹
(
tNuÎs
.
	`toSŒšg
().
	`com·»To
(
Ãw
 
	`SŒšg
("(null,‚ull,‚ull)")) == 0);

156 
	}
}

	@
1
.
1
/usr/include
92
7034
demoapps/com/intel/hadoop/graphbuilder/sampleapplications/CreateLinkGraph.java
demoapps/com/intel/hadoop/graphbuilder/sampleapplications/CreateWordCountGraph.java
demoapps/com/intel/hadoop/graphbuilder/sampleapplications/TableToGraphDB.java
demoapps/com/intel/hadoop/graphbuilder/sampleapplications/TableToRDFGraph.java
demoapps/com/intel/hadoop/graphbuilder/sampleapplications/TableToTextGraph.java
src/com/intel/hadoop/graphbuilder/graphelements/Edge.java
src/com/intel/hadoop/graphbuilder/graphelements/EdgeID.java
src/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElement.java
src/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementLongTypeVids.java
src/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementStringTypeVids.java
src/com/intel/hadoop/graphbuilder/graphelements/ValueClassFactory.java
src/com/intel/hadoop/graphbuilder/graphelements/Vertex.java
src/com/intel/hadoop/graphbuilder/pipeline/GraphConstructionPipeline.java
src/com/intel/hadoop/graphbuilder/pipeline/input/BaseMapper.java
src/com/intel/hadoop/graphbuilder/pipeline/input/InputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/input/hbase/GBHTableConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseInputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseReaderMapper.java
src/com/intel/hadoop/graphbuilder/pipeline/input/text/TextFileInputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/input/text/TextParsingMapper.java
src/com/intel/hadoop/graphbuilder/pipeline/input/text/textinputformats/WikiPageInputFormat.java
src/com/intel/hadoop/graphbuilder/pipeline/input/text/textinputformats/XMLInputFormat.java
src/com/intel/hadoop/graphbuilder/pipeline/output/GraphGenerationMRJob.java
src/com/intel/hadoop/graphbuilder/pipeline/output/OutputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/output/rdfgraph/RDFGraphMR.java
src/com/intel/hadoop/graphbuilder/pipeline/output/rdfgraph/RDFGraphOutputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/output/rdfgraph/RDFGraphReducer.java
src/com/intel/hadoop/graphbuilder/pipeline/output/textgraph/TextGraphMR.java
src/com/intel/hadoop/graphbuilder/pipeline/output/textgraph/TextGraphOutputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/output/textgraph/TextGraphReducer.java
src/com/intel/hadoop/graphbuilder/pipeline/output/titan/EdgesIntoTitanReducer.java
src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanCommandLineOptions.java
src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanConfig.java
src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanOutputConfiguration.java
src/com/intel/hadoop/graphbuilder/pipeline/output/titan/TitanWriterMRChain.java
src/com/intel/hadoop/graphbuilder/pipeline/output/titan/VerticesIntoTitanReducer.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/DestinationVertexKeyFunction.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/ElementIdKeyFunction.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/KeyFunction.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/keyfunction/SourceVertexKeyFunction.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/EdgeSchema.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertyGraphSchema.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertySchema.java
src/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/VertexSchema.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/GraphBuildingRule.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/GraphTokenizer.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/RecordTypeHBaseRow.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/hbase/HBaseGraphBuildingRule.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/hbase/HBaseTokenizer.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/linkgraph/LinkGraphBuildingRule.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/linkgraph/LinkGraphTokenizer.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/wordcountgraph/WordCountGraphBuildingRule.java
src/com/intel/hadoop/graphbuilder/pipeline/tokenizer/wordcountgraph/WordCountGraphTokenizer.java
src/com/intel/hadoop/graphbuilder/types/DoubleType.java
src/com/intel/hadoop/graphbuilder/types/EmptyType.java
src/com/intel/hadoop/graphbuilder/types/EncapsulatedObject.java
src/com/intel/hadoop/graphbuilder/types/FloatType.java
src/com/intel/hadoop/graphbuilder/types/IntType.java
src/com/intel/hadoop/graphbuilder/types/LongType.java
src/com/intel/hadoop/graphbuilder/types/Mergeable.java
src/com/intel/hadoop/graphbuilder/types/PropertyMap.java
src/com/intel/hadoop/graphbuilder/types/StringType.java
src/com/intel/hadoop/graphbuilder/util/CommandLineInterface.java
src/com/intel/hadoop/graphbuilder/util/Filter.java
src/com/intel/hadoop/graphbuilder/util/Functional.java
src/com/intel/hadoop/graphbuilder/util/GraphBuilderExit.java
src/com/intel/hadoop/graphbuilder/util/GraphDatabaseConnector.java
src/com/intel/hadoop/graphbuilder/util/HBaseUtils.java
src/com/intel/hadoop/graphbuilder/util/HashUtil.java
src/com/intel/hadoop/graphbuilder/util/Pair.java
src/com/intel/hadoop/graphbuilder/util/PassThruMapperIntegerKey.java
src/com/intel/hadoop/graphbuilder/util/RuntimeConfig.java
src/com/intel/hadoop/graphbuilder/util/StatusCode.java
src/com/intel/hadoop/graphbuilder/util/Timer.java
src/com/intel/hadoop/graphbuilder/util/Triple.java
test/com/intel/hadoop/graphbuilder/graphelements/EdgeIDTest.java
test/com/intel/hadoop/graphbuilder/graphelements/EdgeTest.java
test/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementLongTypeVidsTest.java
test/com/intel/hadoop/graphbuilder/graphelements/PropertyGraphElementStringTypeVidsTest.java
test/com/intel/hadoop/graphbuilder/graphelements/VertexTest.java
test/com/intel/hadoop/graphbuilder/pipeline/input/BaseMapperTest.java
test/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseInputConfigurationTest.java
test/com/intel/hadoop/graphbuilder/pipeline/input/hbase/HBaseReaderMapperTest.java
test/com/intel/hadoop/graphbuilder/pipeline/input/text/TextParsingMapperTests.java
test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/EdgeSchemaTest.java
test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertyGraphSchemaTest.java
test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/PropertySchemaTest.java
test/com/intel/hadoop/graphbuilder/pipeline/pipelinemetadata/propertygraphschema/VertexSchemaTest.java
test/com/intel/hadoop/graphbuilder/pipeline/tokenizer/RecordTypeHBaseRowTest.java
test/com/intel/hadoop/graphbuilder/types/PropertyMapTest.java
test/com/intel/hadoop/graphbuilder/util/RunTimeConfigTest.java
test/com/intel/hadoop/graphbuilder/util/TripleTest.java
