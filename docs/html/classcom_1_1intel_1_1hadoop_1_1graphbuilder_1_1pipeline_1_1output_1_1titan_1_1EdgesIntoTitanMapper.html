<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>GraphBuilder 2.0 (alpha): com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GraphBuilder 2.0 (alpha)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li class="current"><a href="annotated.html"><span>Javadoc</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecom.html">com</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel.html">intel</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1hadoop.html">hadoop</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1hadoop_1_1graphbuilder.html">graphbuilder</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline.html">pipeline</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output.html">output</a></li><li class="navelem"><a class="el" href="namespacecom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan.html">titan</a></li><li class="navelem"><a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.html">EdgesIntoTitanMapper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.png" usemap="#com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper_map" alt=""/>
  <map id="com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper_map" name="com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa7eb9783b1bf573e8d1813481b969a71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.html#aa7eb9783b1bf573e8d1813481b969a71">setup</a> (Context context)  throws IOException,             InterruptedException </td></tr>
<tr class="separator:aa7eb9783b1bf573e8d1813481b969a71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac452ebfd2adf7b805afddfdbe948fec2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.html#ac452ebfd2adf7b805afddfdbe948fec2">map</a> (IntWritable key, SerializedGraphElement value, Context context)  throws IOException, InterruptedException </td></tr>
<tr class="separator:ac452ebfd2adf7b805afddfdbe948fec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04f2dbb8b6943dd27f21c9420cd4b897"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.html#a04f2dbb8b6943dd27f21c9420cd4b897">cleanup</a> (Context context)  throws IOException,             InterruptedException </td></tr>
<tr class="separator:a04f2dbb8b6943dd27f21c9420cd4b897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fd5b91bea123a04499ff587ac11a3f4"><td class="memItemLeft" align="right" valign="top">Enum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.html#a4fd5b91bea123a04499ff587ac11a3f4">getEdgeCounter</a> ()</td></tr>
<tr class="separator:a4fd5b91bea123a04499ff587ac11a3f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f68587690c24ab17934528e14b26614"><td class="memItemLeft" align="right" valign="top">Enum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1EdgesIntoTitanMapper.html#a1f68587690c24ab17934528e14b26614">getEdgePropertiesCounter</a> ()</td></tr>
<tr class="separator:a1f68587690c24ab17934528e14b26614"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class reads edges from HDFS by <a class="el" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1titan_1_1IntermediateEdgeWriterReducer.html">IntermediateEdgeWriterReducer</a>. The Titan ID of both source and target vertices are written along with the edge properties in the previous step. In this map-only job, the map function fetches the reference to the source and target vertices from Titan and adds the edges to Titan using the Blueprints addEdge() API. The edge properties are also written to Titan </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a04f2dbb8b6943dd27f21c9420cd4b897"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper.cleanup </td>
          <td>(</td>
          <td class="paramtype">Context&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td> throws IOException,             InterruptedException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs cleanup tasks after the reducer finishes.</p>
<p>In particular, closes the Titan graph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">@code</td><td>context  Hadoop provided reducer context. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IOException</td><td></td></tr>
    <tr><td class="paramname">InterruptedException</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                 {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        this.graph.shutdown();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4fd5b91bea123a04499ff587ac11a3f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Enum com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper.getEdgeCounter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                 {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">return</span> Counters.NUM_EDGES;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1f68587690c24ab17934528e14b26614"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Enum com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper.getEdgePropertiesCounter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                          {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span> Counters.EDGE_PROPERTIES_WRITTEN;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac452ebfd2adf7b805afddfdbe948fec2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper.map </td>
          <td>(</td>
          <td class="paramtype">IntWritable&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SerializedGraphElement&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Context&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> throws IOException, InterruptedException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The map function reads the references of the source and target vertices of a given edge and writes the edge and its properties to Titan using the Blueprints addEdge() call</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The data structure of the input file is every record per line is a serialized edge. Input of this map comes from the output directory written by <a class="el" href="IntermediateEdgeWriterReducer_8java.html">IntermediateEdgeWriterReducer.java</a> </td></tr>
    <tr><td class="paramname">value</td><td>A serialized edge </td></tr>
    <tr><td class="paramname">context</td><td>Hadoop Job context </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                                              {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        SerializedGraphElement serializedGraphElement = value;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (serializedGraphElement.graphElement().isVertex()) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="comment">// This is a strange case, throw an exception</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;GRAPHBUILDER_ERROR: &quot;</span> +</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <span class="stringliteral">&quot;Found unexpected Vertex element in the edge write &quot;</span> +</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <span class="stringliteral">&quot;mapper. Please recheck the logic to create vertices and &quot;</span> +</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    <span class="stringliteral">&quot;edges.&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        com.tinkerpop.blueprints.Vertex srcBlueprintsVertex =</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    this.graph.getVertex(serializedGraphElement.graphElement</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                            ().getProperty(GraphElementWriter</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                            .PROPERTY_KEY_SRC_TITAN_ID));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        com.tinkerpop.blueprints.Vertex tgtBlueprintsVertex =</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    this.graph.getVertex(serializedGraphElement.graphElement</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            ().getProperty(GraphElementWriter</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                            .PROPERTY_KEY_TGT_TITAN_ID));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        PropertyMap propertyMap = (PropertyMap) serializedGraphElement</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                .graphElement().getProperties();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// Add the edge to Titan graph</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        com.tinkerpop.blueprints.Edge bluePrintsEdge = null;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        String edgeLabel = serializedGraphElement.graphElement().getLabel()</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                .toString();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            bluePrintsEdge = this.graph.addEdge(null,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        srcBlueprintsVertex,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        tgtBlueprintsVertex,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                        edgeLabel);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        } <span class="keywordflow">catch</span> (IllegalArgumentException e) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            GraphBuilderExit.graphbuilderFatalExitException(</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <a class="code" href="enumcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1util_1_1StatusCode.html#a1c44238e51d562f1ee1c30941279e0a6">StatusCode.TITAN_ERROR</a>,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        <span class="stringliteral">&quot;Could not add edge to Titan; likely a schema error. &quot;</span> +</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        <span class="stringliteral">&quot;The label on the edge is  &quot;</span> + edgeLabel, LOG, e);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// The edge is added to the graph; now add the edge properties.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// The &quot;srcTitanID&quot; property was added during this MR job to</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// propagate the Titan ID of the edge&#39;s source vertex to this</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// reducer ... we can remove it now.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        propertyMap.removeProperty(<a class="code" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter.html#a6cdbec51472b2ea20040dd3ea6dcc87f">GraphElementWriter</a></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<a class="code" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter.html#a6cdbec51472b2ea20040dd3ea6dcc87f">                .PROPERTY_KEY_SRC_TITAN_ID</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        propertyMap.removeProperty(<a class="code" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter.html#ab1154d86def78f462f254babe2ff4704">GraphElementWriter</a></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<a class="code" href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter.html#ab1154d86def78f462f254babe2ff4704">                .PROPERTY_KEY_TGT_TITAN_ID</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (Writable propertyKey : propertyMap.getPropertyKeys()) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;           EncapsulatedObject mapEntry = (EncapsulatedObject)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                        propertyMap.getProperty(propertyKey.toString());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;           <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;               bluePrintsEdge.setProperty(propertyKey.toString(),</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                       mapEntry.getBaseObject());</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;           } <span class="keywordflow">catch</span> (IllegalArgumentException e) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;               LOG.fatal(<span class="stringliteral">&quot;GRAPHBUILDER_ERROR: Could not add edge &quot;</span> +</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                            <span class="stringliteral">&quot;property; probably a schema error. The label on &quot;</span> +</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                            <span class="stringliteral">&quot;the edge is  &quot;</span> + edgeLabel);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;               LOG.fatal(<span class="stringliteral">&quot;GRAPHBUILDER_ERROR: The property on the edge &quot;</span> +</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                            <span class="stringliteral">&quot;is &quot;</span> + propertyKey.toString());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;               LOG.fatal(e.getMessage());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;               GraphBuilderExit.graphbuilderFatalExitException</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                            (<a class="code" href="enumcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1util_1_1StatusCode.html#a04481688bf7982e517cfd40f1fa4dd4c">StatusCode.INDESCRIBABLE_FAILURE</a>, <span class="stringliteral">&quot;&quot;</span>, LOG, e);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;           }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        context.getCounter(Counters.NUM_EDGES).increment(1L);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }   <span class="comment">// End of map function</span></div>
<div class="ttc" id="enumcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1util_1_1StatusCode_html_a04481688bf7982e517cfd40f1fa4dd4c"><div class="ttname"><a href="enumcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1util_1_1StatusCode.html#a04481688bf7982e517cfd40f1fa4dd4c">com.intel.hadoop.graphbuilder.util.StatusCode.INDESCRIBABLE_FAILURE</a></div><div class="ttdeci">INDESCRIBABLE_FAILURE</div><div class="ttdef"><b>Definition:</b> StatusCode.java:32</div></div>
<div class="ttc" id="enumcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1util_1_1StatusCode_html_a1c44238e51d562f1ee1c30941279e0a6"><div class="ttname"><a href="enumcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1util_1_1StatusCode.html#a1c44238e51d562f1ee1c30941279e0a6">com.intel.hadoop.graphbuilder.util.StatusCode.TITAN_ERROR</a></div><div class="ttdeci">TITAN_ERROR</div><div class="ttdef"><b>Definition:</b> StatusCode.java:34</div></div>
<div class="ttc" id="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter_html_a6cdbec51472b2ea20040dd3ea6dcc87f"><div class="ttname"><a href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter.html#a6cdbec51472b2ea20040dd3ea6dcc87f">com.intel.hadoop.graphbuilder.pipeline.output.GraphElementWriter.PROPERTY_KEY_SRC_TITAN_ID</a></div><div class="ttdeci">static final String PROPERTY_KEY_SRC_TITAN_ID</div><div class="ttdef"><b>Definition:</b> GraphElementWriter.java:43</div></div>
<div class="ttc" id="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter_html_ab1154d86def78f462f254babe2ff4704"><div class="ttname"><a href="classcom_1_1intel_1_1hadoop_1_1graphbuilder_1_1pipeline_1_1output_1_1GraphElementWriter.html#ab1154d86def78f462f254babe2ff4704">com.intel.hadoop.graphbuilder.pipeline.output.GraphElementWriter.PROPERTY_KEY_TGT_TITAN_ID</a></div><div class="ttdeci">static final String PROPERTY_KEY_TGT_TITAN_ID</div><div class="ttdef"><b>Definition:</b> GraphElementWriter.java:44</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa7eb9783b1bf573e8d1813481b969a71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void com.intel.hadoop.graphbuilder.pipeline.output.titan.EdgesIntoTitanMapper.setup </td>
          <td>(</td>
          <td class="paramtype">Context&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td> throws IOException,             InterruptedException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets up the Titan connection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">@code</td><td>context  The reducer context provided by Hadoop. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">IOException</td><td></td></tr>
    <tr><td class="paramname">InterruptedException</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                 {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        this.graph = getTitanGraphInstance(context);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/java/com/intel/hadoop/graphbuilder/pipeline/output/titan/<a class="el" href="EdgesIntoTitanMapper_8java.html">EdgesIntoTitanMapper.java</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 13 2014 08:58:19 for GraphBuilder 2.0 (alpha) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
