intel.taproot.analytics.component.archives {
  giraph-plugins {
    config-path = "intel.taproot.analytics.giraph-plugins"
  }
}

intel.taproot.analytics.giraph-plugins {
  extra-classpath = [${intel.taproot.analytics.engine.hbase.configuration.path}, ${intel.taproot.analytics.engine.hadoop.configuration.path}]
  command {
    available = ["frames.collaborative_filtering",
      "frames.label_propagation",
      "frames.loopy_belief_propagation",
      "models.lda_model_new",
      "models.lda_model_train",
      "graphs.page_rank", "graphs.connected_components"]

    frames {
      label_propagation {
        class = "com.intel.taproot.analytics.algorithm.frames.LabelPropagationPlugin"
        config {
          fs = ${intel.taproot.analytics.engine.fs}
          default-timeout = ${intel.taproot.analytics.engine.default-timeout}
          giraph = ${intel.taproot.analytics.engine.giraph}
          titan = ${intel.taproot.analytics.engine.titan}
          output {
            dir = "lp"
            overwrite = "true"
          }
        }
      }

      loopy_belief_propagation {
        class = "com.intel.taproot.analytics.algorithm.frames.LoopyBeliefPropagationPlugin"
        config {
          fs = ${intel.taproot.analytics.engine.fs}
          default-timeout = ${intel.taproot.analytics.engine.default-timeout}
          giraph = ${intel.taproot.analytics.engine.giraph}
          titan = ${intel.taproot.analytics.engine.titan}
          output {
            dir = "lbp"
            overwrite = "true"
          }
        }
      }

      collaborative_filtering {
        class = "com.intel.taproot.analytics.algorithm.frames.CollaborativeFilteringPlugin"
        config {
          fs = ${intel.taproot.analytics.engine.fs}
          default-timeout = ${intel.taproot.analytics.engine.default-timeout}
          giraph = ${intel.taproot.analytics.engine.giraph}
          titan = ${intel.taproot.analytics.engine.titan}
          output {
            dir = "cf"
            overwrite = "true"
          }
        }
      }
    }

    graphs {

      // non ml graph algorithms go down here
      connected_components {
        class = "com.intel.taproot.analytics.algorithm.graph.ConnectedComponentsPlugin"
        config {
          fs = ${intel.taproot.analytics.engine.fs}
          default-timeout = ${intel.taproot.analytics.engine.default-timeout}
          giraph = ${intel.taproot.analytics.engine.giraph}
          titan = ${intel.taproot.analytics.engine.titan}
          output {
            dir = "connectedcomponents"
            overwrite = "true"
          }
          giraph {
            cc.convergenceProgressOutputInterval = 1
          }
        }
      }

      page_rank {
        class = "com.intel.taproot.analytics.algorithm.graph.PageRankPlugin"
        config {
          fs = ${intel.taproot.analytics.engine.fs}
          default-timeout = ${intel.taproot.analytics.engine.default-timeout}
          giraph = ${intel.taproot.analytics.engine.giraph}
          titan = ${intel.taproot.analytics.engine.titan}
          output {
            dir = "pr"
            overwrite = "true"
          }
          giraph {
            pr.maxSupersteps = 20
            pr.convergenceThreshold = 0.001
            pr.resetProbability = 0.15
            pr.convergenceProgressOutputInterval = 1
          }
        }
      }

    }

    models {
      lda_model_new {
        class = "com.intel.taproot.analytics.algorithm.model.LdaNewPlugin"
        config {
          // TODO: change plugin loading so dummy config won't be needed
          dummy = "dummy"
        }
      }

      lda_model_train {
        class = "com.intel.taproot.analytics.algorithm.model.LdaTrainPlugin"
        config {
          fs = ${intel.taproot.analytics.engine.fs}
          giraph = ${intel.taproot.analytics.engine.giraph}
          output {
            dir = "lda"
            overwrite = "true"
          }
        }
      }

    }
  }
  queries {
    available = []
  }
}


#included so that conf file can be read during unit tests,
#these will not be used when the application is actually running
intel.taproot.analytics.engine {
  default-timeout = 30
  titan {}
}
